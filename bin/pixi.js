/**
 * @license
 * pixi.js - v1.6.1
 * Copyright (c) 2012-2014, Mat Groves
 * http://goodboydigital.com/
 *
 * Compiled: 2014-09-20
 *
 * pixi.js is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license.php
 */
/**
 * @author Mat Groves http://matgroves.com/ @Doormat23
 */

!function(){var e=this;var t=t||{};t.WEBGL_RENDERER=0;t.CANVAS_RENDERER=1;t.VERSION="v1.6.1";t.blendModes={NORMAL:0,ADD:1,MULTIPLY:2,SCREEN:3,OVERLAY:4,DARKEN:5,LIGHTEN:6,COLOR_DODGE:7,COLOR_BURN:8,HARD_LIGHT:9,SOFT_LIGHT:10,DIFFERENCE:11,EXCLUSION:12,HUE:13,SATURATION:14,COLOR:15,LUMINOSITY:16};t.scaleModes={DEFAULT:0,LINEAR:0,NEAREST:1};t._UID=0;if(typeof Float32Array!="undefined"){t.Float32Array=Float32Array;t.Uint16Array=Uint16Array}else{t.Float32Array=Array;t.Uint16Array=Array}t.INTERACTION_FREQUENCY=30;t.AUTO_PREVENT_DEFAULT=true;t.RAD_TO_DEG=180/Math.PI;t.DEG_TO_RAD=Math.PI/180;t.RETINA_PREFIX="@2x";t.dontSayHello=true;t.defaultRenderOptions={view:null,transparent:false,antialias:false,preserveDrawingBuffer:false,resolution:1,clearBeforeRender:true};t.sayHello=function(e){if(t.dontSayHello)return;if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var n=["%c %c %c Pixi.js "+t.VERSION+" - "+e+"  %c "+" %c "+" http://www.pixijs.com/  %c %c ♥%c♥%c♥ ","background: #ff66a5","background: #ff66a5","color: #ff66a5; background: #030307;","background: #ff66a5","background: #ffc3dc","background: #ff66a5","color: #ff2424; background: #fff","color: #ff2424; background: #fff","color: #ff2424; background: #fff"];console.log.apply(console,n)}else if(window["console"]){console.log("Pixi.js "+t.VERSION+" - http://www.pixijs.com/")}t.dontSayHello=true};t.Point=function(e,t){this.x=e||0;this.y=t||0};t.Point.prototype.clone=function(){return new t.Point(this.x,this.y)};t.Point.prototype.set=function(e,t){this.x=e||0;this.y=t||(t!==0?this.x:0)};t.Point.prototype.constructor=t.Point;t.Rectangle=function(e,t,n,r){this.x=e||0;this.y=t||0;this.width=n||0;this.height=r||0};t.Rectangle.prototype.clone=function(){return new t.Rectangle(this.x,this.y,this.width,this.height)};t.Rectangle.prototype.contains=function(e,t){if(this.width<=0||this.height<=0)return false;var n=this.x;if(e>=n&&e<=n+this.width){var r=this.y;if(t>=r&&t<=r+this.height){return true}}return false};t.Rectangle.prototype.constructor=t.Rectangle;t.EmptyRectangle=new t.Rectangle(0,0,0,0);t.Polygon=function(e){if(!(e instanceof Array))e=Array.prototype.slice.call(arguments);if(typeof e[0]==="number"){var n=[];for(var r=0,i=e.length;r<i;r+=2){n.push(new t.Point(e[r],e[r+1]))}e=n}this.points=e};t.Polygon.prototype.clone=function(){var e=[];for(var n=0;n<this.points.length;n++){e.push(this.points[n].clone())}return new t.Polygon(e)};t.Polygon.prototype.contains=function(e,t){var n=false;for(var r=0,i=this.points.length-1;r<this.points.length;i=r++){var s=this.points[r].x,o=this.points[r].y,u=this.points[i].x,a=this.points[i].y,f=o>t!==a>t&&e<(u-s)*(t-o)/(a-o)+s;if(f)n=!n}return n};t.Polygon.prototype.constructor=t.Polygon;t.Circle=function(e,t,n){this.x=e||0;this.y=t||0;this.radius=n||0};t.Circle.prototype.clone=function(){return new t.Circle(this.x,this.y,this.radius)};t.Circle.prototype.contains=function(e,t){if(this.radius<=0)return false;var n=this.x-e,r=this.y-t,i=this.radius*this.radius;n*=n;r*=r;return n+r<=i};t.Circle.prototype.getBounds=function(){return new t.Rectangle(this.x-this.radius,this.y-this.radius,this.radius*2,this.radius*2)};t.Circle.prototype.constructor=t.Circle;t.Ellipse=function(e,t,n,r){this.x=e||0;this.y=t||0;this.width=n||0;this.height=r||0};t.Ellipse.prototype.clone=function(){return new t.Ellipse(this.x,this.y,this.width,this.height)};t.Ellipse.prototype.contains=function(e,t){if(this.width<=0||this.height<=0)return false;var n=(e-this.x)/this.width,r=(t-this.y)/this.height;n*=n;r*=r;return n+r<=1};t.Ellipse.prototype.getBounds=function(){return new t.Rectangle(this.x-this.width,this.y-this.height,this.width,this.height)};t.Ellipse.prototype.constructor=t.Ellipse;t.Matrix=function(){this.a=1;this.b=0;this.c=0;this.d=1;this.tx=0;this.ty=0};t.Matrix.prototype.fromArray=function(e){this.a=e[0];this.b=e[1];this.c=e[3];this.d=e[4];this.tx=e[2];this.ty=e[5]};t.Matrix.prototype.toArray=function(e){if(!this.array)this.array=new t.Float32Array(9);var n=this.array;if(e){n[0]=this.a;n[1]=this.c;n[2]=0;n[3]=this.b;n[4]=this.d;n[5]=0;n[6]=this.tx;n[7]=this.ty;n[8]=1}else{n[0]=this.a;n[1]=this.b;n[2]=this.tx;n[3]=this.c;n[4]=this.d;n[5]=this.ty;n[6]=0;n[7]=0;n[8]=1}return n};t.Matrix.prototype.apply=function(e,n){n=n||new t.Point;n.x=this.a*e.x+this.b*e.y+this.tx;n.y=this.c*e.x+this.d*e.y+this.ty;return n};t.Matrix.prototype.applyInverse=function(e,n){n=n||new t.Point;var r=1/(this.a*this.d+this.b*-this.c);n.x=this.d*r*e.x-this.b*r*e.y+(this.ty*this.b-this.tx*this.d)*r;n.y=this.a*r*e.y-this.c*r*e.x+(this.tx*this.c-this.ty*this.a)*r;return n};t.Matrix.prototype.translate=function(e,t){this.tx+=e;this.ty+=t;return this};t.Matrix.prototype.scale=function(e,t){this.a*=e;this.d*=t;this.c*=e;this.b*=t;this.tx*=e;this.ty*=t;return this};t.Matrix.prototype.rotate=function(e){var t=Math.cos(e);var n=Math.sin(e);var r=this.a;var i=this.c;var s=this.tx;this.a=r*t-this.b*n;this.b=r*n+this.b*t;this.c=i*t-this.d*n;this.d=i*n+this.d*t;this.tx=s*t-this.ty*n;this.ty=s*n+this.ty*t;return this};t.identityMatrix=new t.Matrix;t.determineMatrixArrayType=function(){return typeof Float32Array!=="undefined"?Float32Array:Array};t.Matrix2=t.determineMatrixArrayType();t.DisplayObject=function(){this.position=new t.Point;this.scale=new t.Point(1,1);this.pivot=new t.Point(0,0);this.rotation=0;this.alpha=1;this.visible=true;this.hitArea=null;this.buttonMode=false;this.renderable=false;this.parent=null;this.stage=null;this.worldAlpha=1;this._interactive=false;this.defaultCursor="pointer";this.worldTransform=new t.Matrix;this.color=[];this.dynamic=true;this._sr=0;this._cr=1;this.filterArea=null;this._bounds=new t.Rectangle(0,0,1,1);this._currentBounds=null;this._mask=null;this._cacheAsBitmap=false;this._cacheIsDirty=false};t.DisplayObject.prototype.constructor=t.DisplayObject;t.DisplayObject.prototype.setInteractive=function(e){this.interactive=e};Object.defineProperty(t.DisplayObject.prototype,"interactive",{get:function(){return this._interactive},set:function(e){this._interactive=e;if(this.stage)this.stage.dirty=true}});Object.defineProperty(t.DisplayObject.prototype,"worldVisible",{get:function(){var e=this;do{if(!e.visible)return false;e=e.parent}while(e);return true}});Object.defineProperty(t.DisplayObject.prototype,"mask",{get:function(){return this._mask},set:function(e){if(this._mask)this._mask.isMask=false;this._mask=e;if(this._mask)this._mask.isMask=true}});Object.defineProperty(t.DisplayObject.prototype,"filters",{get:function(){return this._filters},set:function(e){if(e){var t=[];for(var n=0;n<e.length;n++){var r=e[n].passes;for(var i=0;i<r.length;i++){t.push(r[i])}}this._filterBlock={target:this,filterPasses:t}}this._filters=e}});Object.defineProperty(t.DisplayObject.prototype,"cacheAsBitmap",{get:function(){return this._cacheAsBitmap},set:function(e){if(this._cacheAsBitmap===e)return;if(e){this._generateCachedSprite()}else{this._destroyCachedSprite()}this._cacheAsBitmap=e}});t.DisplayObject.prototype.updateTransform=function(){if(this.rotation!==this.rotationCache){this.rotationCache=this.rotation;this._sr=Math.sin(this.rotation);this._cr=Math.cos(this.rotation)}var e=this.parent.worldTransform;var t=this.worldTransform;var n=this.pivot.x;var r=this.pivot.y;var i=this._cr*this.scale.x,s=-this._sr*this.scale.y,o=this._sr*this.scale.x,u=this._cr*this.scale.y,a=this.position.x-i*n-r*s,f=this.position.y-u*r-n*o,l=e.a,c=e.b,h=e.c,p=e.d;t.a=l*i+c*o;t.b=l*s+c*u;t.tx=l*a+c*f+e.tx;t.c=h*i+p*o;t.d=h*s+p*u;t.ty=h*a+p*f+e.ty;this.worldAlpha=this.alpha*this.parent.worldAlpha};t.DisplayObject.prototype.getBounds=function(e){e=e;return t.EmptyRectangle};t.DisplayObject.prototype.getLocalBounds=function(){return this.getBounds(t.identityMatrix)};t.DisplayObject.prototype.setStageReference=function(e){this.stage=e;if(this._interactive)this.stage.dirty=true};t.DisplayObject.prototype.generateTexture=function(e,n,r){var i=this.getLocalBounds();var s=new t.RenderTexture(i.width|0,i.height|0,r,n,e);s.render(this,new t.Point(-i.x,-i.y));return s};t.DisplayObject.prototype.updateCache=function(){this._generateCachedSprite()};t.DisplayObject.prototype.toGlobal=function(e){this.updateTransform();return this.worldTransform.apply(e)};t.DisplayObject.prototype.toLocal=function(e,t){if(t){e=t.toGlobal(e)}this.updateTransform();return this.worldTransform.applyInverse(e)};t.DisplayObject.prototype._renderCachedSprite=function(e){this._cachedSprite.worldAlpha=this.worldAlpha;if(e.gl){t.Sprite.prototype._renderWebGL.call(this._cachedSprite,e)}else{t.Sprite.prototype._renderCanvas.call(this._cachedSprite,e)}};t.getAncestorRenderer=function(e){while(true){if(e==null||typeof e!="object")return undefined;if(e.renderer instanceof t.WebGLRenderer||e.renderer instanceof t.CanvasRenderer)return e.renderer;e=e.parent}};t.DisplayObject.prototype._generateCachedSprite=function(e){this._cacheAsBitmap=false;var n=this.getLocalBounds();if(!this._cachedSprite){var r=new t.RenderTexture(n.width|0,n.height|0,t.getAncestorRenderer(this),undefined,e);this._cachedSprite=new t.Sprite(r);this._cachedSprite.worldTransform=this.worldTransform}else{this._cachedSprite.texture.resize(n.width|0,n.height|0)}var i=this._filters;this._filters=null;this._cachedSprite.filters=i;this._cachedSprite.texture.render(this,new t.Point(-n.x,-n.y));this._cachedSprite.anchor.x=-(n.x/n.width);this._cachedSprite.anchor.y=-(n.y/n.height);this._filters=i;this._cacheAsBitmap=true};t.DisplayObject.prototype._destroyCachedSprite=function(){if(!this._cachedSprite)return;this._cachedSprite.texture.destroy(true);this._cachedSprite=null};t.DisplayObject.prototype._renderWebGL=function(e){e=e};t.DisplayObject.prototype._renderCanvas=function(e){e=e};Object.defineProperty(t.DisplayObject.prototype,"x",{get:function(){return this.position.x},set:function(e){this.position.x=e}});Object.defineProperty(t.DisplayObject.prototype,"y",{get:function(){return this.position.y},set:function(e){this.position.y=e}});t.DisplayObjectContainer=function(){t.DisplayObject.call(this);this.children=[]};t.DisplayObjectContainer.prototype=Object.create(t.DisplayObject.prototype);t.DisplayObjectContainer.prototype.constructor=t.DisplayObjectContainer;Object.defineProperty(t.DisplayObjectContainer.prototype,"width",{get:function(){return this.scale.x*this.getLocalBounds().width},set:function(e){var t=this.getLocalBounds().width;if(t!==0){this.scale.x=e/(t/this.scale.x)}else{this.scale.x=1}this._width=e}});Object.defineProperty(t.DisplayObjectContainer.prototype,"height",{get:function(){return this.scale.y*this.getLocalBounds().height},set:function(e){var t=this.getLocalBounds().height;if(t!==0){this.scale.y=e/(t/this.scale.y)}else{this.scale.y=1}this._height=e}});t.DisplayObjectContainer.prototype.addChild=function(e){return this.addChildAt(e,this.children.length)};t.DisplayObjectContainer.prototype.addChildAt=function(e,t){if(t>=0&&t<=this.children.length){if(e.parent){e.parent.removeChild(e)}e.parent=this;this.children.splice(t,0,e);if(this.stage)e.setStageReference(this.stage);return e}else{throw new Error(e+"addChildAt: The index "+t+" supplied is out of bounds "+this.children.length)}};t.DisplayObjectContainer.prototype.swapChildren=function(e,t){if(e===t){return}var n=this.children.indexOf(e);var r=this.children.indexOf(t);if(n<0||r<0){throw new Error("swapChildren: Both the supplied DisplayObjects must be a child of the caller.")}this.children[n]=t;this.children[r]=e};t.DisplayObjectContainer.prototype.getChildAt=function(e){if(e>=0&&e<this.children.length){return this.children[e]}else{throw new Error("getChildAt: Supplied index "+e+" does not exist in the child list, or the supplied DisplayObject must be a child of the caller")}};t.DisplayObjectContainer.prototype.removeChild=function(e){return this.removeChildAt(this.children.indexOf(e))};t.DisplayObjectContainer.prototype.removeChildAt=function(e){var t=this.getChildAt(e);if(this.stage)t.removeStageReference();t.parent=undefined;this.children.splice(e,1);return t};t.DisplayObjectContainer.prototype.removeChildren=function(e,t){var n=e||0;var r=typeof t==="number"?t:this.children.length;var i=r-n;if(i>0&&i<=r){var s=this.children.splice(n,i);for(var o=0;o<s.length;o++){var u=s[o];if(this.stage)u.removeStageReference();u.parent=undefined}return s}else if(i===0&&this.children.length===0){return[]}else{throw new Error("removeChildren: Range Error, numeric values are outside the acceptable range")}};t.DisplayObjectContainer.prototype.updateTransform=function(){if(!this.visible)return;t.DisplayObject.prototype.updateTransform.call(this);if(this._cacheAsBitmap)return;for(var e=0,n=this.children.length;e<n;e++){this.children[e].updateTransform()}};t.DisplayObjectContainer.prototype.getBounds=function(e){if(this.children.length===0)return t.EmptyRectangle;if(e){var n=this.worldTransform;this.worldTransform=e;this.updateTransform();this.worldTransform=n}var r=Infinity;var i=Infinity;var s=-Infinity;var o=-Infinity;var u;var a;var f;var l=false;for(var c=0,h=this.children.length;c<h;c++){var p=this.children[c];if(!p.visible)continue;l=true;u=this.children[c].getBounds(e);r=r<u.x?r:u.x;i=i<u.y?i:u.y;a=u.width+u.x;f=u.height+u.y;s=s>a?s:a;o=o>f?o:f}if(!l)return t.EmptyRectangle;var d=this._bounds;d.x=r;d.y=i;d.width=s-r;d.height=o-i;return d};t.DisplayObjectContainer.prototype.getLocalBounds=function(){var e=this.worldTransform;this.worldTransform=t.identityMatrix;for(var n=0,r=this.children.length;n<r;n++){this.children[n].updateTransform()}var i=this.getBounds();this.worldTransform=e;return i};t.DisplayObjectContainer.prototype.setStageReference=function(e){this.stage=e;if(this._interactive)this.stage.dirty=true;for(var t=0,n=this.children.length;t<n;t++){var r=this.children[t];r.setStageReference(e)}};t.DisplayObjectContainer.prototype.removeStageReference=function(){for(var e=0,t=this.children.length;e<t;e++){var n=this.children[e];n.removeStageReference()}if(this._interactive)this.stage.dirty=true;this.stage=null};t.DisplayObjectContainer.prototype._renderWebGL=function(e){if(!this.visible||this.alpha<=0)return;if(this._cacheAsBitmap){this._renderCachedSprite(e);return}var t,n;if(this._mask||this._filters){if(this._filters){e.spriteBatch.flush();e.filterManager.pushFilter(this._filterBlock)}if(this._mask){e.spriteBatch.stop();e.maskManager.pushMask(this.mask,e);e.spriteBatch.start()}for(t=0,n=this.children.length;t<n;t++){this.children[t]._renderWebGL(e)}e.spriteBatch.stop();if(this._mask)e.maskManager.popMask(this._mask,e);if(this._filters)e.filterManager.popFilter();e.spriteBatch.start()}else{for(t=0,n=this.children.length;t<n;t++){this.children[t]._renderWebGL(e)}}};t.DisplayObjectContainer.prototype._renderCanvas=function(e){if(this.visible===false||this.alpha===0)return;if(this._cacheAsBitmap){this._renderCachedSprite(e);return}if(this._mask){e.maskManager.pushMask(this._mask,e)}for(var t=0,n=this.children.length;t<n;t++){var r=this.children[t];r._renderCanvas(e)}if(this._mask){e.maskManager.popMask(e)}};t.Sprite=function(e){t.DisplayObjectContainer.call(this);this.anchor=new t.Point;this.texture=e;this._width=0;this._height=0;this.tint=16777215;this.blendMode=t.blendModes.NORMAL;if(e.baseTexture.hasLoaded){this.onTextureUpdate()}else{this.onTextureUpdateBind=this.onTextureUpdate.bind(this);this.texture.addEventListener("update",this.onTextureUpdateBind)}this.renderable=true};t.Sprite.prototype=Object.create(t.DisplayObjectContainer.prototype);t.Sprite.prototype.constructor=t.Sprite;Object.defineProperty(t.Sprite.prototype,"width",{get:function(){return this.scale.x*this.texture.frame.width},set:function(e){this.scale.x=e/this.texture.frame.width;this._width=e}});Object.defineProperty(t.Sprite.prototype,"height",{get:function(){return this.scale.y*this.texture.frame.height},set:function(e){this.scale.y=e/this.texture.frame.height;this._height=e}});t.Sprite.prototype.setTexture=function(e){this.texture=e;this.cachedTint=16777215};t.Sprite.prototype.onTextureUpdate=function(){if(this._width)this.scale.x=this._width/this.texture.frame.width;if(this._height)this.scale.y=this._height/this.texture.frame.height};t.Sprite.prototype.getBounds=function(e){var t=this.texture.frame.width;var n=this.texture.frame.height;var r=t*(1-this.anchor.x);var i=t*-this.anchor.x;var s=n*(1-this.anchor.y);var o=n*-this.anchor.y;var u=e||this.worldTransform;var a=u.a;var f=u.c;var l=u.b;var c=u.d;var h=u.tx;var p=u.ty;var d=a*i+l*o+h;var v=c*o+f*i+p;var m=a*r+l*o+h;var g=c*o+f*r+p;var y=a*r+l*s+h;var b=c*s+f*r+p;var w=a*i+l*s+h;var E=c*s+f*i+p;var S=-Infinity;var x=-Infinity;var T=Infinity;var N=Infinity;T=d<T?d:T;T=m<T?m:T;T=y<T?y:T;T=w<T?w:T;N=v<N?v:N;N=g<N?g:N;N=b<N?b:N;N=E<N?E:N;S=d>S?d:S;S=m>S?m:S;S=y>S?y:S;S=w>S?w:S;x=v>x?v:x;x=g>x?g:x;x=b>x?b:x;x=E>x?E:x;var C=this._bounds;C.x=T;C.width=S-T;C.y=N;C.height=x-N;this._currentBounds=C;return C};t.Sprite.prototype._renderWebGL=function(e){if(!this.visible||this.alpha<=0)return;var t,n;if(this._mask||this._filters){var r=e.spriteBatch;if(this._filters){r.flush();e.filterManager.pushFilter(this._filterBlock)}if(this._mask){r.stop();e.maskManager.pushMask(this.mask,e);r.start()}r.render(this);for(t=0,n=this.children.length;t<n;t++){this.children[t]._renderWebGL(e)}r.stop();if(this._mask)e.maskManager.popMask(this._mask,e);if(this._filters)e.filterManager.popFilter();r.start()}else{e.spriteBatch.render(this);for(t=0,n=this.children.length;t<n;t++){this.children[t]._renderWebGL(e)}}};t.Sprite.prototype._renderCanvas=function(e){if(this.visible===false||this.alpha===0||this.texture.crop.width<=0||this.texture.crop.height<=0)return;if(this.blendMode!==e.currentBlendMode){e.currentBlendMode=this.blendMode;e.context.globalCompositeOperation=t.blendModesCanvas[e.currentBlendMode]}if(this._mask){e.maskManager.pushMask(this._mask,e)}if(this.texture.valid){var n=this.texture.baseTexture.resolution/e.resolution;e.context.globalAlpha=this.worldAlpha;if(e.roundPixels){e.context.setTransform(this.worldTransform.a,this.worldTransform.c,this.worldTransform.b,this.worldTransform.d,this.worldTransform.tx|0,this.worldTransform.ty|0)}else{e.context.setTransform(this.worldTransform.a,this.worldTransform.c,this.worldTransform.b,this.worldTransform.d,this.worldTransform.tx*e.resolution,this.worldTransform.ty*e.resolution)}if(e.smoothProperty&&e.scaleMode!==this.texture.baseTexture.scaleMode){e.scaleMode=this.texture.baseTexture.scaleMode;e.context[e.smoothProperty]=e.scaleMode===t.scaleModes.LINEAR}var r=this.texture.trim?this.texture.trim.x-this.anchor.x*this.texture.trim.width:this.anchor.x*-this.texture.frame.width;var i=this.texture.trim?this.texture.trim.y-this.anchor.y*this.texture.trim.height:this.anchor.y*-this.texture.frame.height;if(this.tint!==16777215){if(this.cachedTint!==this.tint){this.cachedTint=this.tint;this.tintedTexture=t.CanvasTinter.getTintedTexture(this,this.tint)}e.context.drawImage(this.tintedTexture,0,0,this.texture.crop.width,this.texture.crop.height,r/n,i/n,this.texture.crop.width/n,this.texture.crop.height/n)}else{e.context.drawImage(this.texture.baseTexture.source,this.texture.crop.x,this.texture.crop.y,this.texture.crop.width,this.texture.crop.height,r/n,i/n,this.texture.crop.width/n,this.texture.crop.height/n)}}for(var s=0,o=this.children.length;s<o;s++){this.children[s]._renderCanvas(e)}if(this._mask){e.maskManager.popMask(e)}};t.Sprite.fromFrame=function(e){var n=t.TextureCache[e];if(!n)throw new Error('The frameId "'+e+'" does not exist in the texture cache'+this);return new t.Sprite(n)};t.Sprite.fromImage=function(e,n,r){var i=t.Texture.fromImage(e,n,r);return new t.Sprite(i)};t.SpriteBatch=function(e){t.DisplayObjectContainer.call(this);this.textureThing=e;this.ready=false};t.SpriteBatch.prototype=Object.create(t.DisplayObjectContainer.prototype);t.SpriteBatch.constructor=t.SpriteBatch;t.SpriteBatch.prototype.initWebGL=function(e){this.fastSpriteBatch=new t.WebGLFastSpriteBatch(e);this.ready=true};t.SpriteBatch.prototype.updateTransform=function(){t.DisplayObject.prototype.updateTransform.call(this)};t.SpriteBatch.prototype._renderWebGL=function(e){if(!this.visible||this.alpha<=0||!this.children.length)return;if(!this.ready)this.initWebGL(e.gl);e.spriteBatch.stop();e.shaderManager.setShader(e.shaderManager.fastShader);this.fastSpriteBatch.begin(this,e);this.fastSpriteBatch.render(this);e.spriteBatch.start()};t.SpriteBatch.prototype._renderCanvas=function(e){if(!this.visible||this.alpha<=0||!this.children.length)return;var n=e.context;n.globalAlpha=this.worldAlpha;t.DisplayObject.prototype.updateTransform.call(this);var r=this.worldTransform;var i=true;for(var s=0;s<this.children.length;s++){var o=this.children[s];if(!o.visible)continue;var u=o.texture;var a=u.frame;n.globalAlpha=this.worldAlpha*o.alpha;if(o.rotation%(Math.PI*2)===0){if(i){n.setTransform(r.a,r.c,r.b,r.d,r.tx,r.ty);i=false}n.drawImage(u.baseTexture.source,a.x,a.y,a.width,a.height,o.anchor.x*-a.width*o.scale.x+o.position.x+.5|0,o.anchor.y*-a.height*o.scale.y+o.position.y+.5|0,a.width*o.scale.x,a.height*o.scale.y)}else{if(!i)i=true;t.DisplayObject.prototype.updateTransform.call(o);var f=o.worldTransform;if(e.roundPixels){n.setTransform(f.a,f.c,f.b,f.d,f.tx|0,f.ty|0)}else{n.setTransform(f.a,f.c,f.b,f.d,f.tx,f.ty)}n.drawImage(u.baseTexture.source,a.x,a.y,a.width,a.height,o.anchor.x*-a.width+.5|0,o.anchor.y*-a.height+.5|0,a.width,a.height)}}};t.MovieClip=function(e){t.Sprite.call(this,e[0]);this.textures=e;this.animationSpeed=1;this.loop=true;this.onComplete=null;this.currentFrame=0;this.playing=false};t.MovieClip.prototype=Object.create(t.Sprite.prototype);t.MovieClip.prototype.constructor=t.MovieClip;Object.defineProperty(t.MovieClip.prototype,"totalFrames",{get:function(){return this.textures.length}});t.MovieClip.prototype.stop=function(){this.playing=false};t.MovieClip.prototype.play=function(){this.playing=true};t.MovieClip.prototype.gotoAndStop=function(e){this.playing=false;this.currentFrame=e;var t=this.currentFrame+.5|0;this.setTexture(this.textures[t%this.textures.length])};t.MovieClip.prototype.gotoAndPlay=function(e){this.currentFrame=e;this.playing=true};t.MovieClip.prototype.updateTransform=function(){t.Sprite.prototype.updateTransform.call(this);if(!this.playing)return;this.currentFrame+=this.animationSpeed;var e=this.currentFrame+.5|0;this.currentFrame=this.currentFrame%this.textures.length;if(this.loop||e<this.textures.length){this.setTexture(this.textures[e%this.textures.length])}else if(e>=this.textures.length){this.gotoAndStop(this.textures.length-1);if(this.onComplete){this.onComplete()}}};t.MovieClip.fromFrames=function(e){var n=[];for(var r=0;r<e.length;r++){n.push(new t.Texture.fromFrame(e[r]))}return new t.MovieClip(n)};t.MovieClip.fromImages=function(e){var n=[];for(var r=0;r<e.length;r++){n.push(new t.Texture.fromImage(e[r]))}return new t.MovieClip(n)};t.FilterBlock=function(){this.visible=true;this.renderable=true};t.Text=function(e,n){this.canvas=document.createElement("canvas");this.context=this.canvas.getContext("2d");this.resolution=1;t.Sprite.call(this,t.Texture.fromCanvas(this.canvas));this.setText(e);this.setStyle(n)};t.Text.prototype=Object.create(t.Sprite.prototype);t.Text.prototype.constructor=t.Text;Object.defineProperty(t.Text.prototype,"width",{get:function(){if(this.dirty){this.updateText();this.dirty=false}return this.scale.x*this.texture.frame.width},set:function(e){this.scale.x=e/this.texture.frame.width;this._width=e}});Object.defineProperty(t.Text.prototype,"height",{get:function(){if(this.dirty){this.updateText();this.dirty=false}return this.scale.y*this.texture.frame.height},set:function(e){this.scale.y=e/this.texture.frame.height;this._height=e}});t.Text.prototype.setStyle=function(e){e=e||{};e.font=e.font||"bold 20pt Arial";e.fill=e.fill||"black";e.align=e.align||"left";e.stroke=e.stroke||"black";e.strokeThickness=e.strokeThickness||0;e.wordWrap=e.wordWrap||false;e.wordWrapWidth=e.wordWrapWidth||100;e.dropShadow=e.dropShadow||false;e.dropShadowAngle=e.dropShadowAngle||Math.PI/6;e.dropShadowDistance=e.dropShadowDistance||4;e.dropShadowColor=e.dropShadowColor||"black";this.style=e;this.dirty=true};t.Text.prototype.setText=function(e){this.text=e.toString()||" ";this.dirty=true};t.Text.prototype.updateText=function(){this.texture.baseTexture.resolution=this.resolution;this.context.font=this.style.font;var e=this.text;if(this.style.wordWrap)e=this.wordWrap(this.text);var t=e.split(/(?:\r\n|\r|\n)/);var n=[];var r=0;for(var i=0;i<t.length;i++){var s=this.context.measureText(t[i]).width;n[i]=s;r=Math.max(r,s)}var o=r+this.style.strokeThickness;if(this.style.dropShadow)o+=this.style.dropShadowDistance;this.canvas.width=(o+this.context.lineWidth)*this.resolution;var u=this.determineFontHeight("font: "+this.style.font+";")+this.style.strokeThickness;var a=u*t.length;if(this.style.dropShadow)a+=this.style.dropShadowDistance;this.canvas.height=a*this.resolution;this.context.scale(this.resolution,this.resolution);if(navigator.isCocoonJS)this.context.clearRect(0,0,this.canvas.width,this.canvas.height);this.context.font=this.style.font;this.context.strokeStyle=this.style.stroke;this.context.lineWidth=this.style.strokeThickness;this.context.textBaseline="top";var f;var l;if(this.style.dropShadow){this.context.fillStyle=this.style.dropShadowColor;var c=Math.sin(this.style.dropShadowAngle)*this.style.dropShadowDistance;var h=Math.cos(this.style.dropShadowAngle)*this.style.dropShadowDistance;for(i=0;i<t.length;i++){f=this.style.strokeThickness/2;l=this.style.strokeThickness/2+i*u;if(this.style.align==="right"){f+=r-n[i]}else if(this.style.align==="center"){f+=(r-n[i])/2}if(this.style.fill){this.context.fillText(t[i],f+c,l+h)}}}this.context.fillStyle=this.style.fill;for(i=0;i<t.length;i++){f=this.style.strokeThickness/2;l=this.style.strokeThickness/2+i*u;if(this.style.align==="right"){f+=r-n[i]}else if(this.style.align==="center"){f+=(r-n[i])/2}if(this.style.stroke&&this.style.strokeThickness){this.context.strokeText(t[i],f,l)}if(this.style.fill){this.context.fillText(t[i],f,l)}}this.updateTexture()};t.Text.prototype.updateTexture=function(){this.texture.baseTexture.width=this.canvas.width;this.texture.baseTexture.height=this.canvas.height;this.texture.crop.width=this.texture.frame.width=this.canvas.width;this.texture.crop.height=this.texture.frame.height=this.canvas.height;this._width=this.canvas.width;this._height=this.canvas.height};t.Text.prototype._renderWebGL=function(e){if(this.dirty){this.resolution=e.resolution;this.updateText();this.dirty=false;t.updateWebGLTexture(this.texture.baseTexture,e.gl)}t.Sprite.prototype._renderWebGL.call(this,e)};t.Text.prototype._renderCanvas=function(e){if(this.dirty){this.resolution=e.resolution;this.updateText();this.dirty=false}t.Sprite.prototype._renderCanvas.call(this,e)};t.Text.prototype.determineFontHeight=function(e){var n=t.Text.heightCache[e];if(!n){var r=document.getElementsByTagName("body")[0];var i=document.createElement("div");var s=document.createTextNode("M");i.appendChild(s);i.setAttribute("style",e+";position:absolute;top:0;left:0");r.appendChild(i);n=i.offsetHeight;t.Text.heightCache[e]=n;r.removeChild(i)}return n};t.Text.prototype.wordWrap=function(e){var t="";var n=e.split("\n");for(var r=0;r<n.length;r++){var i=this.style.wordWrapWidth;var s=n[r].split(" ");for(var o=0;o<s.length;o++){var u=this.context.measureText(s[o]).width;var a=u+this.context.measureText(" ").width;if(o===0||a>i){if(o>0){t+="\n"}t+=s[o];i=this.style.wordWrapWidth-u}else{i-=a;t+=" "+s[o]}}if(r<n.length-1){t+="\n"}}return t};t.Text.prototype.destroy=function(e){this.context=null;this.canvas=null;this.texture.destroy(e===undefined?true:e)};t.Text.heightCache={};t.BitmapText=function(e,n){t.DisplayObjectContainer.call(this);this._pool=[];this.setText(e);this.setStyle(n);this.updateText();this.dirty=false};t.BitmapText.prototype=Object.create(t.DisplayObjectContainer.prototype);t.BitmapText.prototype.constructor=t.BitmapText;t.BitmapText.prototype.setText=function(e){this.text=e||" ";this.dirty=true};t.BitmapText.prototype.setStyle=function(e){e=e||{};e.align=e.align||"left";this.style=e;var n=e.font.split(" ");this.fontName=n[n.length-1];this.fontSize=n.length>=2?parseInt(n[n.length-2],10):t.BitmapText.fonts[this.fontName].size;this.dirty=true;this.tint=e.tint};t.BitmapText.prototype.updateText=function(){var e=t.BitmapText.fonts[this.fontName];var n=new t.Point;var r=null;var i=[];var s=0;var o=[];var u=0;var a=this.fontSize/e.size;for(var f=0;f<this.text.length;f++){var l=this.text.charCodeAt(f);if(/(?:\r\n|\r|\n)/.test(this.text.charAt(f))){o.push(n.x);s=Math.max(s,n.x);u++;n.x=0;n.y+=e.lineHeight;r=null;continue}var c=e.chars[l];if(!c)continue;if(r&&c[r]){n.x+=c.kerning[r]}i.push({texture:c.texture,line:u,charCode:l,position:new t.Point(n.x+c.xOffset,n.y+c.yOffset)});n.x+=c.xAdvance;r=l}o.push(n.x);s=Math.max(s,n.x);var h=[];for(f=0;f<=u;f++){var p=0;if(this.style.align==="right"){p=s-o[f]}else if(this.style.align==="center"){p=(s-o[f])/2}h.push(p)}var d=this.children.length;var v=i.length;var m=this.tint||16777215;for(f=0;f<v;f++){var g=f<d?this.children[f]:this._pool.pop();if(g)g.setTexture(i[f].texture);else g=new t.Sprite(i[f].texture);g.position.x=(i[f].position.x+h[i[f].line])*a;g.position.y=i[f].position.y*a;g.scale.x=g.scale.y=a;g.tint=m;if(!g.parent)this.addChild(g)}while(this.children.length>v){var y=this.getChildAt(this.children.length-1);this._pool.push(y);this.removeChild(y)}this.textWidth=s*a;this.textHeight=(n.y+e.lineHeight)*a};t.BitmapText.prototype.updateTransform=function(){if(this.dirty){this.updateText();this.dirty=false}t.DisplayObjectContainer.prototype.updateTransform.call(this)};t.BitmapText.fonts={};t.InteractionData=function(){this.global=new t.Point;this.target=null;this.originalEvent=null};t.InteractionData.prototype.getLocalPosition=function(e,n){var r=e.worldTransform;var i=this.global;var s=r.a,o=r.b,u=r.tx,a=r.c,f=r.d,l=r.ty,c=1/(s*f+o*-a);n=n||new t.Point;n.x=f*c*i.x+ -o*c*i.y+(l*o-u*f)*c;n.y=s*c*i.y+ -a*c*i.x+(-l*s+u*a)*c;return n};t.InteractionData.prototype.constructor=t.InteractionData;t.InteractionManager=function(e){this.stage=e;this.mouse=new t.InteractionData;this.touchs={};this.tempPoint=new t.Point;this.mouseoverEnabled=true;this.pool=[];this.interactiveItems=[];this.interactionDOMElement=null;this.onMouseMove=this.onMouseMove.bind(this);this.onMouseDown=this.onMouseDown.bind(this);this.onMouseOut=this.onMouseOut.bind(this);this.onMouseUp=this.onMouseUp.bind(this);this.onTouchStart=this.onTouchStart.bind(this);this.onTouchEnd=this.onTouchEnd.bind(this);this.onTouchMove=this.onTouchMove.bind(this);this.last=0;this.currentCursorStyle="inherit";this.mouseOut=false;this.resolution=1};t.InteractionManager.prototype.constructor=t.InteractionManager;t.InteractionManager.prototype.collectInteractiveSprite=function(e,t){var n=e.children;var r=n.length;for(var i=r-1;i>=0;i--){var s=n[i];if(s._interactive){t.interactiveChildren=true;this.interactiveItems.push(s);if(s.children.length>0){this.collectInteractiveSprite(s,s)}}else{s.__iParent=null;if(s.children.length>0){this.collectInteractiveSprite(s,t)}}}};t.InteractionManager.prototype.setTarget=function(e){this.target=e;this.resolution=e.resolution;if(this.interactionDOMElement===null){this.setTargetDomElement(e.view)}};t.InteractionManager.prototype.setTargetDomElement=function(e){this.removeEvents();if(window.navigator.msPointerEnabled){e.style["-ms-content-zooming"]="none";e.style["-ms-touch-action"]="none"}this.interactionDOMElement=e;e.addEventListener("mousemove",this.onMouseMove,true);e.addEventListener("mousedown",this.onMouseDown,true);e.addEventListener("mouseout",this.onMouseOut,true);e.addEventListener("touchstart",this.onTouchStart,true);e.addEventListener("touchend",this.onTouchEnd,true);e.addEventListener("touchmove",this.onTouchMove,true)};t.InteractionManager.prototype.removeEvents=function(){if(!this.interactionDOMElement)return;this.interactionDOMElement.style["-ms-content-zooming"]="";this.interactionDOMElement.style["-ms-touch-action"]="";this.interactionDOMElement.removeEventListener("mousemove",this.onMouseMove,true);this.interactionDOMElement.removeEventListener("mousedown",this.onMouseDown,true);this.interactionDOMElement.removeEventListener("mouseout",this.onMouseOut,true);this.interactionDOMElement.removeEventListener("touchstart",this.onTouchStart,true);this.interactionDOMElement.removeEventListener("touchend",this.onTouchEnd,true);this.interactionDOMElement.removeEventListener("touchmove",this.onTouchMove,true);this.interactionDOMElement=null};t.InteractionManager.prototype.update=function(){if(!this.target)return;var e=Date.now();var n=e-this.last;n=n*t.INTERACTION_FREQUENCY/1e3;if(n<1)return;this.last=e;var r=0;if(this.dirty){this.rebuildInteractiveGraph()}var i=this.interactiveItems.length;var s="inherit";var o=false;for(r=0;r<i;r++){var u=this.interactiveItems[r];u.__hit=this.hitTest(u,this.mouse);this.mouse.target=u;if(u.__hit&&!o){if(u.buttonMode)s=u.defaultCursor;if(!u.interactiveChildren)o=true;if(!u.__isOver){if(u.mouseover)u.mouseover(this.mouse);u.__isOver=true}}else{if(u.__isOver){if(u.mouseout)u.mouseout(this.mouse);u.__isOver=false}}}if(this.currentCursorStyle!==s){this.currentCursorStyle=s;this.interactionDOMElement.style.cursor=s}};t.InteractionManager.prototype.rebuildInteractiveGraph=function(){this.dirty=false;var e=this.interactiveItems.length;for(var t=0;t<e;t++){this.interactiveItems[t].interactiveChildren=false}this.interactiveItems=[];if(this.stage.interactive)this.interactiveItems.push(this.stage);this.collectInteractiveSprite(this.stage,this.stage)};t.InteractionManager.prototype.onMouseMove=function(e){if(this.dirty){this.rebuildInteractiveGraph()}this.mouse.originalEvent=e||window.event;var t=this.interactionDOMElement.getBoundingClientRect();this.mouse.global.x=(e.clientX-t.left)*(this.target.width/t.width)/this.resolution;this.mouse.global.y=(e.clientY-t.top)*(this.target.height/t.height)/this.resolution;var n=this.interactiveItems.length;for(var r=0;r<n;r++){var i=this.interactiveItems[r];if(i.mousemove){i.mousemove(this.mouse)}}};t.InteractionManager.prototype.onMouseDown=function(e){if(this.dirty){this.rebuildInteractiveGraph()}this.mouse.originalEvent=e||window.event;if(t.AUTO_PREVENT_DEFAULT)this.mouse.originalEvent.preventDefault();var n=this.interactiveItems.length;var r=this.mouse.originalEvent;var i=r.button===2||r.which===3;var s=i?"rightdown":"mousedown";var o=i?"rightclick":"click";var u=i?"__rightIsDown":"__mouseIsDown";var a=i?"__isRightDown":"__isDown";for(var f=0;f<n;f++){var l=this.interactiveItems[f];if(l[s]||l[o]){l[u]=true;l.__hit=this.hitTest(l,this.mouse);if(l.__hit){if(l[s])l[s](this.mouse);l[a]=true;if(!l.interactiveChildren)break}}}};t.InteractionManager.prototype.onMouseOut=function(e){if(this.dirty){this.rebuildInteractiveGraph()}this.mouse.originalEvent=e||window.event;var t=this.interactiveItems.length;this.interactionDOMElement.style.cursor="inherit";for(var n=0;n<t;n++){var r=this.interactiveItems[n];if(r.__isOver){this.mouse.target=r;if(r.mouseout)r.mouseout(this.mouse);r.__isOver=false}}this.mouseOut=true;this.mouse.global.x=-1e4;this.mouse.global.y=-1e4};t.InteractionManager.prototype.onMouseUp=function(e){if(this.dirty){this.rebuildInteractiveGraph()}this.mouse.originalEvent=e||window.event;var t=this.interactiveItems.length;var n=false;var r=this.mouse.originalEvent;var i=r.button===2||r.which===3;var s=i?"rightup":"mouseup";var o=i?"rightclick":"click";var u=i?"rightupoutside":"mouseupoutside";var a=i?"__isRightDown":"__isDown";for(var f=0;f<t;f++){var l=this.interactiveItems[f];if(l[o]||l[s]||l[u]){l.__hit=this.hitTest(l,this.mouse);if(l.__hit&&!n){if(l[s]){l[s](this.mouse)}if(l[a]){if(l[o])l[o](this.mouse)}if(!l.interactiveChildren)n=true}else{if(l[a]){if(l[u])l[u](this.mouse)}}l[a]=false}}};t.InteractionManager.prototype.hitTest=function(e,n){var r=n.global;if(!e.worldVisible)return false;var i=e instanceof t.Sprite,s=e.worldTransform,o=s.a,u=s.b,a=s.tx,f=s.c,l=s.d,c=s.ty,h=1/(o*l+u*-f),p=l*h*r.x+ -u*h*r.y+(c*u-a*l)*h,d=o*h*r.y+ -f*h*r.x+(-c*o+a*f)*h;n.target=e;if(e.hitArea&&e.hitArea.contains){if(e.hitArea.contains(p,d)){n.target=e;return true}return false}else if(i){var v=e.texture.frame.width,m=e.texture.frame.height,g=-v*e.anchor.x,y;if(p>g&&p<g+v){y=-m*e.anchor.y;if(d>y&&d<y+m){n.target=e;return true}}}var b=e.children.length;for(var w=0;w<b;w++){var E=e.children[w];var S=this.hitTest(E,n);if(S){n.target=e;return true}}return false};t.InteractionManager.prototype.onTouchMove=function(e){if(this.dirty){this.rebuildInteractiveGraph()}var t=this.interactionDOMElement.getBoundingClientRect();var n=e.changedTouches;var r;var i=0;for(i=0;i<n.length;i++){var s=n[i];r=this.touchs[s.identifier];r.originalEvent=e||window.event;r.global.x=(s.clientX-t.left)*(this.target.width/t.width)/this.resolution;r.global.y=(s.clientY-t.top)*(this.target.height/t.height)/this.resolution;if(navigator.isCocoonJS&&!t.left&&!t.top&&!e.target.style.width&&!e.target.style.height){r.global.x=s.clientX;r.global.y=s.clientY}for(var o=0;o<this.interactiveItems.length;o++){var u=this.interactiveItems[o];if(u.touchmove&&u.__touchData&&u.__touchData[s.identifier])u.touchmove(r)}}};t.InteractionManager.prototype.onTouchStart=function(e){if(this.dirty){this.rebuildInteractiveGraph()}var n=this.interactionDOMElement.getBoundingClientRect();if(t.AUTO_PREVENT_DEFAULT)e.preventDefault();var r=e.changedTouches;for(var i=0;i<r.length;i++){var s=r[i];var o=this.pool.pop();if(!o)o=new t.InteractionData;o.originalEvent=e||window.event;this.touchs[s.identifier]=o;o.global.x=(s.clientX-n.left)*(this.target.width/n.width)/this.resolution;o.global.y=(s.clientY-n.top)*(this.target.height/n.height)/this.resolution;if(navigator.isCocoonJS&&!n.left&&!n.top&&!e.target.style.width&&!e.target.style.height){o.global.x=s.clientX;o.global.y=s.clientY}var u=this.interactiveItems.length;for(var a=0;a<u;a++){var f=this.interactiveItems[a];if(f.touchstart||f.tap){f.__hit=this.hitTest(f,o);if(f.__hit){if(f.touchstart)f.touchstart(o);f.__isDown=true;f.__touchData=f.__touchData||{};f.__touchData[s.identifier]=o;if(!f.interactiveChildren)break}}}}};t.InteractionManager.prototype.onTouchEnd=function(e){if(this.dirty){this.rebuildInteractiveGraph()}var t=this.interactionDOMElement.getBoundingClientRect();var n=e.changedTouches;for(var r=0;r<n.length;r++){var i=n[r];var s=this.touchs[i.identifier];var o=false;s.global.x=(i.clientX-t.left)*(this.target.width/t.width)/this.resolution;s.global.y=(i.clientY-t.top)*(this.target.height/t.height)/this.resolution;if(navigator.isCocoonJS&&!t.left&&!t.top&&!e.target.style.width&&!e.target.style.height){s.global.x=i.clientX;s.global.y=i.clientY}var u=this.interactiveItems.length;for(var a=0;a<u;a++){var f=this.interactiveItems[a];if(f.__touchData&&f.__touchData[i.identifier]){f.__hit=this.hitTest(f,f.__touchData[i.identifier]);s.originalEvent=e||window.event;if(f.touchend||f.tap){if(f.__hit&&!o){if(f.touchend)f.touchend(s);if(f.__isDown){if(f.tap)f.tap(s)}if(!f.interactiveChildren)o=true}else{if(f.__isDown){if(f.touchendoutside)f.touchendoutside(s)}}f.__isDown=false}f.__touchData[i.identifier]=null}}this.pool.push(s);this.touchs[i.identifier]=null}};t.Stage=function(e){t.DisplayObjectContainer.call(this);this.worldTransform=new t.Matrix;this.interactive=true;this.interactionManager=new t.InteractionManager(this);this.dirty=true;this.stage=this;this.stage.hitArea=new t.Rectangle(0,0,1e5,1e5);this.setBackgroundColor(e)};t.Stage.prototype=Object.create(t.DisplayObjectContainer.prototype);t.Stage.prototype.constructor=t.Stage;t.Stage.prototype.setInteractionDelegate=function(e){this.interactionManager.setTargetDomElement(e)};t.Stage.prototype.updateTransform=function(){this.worldAlpha=1;for(var e=0,t=this.children.length;e<t;e++){this.children[e].updateTransform()}if(this.dirty){this.dirty=false;this.interactionManager.dirty=true}if(this.interactive)this.interactionManager.update()};t.Stage.prototype.setBackgroundColor=function(e){this.backgroundColor=e||0;this.backgroundColorSplit=t.hex2rgb(this.backgroundColor);var n=this.backgroundColor.toString(16);n="000000".substr(0,6-n.length)+n;this.backgroundColorString="#"+n};t.Stage.prototype.getMousePosition=function(){return this.interactionManager.mouse.global};t.hex2rgb=function(e){return[(e>>16&255)/255,(e>>8&255)/255,(e&255)/255]};t.rgb2hex=function(e){return(e[0]*255<<16)+(e[1]*255<<8)+e[2]*255};if(typeof Function.prototype.bind!=="function"){Function.prototype.bind=function(){return function(e){function i(){var n=arguments.length,s=new Array(n);while(n--)s[n]=arguments[n];s=r.concat(s);t.apply(this instanceof i?this:e,s)}var t=this,n=arguments.length-1,r=[];if(n>0){r.length=n;while(n--)r[n]=arguments[n+1]}if(typeof t!=="function")throw new TypeError;i.prototype=function s(e){if(e)s.prototype=e;if(!(this instanceof s))return new s}(t.prototype);return i}}()}t.AjaxRequest=function(){var e=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.3.0","Microsoft.XMLHTTP"];if(window.ActiveXObject){for(var t=0;t<e.length;t++){try{return new window.ActiveXObject(e[t])}catch(n){}}}else if(window.XMLHttpRequest){return new window.XMLHttpRequest}else{return false}};t.canUseNewCanvasBlendModes=function(){if(typeof document==="undefined")return false;var e=document.createElement("canvas");e.width=1;e.height=1;var t=e.getContext("2d");t.fillStyle="#000";t.fillRect(0,0,1,1);t.globalCompositeOperation="multiply";t.fillStyle="#fff";t.fillRect(0,0,1,1);return t.getImageData(0,0,1,1).data[0]===0};t.getNextPowerOfTwo=function(e){if(e>0&&(e&e-1)===0)return e;else{var t=1;while(t<e)t<<=1;return t}};t.EventTarget=function(){var e={};this.addEventListener=this.on=function(t,n){if(e[t]===undefined){e[t]=[]}if(e[t].indexOf(n)===-1){e[t].unshift(n)}};this.dispatchEvent=this.emit=function(t){if(!e[t.type]||!e[t.type].length){return}for(var n=e[t.type].length-1;n>=0;n--){e[t.type][n](t)}};this.removeEventListener=this.off=function(t,n){if(e[t]===undefined)return;var r=e[t].indexOf(n);if(r!==-1){e[t].splice(r,1)}};this.removeAllEventListeners=function(t){var n=e[t];if(n)n.length=0}};t.autoDetectRenderer=function(){function r(e,t){function n(){return e.apply(this,t)}n.prototype=e.prototype;return new n}var e=Array.prototype.slice.call(arguments);if(typeof e[0]=="undefined")e[0]=800;if(typeof e[1]=="undefined")e[1]=600;var n=function(){try{var e=document.createElement("canvas");return!!window.WebGLRenderingContext&&(e.getContext("webgl")||e.getContext("experimental-webgl"))}catch(t){return false}}();return r(t[(n?"WebGL":"Canvas")+"Renderer"],e)};t.autoDetectRecommendedRenderer=function(e,n,r){if(!e)e=800;if(!n)n=600;var i=function(){try{var e=document.createElement("canvas");return!!window.WebGLRenderingContext&&(e.getContext("webgl")||e.getContext("experimental-webgl"))}catch(t){return false}}();var s=/Android/i.test(navigator.userAgent);if(i&&!s){return new t.WebGLRenderer(e,n,r)}return new t.CanvasRenderer(e,n,r)};t.PolyK={};t.PolyK.Triangulate=function(e){var n=true;var r=e.length>>1;if(r<3)return[];var i=[];var s=[];for(var o=0;o<r;o++)s.push(o);o=0;var u=r;while(u>3){var a=s[(o+0)%u];var f=s[(o+1)%u];var l=s[(o+2)%u];var c=e[2*a],h=e[2*a+1];var p=e[2*f],d=e[2*f+1];var v=e[2*l],m=e[2*l+1];var g=false;if(t.PolyK._convex(c,h,p,d,v,m,n)){g=true;for(var y=0;y<u;y++){var b=s[y];if(b===a||b===f||b===l)continue;if(t.PolyK._PointInTriangle(e[2*b],e[2*b+1],c,h,p,d,v,m)){g=false;break}}}if(g){i.push(a,f,l);s.splice((o+1)%u,1);u--;o=0}else if(o++>3*u){if(n){i=[];s=[];for(o=0;o<r;o++)s.push(o);o=0;u=r;n=false}else{window.console.log("PIXI Warning: shape too complex to fill");return[]}}}i.push(s[0],s[1],s[2]);return i};t.PolyK._PointInTriangle=function(e,t,n,r,i,s,o,u){var a=o-n;var f=u-r;var l=i-n;var c=s-r;var h=e-n;var p=t-r;var d=a*a+f*f;var v=a*l+f*c;var m=a*h+f*p;var g=l*l+c*c;var y=l*h+c*p;var b=1/(d*g-v*v);var w=(g*m-v*y)*b;var E=(d*y-v*m)*b;return w>=0&&E>=0&&w+E<1};t.PolyK._convex=function(e,t,n,r,i,s,o){return(t-r)*(i-n)+(n-e)*(s-r)>=0===o};t.initDefaultShaders=function(){};t.CompileVertexShader=function(e,n){return t._CompileShader(e,n,e.VERTEX_SHADER)};t.CompileFragmentShader=function(e,n){return t._CompileShader(e,n,e.FRAGMENT_SHADER)};t._CompileShader=function(e,t,n){var r=t.join("\n");var i=e.createShader(n);e.shaderSource(i,r);e.compileShader(i);if(!e.getShaderParameter(i,e.COMPILE_STATUS)){window.console.log(e.getShaderInfoLog(i));return null}return i};t.compileProgram=function(e,n,r){var i=t.CompileFragmentShader(e,r);var s=t.CompileVertexShader(e,n);var o=e.createProgram();e.attachShader(o,s);e.attachShader(o,i);e.linkProgram(o);if(!e.getProgramParameter(o,e.LINK_STATUS)){window.console.log("Could not initialise shaders")}return o};t.PixiShader=function(e){this._UID=t._UID++;this.gl=e;this.program=null;this.fragmentSrc=["precision lowp float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;","}"];this.textureCount=0;this.attributes=[];this.init()};t.PixiShader.prototype.init=function(){var e=this.gl;var n=t.compileProgram(e,this.vertexSrc||t.PixiShader.defaultVertexSrc,this.fragmentSrc);e.useProgram(n);this.uSampler=e.getUniformLocation(n,"uSampler");this.projectionVector=e.getUniformLocation(n,"projectionVector");this.offsetVector=e.getUniformLocation(n,"offsetVector");this.dimensions=e.getUniformLocation(n,"dimensions");this.aVertexPosition=e.getAttribLocation(n,"aVertexPosition");this.aTextureCoord=e.getAttribLocation(n,"aTextureCoord");this.colorAttribute=e.getAttribLocation(n,"aColor");if(this.colorAttribute===-1){this.colorAttribute=2}this.attributes=[this.aVertexPosition,this.aTextureCoord,this.colorAttribute];for(var r in this.uniforms){this.uniforms[r].uniformLocation=e.getUniformLocation(n,r)}this.initUniforms();this.program=n};t.PixiShader.prototype.initUniforms=function(){this.textureCount=1;var e=this.gl;var t;for(var n in this.uniforms){t=this.uniforms[n];var r=t.type;if(r==="sampler2D"){t._init=false;if(t.value!==null){this.initSampler2D(t)}}else if(r==="mat2"||r==="mat3"||r==="mat4"){t.glMatrix=true;t.glValueLength=1;if(r==="mat2"){t.glFunc=e.uniformMatrix2fv}else if(r==="mat3"){t.glFunc=e.uniformMatrix3fv}else if(r==="mat4"){t.glFunc=e.uniformMatrix4fv}}else{t.glFunc=e["uniform"+r];if(r==="2f"||r==="2i"){t.glValueLength=2}else if(r==="3f"||r==="3i"){t.glValueLength=3}else if(r==="4f"||r==="4i"){t.glValueLength=4}else{t.glValueLength=1}}}};t.PixiShader.prototype.initSampler2D=function(e){if(!e.value||!e.value.baseTexture||!e.value.baseTexture.hasLoaded){return}var t=this.gl;t.activeTexture(t["TEXTURE"+this.textureCount]);t.bindTexture(t.TEXTURE_2D,e.value.baseTexture._glTextures[t.id]);if(e.textureData){var n=e.textureData;var r=n.magFilter?n.magFilter:t.LINEAR;var i=n.minFilter?n.minFilter:t.LINEAR;var s=n.wrapS?n.wrapS:t.CLAMP_TO_EDGE;var o=n.wrapT?n.wrapT:t.CLAMP_TO_EDGE;var u=n.luminance?t.LUMINANCE:t.RGBA;if(n.repeat){s=t.REPEAT;o=t.REPEAT}t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,!!n.flipY);if(n.width){var a=n.width?n.width:512;var f=n.height?n.height:2;var l=n.border?n.border:0;t.texImage2D(t.TEXTURE_2D,0,u,a,f,l,u,t.UNSIGNED_BYTE,null)}else{t.texImage2D(t.TEXTURE_2D,0,u,t.RGBA,t.UNSIGNED_BYTE,e.value.baseTexture.source)}t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,r);t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,i);t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,s);t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,o)}t.uniform1i(e.uniformLocation,this.textureCount);e._init=true;this.textureCount++};t.PixiShader.prototype.syncUniforms=function(){this.textureCount=1;var e;var n=this.gl;for(var r in this.uniforms){e=this.uniforms[r];if(e.glValueLength===1){if(e.glMatrix===true){e.glFunc.call(n,e.uniformLocation,e.transpose,e.value)}else{e.glFunc.call(n,e.uniformLocation,e.value)}}else if(e.glValueLength===2){e.glFunc.call(n,e.uniformLocation,e.value.x,e.value.y)}else if(e.glValueLength===3){e.glFunc.call(n,e.uniformLocation,e.value.x,e.value.y,e.value.z)}else if(e.glValueLength===4){e.glFunc.call(n,e.uniformLocation,e.value.x,e.value.y,e.value.z,e.value.w)}else if(e.type==="sampler2D"){if(e._init){n.activeTexture(n["TEXTURE"+this.textureCount]);n.bindTexture(n.TEXTURE_2D,e.value.baseTexture._glTextures[n.id]||t.createWebGLTexture(e.value.baseTexture,n));n.uniform1i(e.uniformLocation,this.textureCount);this.textureCount++}else{this.initSampler2D(e)}}}};t.PixiShader.prototype.destroy=function(){this.gl.deleteProgram(this.program);this.uniforms=null;this.gl=null;this.attributes=null};t.PixiShader.defaultVertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute vec2 aColor;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","varying vec2 vTextureCoord;","varying vec4 vColor;","const vec2 center = vec2(-1.0, 1.0);","void main(void) {","   gl_Position = vec4( ((aVertexPosition + offsetVector) / projectionVector) + center , 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vec3 color = mod(vec3(aColor.y/65536.0, aColor.y/256.0, aColor.y), 256.0) / 256.0;","   vColor = vec4(color * aColor.x, aColor.x);","}"];t.PixiFastShader=function(e){this._UID=t._UID++;this.gl=e;this.program=null;this.fragmentSrc=["precision lowp float;","varying vec2 vTextureCoord;","varying float vColor;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;","}"];this.vertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aPositionCoord;","attribute vec2 aScale;","attribute float aRotation;","attribute vec2 aTextureCoord;","attribute float aColor;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","uniform mat3 uMatrix;","varying vec2 vTextureCoord;","varying float vColor;","const vec2 center = vec2(-1.0, 1.0);","void main(void) {","   vec2 v;","   vec2 sv = aVertexPosition * aScale;","   v.x = (sv.x) * cos(aRotation) - (sv.y) * sin(aRotation);","   v.y = (sv.x) * sin(aRotation) + (sv.y) * cos(aRotation);","   v = ( uMatrix * vec3(v + aPositionCoord , 1.0) ).xy ;","   gl_Position = vec4( ( v / projectionVector) + center , 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vColor = aColor;","}"];this.textureCount=0;this.init()};t.PixiFastShader.prototype.init=function(){var e=this.gl;var n=t.compileProgram(e,this.vertexSrc,this.fragmentSrc);e.useProgram(n);this.uSampler=e.getUniformLocation(n,"uSampler");this.projectionVector=e.getUniformLocation(n,"projectionVector");this.offsetVector=e.getUniformLocation(n,"offsetVector");this.dimensions=e.getUniformLocation(n,"dimensions");this.uMatrix=e.getUniformLocation(n,"uMatrix");this.aVertexPosition=e.getAttribLocation(n,"aVertexPosition");this.aPositionCoord=e.getAttribLocation(n,"aPositionCoord");this.aScale=e.getAttribLocation(n,"aScale");this.aRotation=e.getAttribLocation(n,"aRotation");this.aTextureCoord=e.getAttribLocation(n,"aTextureCoord");this.colorAttribute=e.getAttribLocation(n,"aColor");if(this.colorAttribute===-1){this.colorAttribute=2}this.attributes=[this.aVertexPosition,this.aPositionCoord,this.aScale,this.aRotation,this.aTextureCoord,this.colorAttribute];this.program=n};t.PixiFastShader.prototype.destroy=function(){this.gl.deleteProgram(this.program);this.uniforms=null;this.gl=null;this.attributes=null};t.StripShader=function(e){this._UID=t._UID++;this.gl=e;this.program=null;this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","uniform float alpha;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y));","}"];this.vertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","uniform mat3 translationMatrix;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","varying vec2 vTextureCoord;","void main(void) {","   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);","   v -= offsetVector.xyx;","   gl_Position = vec4( v.x / projectionVector.x -1.0, v.y / -projectionVector.y + 1.0 , 0.0, 1.0);","   vTextureCoord = aTextureCoord;","}"];this.init()};t.StripShader.prototype.init=function(){var e=this.gl;var n=t.compileProgram(e,this.vertexSrc,this.fragmentSrc);e.useProgram(n);this.uSampler=e.getUniformLocation(n,"uSampler");this.projectionVector=e.getUniformLocation(n,"projectionVector");this.offsetVector=e.getUniformLocation(n,"offsetVector");this.colorAttribute=e.getAttribLocation(n,"aColor");this.aVertexPosition=e.getAttribLocation(n,"aVertexPosition");this.aTextureCoord=e.getAttribLocation(n,"aTextureCoord");this.attributes=[this.aVertexPosition,this.aTextureCoord];this.translationMatrix=e.getUniformLocation(n,"translationMatrix");this.alpha=e.getUniformLocation(n,"alpha");this.program=n};t.StripShader.prototype.destroy=function(){this.gl.deleteProgram(this.program);this.uniforms=null;this.gl=null;this.attribute=null};t.PrimitiveShader=function(e){this._UID=t._UID++;this.gl=e;this.program=null;this.fragmentSrc=["precision mediump float;","varying vec4 vColor;","void main(void) {","   gl_FragColor = vColor;","}"];this.vertexSrc=["attribute vec2 aVertexPosition;","attribute vec4 aColor;","uniform mat3 translationMatrix;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","uniform float alpha;","uniform vec3 tint;","varying vec4 vColor;","void main(void) {","   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);","   v -= offsetVector.xyx;","   gl_Position = vec4( v.x / projectionVector.x -1.0, v.y / -projectionVector.y + 1.0 , 0.0, 1.0);","   vColor = aColor * vec4(tint * alpha, alpha);","}"];this.init()};t.PrimitiveShader.prototype.init=function(){var e=this.gl;var n=t.compileProgram(e,this.vertexSrc,this.fragmentSrc);e.useProgram(n);this.projectionVector=e.getUniformLocation(n,"projectionVector");this.offsetVector=e.getUniformLocation(n,"offsetVector");this.tintColor=e.getUniformLocation(n,"tint");this.aVertexPosition=e.getAttribLocation(n,"aVertexPosition");this.colorAttribute=e.getAttribLocation(n,"aColor");this.attributes=[this.aVertexPosition,this.colorAttribute];this.translationMatrix=e.getUniformLocation(n,"translationMatrix");this.alpha=e.getUniformLocation(n,"alpha");this.program=n};t.PrimitiveShader.prototype.destroy=function(){this.gl.deleteProgram(this.program);this.uniforms=null;this.gl=null;this.attributes=null};t.ComplexPrimitiveShader=function(e){this._UID=t._UID++;this.gl=e;this.program=null;this.fragmentSrc=["precision mediump float;","varying vec4 vColor;","void main(void) {","   gl_FragColor = vColor;","}"];this.vertexSrc=["attribute vec2 aVertexPosition;","uniform mat3 translationMatrix;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","uniform vec3 tint;","uniform float alpha;","uniform vec3 color;","varying vec4 vColor;","void main(void) {","   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);","   v -= offsetVector.xyx;","   gl_Position = vec4( v.x / projectionVector.x -1.0, v.y / -projectionVector.y + 1.0 , 0.0, 1.0);","   vColor = vec4(color * alpha * tint, alpha);","}"];this.init()};t.ComplexPrimitiveShader.prototype.init=function(){var e=this.gl;var n=t.compileProgram(e,this.vertexSrc,this.fragmentSrc);e.useProgram(n);this.projectionVector=e.getUniformLocation(n,"projectionVector");this.offsetVector=e.getUniformLocation(n,"offsetVector");this.tintColor=e.getUniformLocation(n,"tint");this.color=e.getUniformLocation(n,"color");this.aVertexPosition=e.getAttribLocation(n,"aVertexPosition");this.attributes=[this.aVertexPosition,this.colorAttribute];this.translationMatrix=e.getUniformLocation(n,"translationMatrix");this.alpha=e.getUniformLocation(n,"alpha");this.program=n};t.ComplexPrimitiveShader.prototype.destroy=function(){this.gl.deleteProgram(this.program);this.uniforms=null;this.gl=null;this.attribute=null};t.WebGLGraphics=function(){};t.WebGLGraphics.renderGraphics=function(e,n){var r=n.gl;var i=n.projection,s=n.offset,o=n.shaderManager.primitiveShader,u;if(e.dirty){t.WebGLGraphics.updateGraphics(e,r)}var a=e._webGL[r.id];for(var f=0;f<a.data.length;f++){if(a.data[f].mode===1){u=a.data[f];n.stencilManager.pushStencil(e,u,n);r.drawElements(r.TRIANGLE_FAN,4,r.UNSIGNED_SHORT,(u.indices.length-4)*2);n.stencilManager.popStencil(e,u,n)}else{u=a.data[f];n.shaderManager.setShader(o);o=n.shaderManager.primitiveShader;r.uniformMatrix3fv(o.translationMatrix,false,e.worldTransform.toArray(true));r.uniform2f(o.projectionVector,i.x,-i.y);r.uniform2f(o.offsetVector,-s.x,-s.y);r.uniform3fv(o.tintColor,t.hex2rgb(e.tint));r.uniform1f(o.alpha,e.worldAlpha);r.bindBuffer(r.ARRAY_BUFFER,u.buffer);r.vertexAttribPointer(o.aVertexPosition,2,r.FLOAT,false,4*6,0);r.vertexAttribPointer(o.colorAttribute,4,r.FLOAT,false,4*6,2*4);r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,u.indexBuffer);r.drawElements(r.TRIANGLE_STRIP,u.indices.length,r.UNSIGNED_SHORT,0)}}};t.WebGLGraphics.updateGraphics=function(e,n){var r=e._webGL[n.id];if(!r)r=e._webGL[n.id]={lastIndex:0,data:[],gl:n};e.dirty=false;var i;if(e.clearDirty){e.clearDirty=false;for(i=0;i<r.data.length;i++){var s=r.data[i];s.reset();t.WebGLGraphics.graphicsDataPool.push(s)}r.data=[];r.lastIndex=0}var o;for(i=r.lastIndex;i<e.graphicsData.length;i++){var u=e.graphicsData[i];if(u.type===t.Graphics.POLY){if(u.fill){if(u.points.length>6){if(u.points.length>5*2){o=t.WebGLGraphics.switchMode(r,1);t.WebGLGraphics.buildComplexPoly(u,o)}else{o=t.WebGLGraphics.switchMode(r,0);t.WebGLGraphics.buildPoly(u,o)}}}if(u.lineWidth>0){o=t.WebGLGraphics.switchMode(r,0);t.WebGLGraphics.buildLine(u,o)}}else{o=t.WebGLGraphics.switchMode(r,0);if(u.type===t.Graphics.RECT){t.WebGLGraphics.buildRectangle(u,o)}else if(u.type===t.Graphics.CIRC||u.type===t.Graphics.ELIP){t.WebGLGraphics.buildCircle(u,o)}else if(u.type===t.Graphics.RREC){t.WebGLGraphics.buildRoundedRectangle(u,o)}}r.lastIndex++}for(i=0;i<r.data.length;i++){o=r.data[i];if(o.dirty)o.upload()}};t.WebGLGraphics.switchMode=function(e,n){var r;if(!e.data.length){r=t.WebGLGraphics.graphicsDataPool.pop()||new t.WebGLGraphicsData(e.gl);r.mode=n;e.data.push(r)}else{r=e.data[e.data.length-1];if(r.mode!==n||n===1){r=t.WebGLGraphics.graphicsDataPool.pop()||new t.WebGLGraphicsData(e.gl);r.mode=n;e.data.push(r)}}r.dirty=true;return r};t.WebGLGraphics.buildRectangle=function(e,n){var r=e.points;var i=r[0];var s=r[1];var o=r[2];var u=r[3];if(e.fill){var a=t.hex2rgb(e.fillColor);var f=e.fillAlpha;var l=a[0]*f;var c=a[1]*f;var h=a[2]*f;var p=n.points;var d=n.indices;var v=p.length/6;p.push(i,s);p.push(l,c,h,f);p.push(i+o,s);p.push(l,c,h,f);p.push(i,s+u);p.push(l,c,h,f);p.push(i+o,s+u);p.push(l,c,h,f);d.push(v,v,v+1,v+2,v+3,v+3)}if(e.lineWidth){var m=e.points;e.points=[i,s,i+o,s,i+o,s+u,i,s+u,i,s];t.WebGLGraphics.buildLine(e,n);e.points=m}};t.WebGLGraphics.buildRoundedRectangle=function(e,n){var r=e.points;var i=r[0];var s=r[1];var o=r[2];var u=r[3];var a=r[4];var f=[];f.push(i,s+a);f=f.concat(t.WebGLGraphics.quadraticBezierCurve(i,s+u-a,i,s+u,i+a,s+u));f=f.concat(t.WebGLGraphics.quadraticBezierCurve(i+o-a,s+u,i+o,s+u,i+o,s+u-a));f=f.concat(t.WebGLGraphics.quadraticBezierCurve(i+o,s+a,i+o,s,i+o-a,s));f=f.concat(t.WebGLGraphics.quadraticBezierCurve(i+a,s,i,s,i,s+a));if(e.fill){var l=t.hex2rgb(e.fillColor);var c=e.fillAlpha;var h=l[0]*c;var p=l[1]*c;var d=l[2]*c;var v=n.points;var m=n.indices;var g=v.length/6;var y=t.PolyK.Triangulate(f);var b=0;for(b=0;b<y.length;b+=3){m.push(y[b]+g);m.push(y[b]+g);m.push(y[b+1]+g);m.push(y[b+2]+g);m.push(y[b+2]+g)}for(b=0;b<f.length;b++){v.push(f[b],f[++b],h,p,d,c)}}if(e.lineWidth){var w=e.points;e.points=f;t.WebGLGraphics.buildLine(e,n);e.points=w}};t.WebGLGraphics.quadraticBezierCurve=function(e,t,n,r,i,s){function d(e,t,n){var r=t-e;return e+r*n}var o,u,a,f,l,c,h=20,p=[];var v=0;for(var m=0;m<=h;m++){v=m/h;o=d(e,n,v);u=d(t,r,v);a=d(n,i,v);f=d(r,s,v);l=d(o,a,v);c=d(u,f,v);p.push(l,c)}return p};t.WebGLGraphics.buildCircle=function(e,n){var r=e.points;var i=r[0];var s=r[1];var o=r[2];var u=r[3];var a=40;var f=Math.PI*2/a;var l=0;if(e.fill){var c=t.hex2rgb(e.fillColor);var h=e.fillAlpha;var p=c[0]*h;var d=c[1]*h;var v=c[2]*h;var m=n.points;var g=n.indices;var y=m.length/6;g.push(y);for(l=0;l<a+1;l++){m.push(i,s,p,d,v,h);m.push(i+Math.sin(f*l)*o,s+Math.cos(f*l)*u,p,d,v,h);g.push(y++,y++)}g.push(y-1)}if(e.lineWidth){var b=e.points;e.points=[];for(l=0;l<a+1;l++){e.points.push(i+Math.sin(f*l)*o,s+Math.cos(f*l)*u)}t.WebGLGraphics.buildLine(e,n);e.points=b}};t.WebGLGraphics.buildLine=function(e,n){var r=0;var i=e.points;if(i.length===0)return;if(e.lineWidth%2){for(r=0;r<i.length;r++){i[r]+=.5}}var s=new t.Point(i[0],i[1]);var o=new t.Point(i[i.length-2],i[i.length-1]);if(s.x===o.x&&s.y===o.y){i=i.slice();i.pop();i.pop();o=new t.Point(i[i.length-2],i[i.length-1]);var u=o.x+(s.x-o.x)*.5;var a=o.y+(s.y-o.y)*.5;i.unshift(u,a);i.push(u,a)}var f=n.points;var l=n.indices;var c=i.length/2;var h=i.length;var p=f.length/6;var d=e.lineWidth/2;var v=t.hex2rgb(e.lineColor);var m=e.lineAlpha;var g=v[0]*m;var y=v[1]*m;var b=v[2]*m;var w,E,S,x,T,N,C,k;var L,A,O,M,_,D;var P,H,B,j,F,I;var q,R,U;S=i[0];x=i[1];T=i[2];N=i[3];L=-(x-N);A=S-T;U=Math.sqrt(L*L+A*A);L/=U;A/=U;L*=d;A*=d;f.push(S-L,x-A,g,y,b,m);f.push(S+L,x+A,g,y,b,m);for(r=1;r<c-1;r++){S=i[(r-1)*2];x=i[(r-1)*2+1];T=i[r*2];N=i[r*2+1];C=i[(r+1)*2];k=i[(r+1)*2+1];L=-(x-N);A=S-T;U=Math.sqrt(L*L+A*A);L/=U;A/=U;L*=d;A*=d;O=-(N-k);M=T-C;U=Math.sqrt(O*O+M*M);O/=U;M/=U;O*=d;M*=d;P=-A+x-(-A+N);H=-L+T-(-L+S);B=(-L+S)*(-A+N)-(-L+T)*(-A+x);j=-M+k-(-M+N);F=-O+T-(-O+C);I=(-O+C)*(-M+N)-(-O+T)*(-M+k);q=P*F-j*H;if(Math.abs(q)<.1){q+=10.1;f.push(T-L,N-A,g,y,b,m);f.push(T+L,N+A,g,y,b,m);continue}w=(H*I-F*B)/q;E=(j*B-P*I)/q;R=(w-T)*(w-T)+(E-N)+(E-N);if(R>140*140){_=L-O;D=A-M;U=Math.sqrt(_*_+D*D);_/=U;D/=U;_*=d;D*=d;f.push(T-_,N-D);f.push(g,y,b,m);f.push(T+_,N+D);f.push(g,y,b,m);f.push(T-_,N-D);f.push(g,y,b,m);h++}else{f.push(w,E);f.push(g,y,b,m);f.push(T-(w-T),N-(E-N));f.push(g,y,b,m)}}S=i[(c-2)*2];x=i[(c-2)*2+1];T=i[(c-1)*2];N=i[(c-1)*2+1];L=-(x-N);A=S-T;U=Math.sqrt(L*L+A*A);L/=U;A/=U;L*=d;A*=d;f.push(T-L,N-A);f.push(g,y,b,m);f.push(T+L,N+A);f.push(g,y,b,m);l.push(p);for(r=0;r<h;r++){l.push(p++)}l.push(p-1)};t.WebGLGraphics.buildComplexPoly=function(e,n){var r=e.points.slice();if(r.length<6)return;var i=n.indices;n.points=r;n.alpha=e.fillAlpha;n.color=t.hex2rgb(e.fillColor);var s=Infinity;var o=-Infinity;var u=Infinity;var a=-Infinity;var f,l;for(var c=0;c<r.length;c+=2){f=r[c];l=r[c+1];s=f<s?f:s;o=f>o?f:o;u=l<u?l:u;a=l>a?l:a}r.push(s,u,o,u,o,a,s,a);var h=r.length/2;for(c=0;c<h;c++){i.push(c)}};t.WebGLGraphics.buildPoly=function(e,n){var r=e.points;if(r.length<6)return;var i=n.points;var s=n.indices;var o=r.length/2;var u=t.hex2rgb(e.fillColor);var a=e.fillAlpha;var f=u[0]*a;var l=u[1]*a;var c=u[2]*a;var h=t.PolyK.Triangulate(r);var p=i.length/6;var d=0;for(d=0;d<h.length;d+=3){s.push(h[d]+p);s.push(h[d]+p);s.push(h[d+1]+p);s.push(h[d+2]+p);s.push(h[d+2]+p)}for(d=0;d<o;d++){i.push(r[d*2],r[d*2+1],f,l,c,a)}};t.WebGLGraphics.graphicsDataPool=[];t.WebGLGraphicsData=function(e){this.gl=e;this.color=[0,0,0];this.points=[];this.indices=[];this.lastIndex=0;this.buffer=e.createBuffer();this.indexBuffer=e.createBuffer();this.mode=1;this.alpha=1;this.dirty=true};t.WebGLGraphicsData.prototype.reset=function(){this.points=[];this.indices=[];this.lastIndex=0};t.WebGLGraphicsData.prototype.upload=function(){var e=this.gl;this.glPoints=new Float32Array(this.points);e.bindBuffer(e.ARRAY_BUFFER,this.buffer);e.bufferData(e.ARRAY_BUFFER,this.glPoints,e.STATIC_DRAW);this.glIndicies=new Uint16Array(this.indices);e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer);e.bufferData(e.ELEMENT_ARRAY_BUFFER,this.glIndicies,e.STATIC_DRAW);this.dirty=false};t.glContexts=[];t.WebGLRenderer=function(e,n,r){if(r){for(var i in t.defaultRenderOptions){if(typeof r[i]=="undefined")r[i]=t.defaultRenderOptions[i]}}else{r=t.defaultRenderOptions}this.type=t.WEBGL_RENDERER;this.resolution=r.resolution;this.transparent=r.transparent;this.preserveDrawingBuffer=r.preserveDrawingBuffer;this.clearBeforeRender=r.clearBeforeRender;this.width=e||800;this.height=n||600;this.view=r.view||document.createElement("canvas");this.contextLost=this.handleContextLost.bind(this);this.contextRestoredLost=this.handleContextRestored.bind(this);this.view.addEventListener("webglcontextlost",this.contextLost,false);this.view.addEventListener("webglcontextrestored",this.contextRestoredLost,false);this.contextOptions={alpha:this.transparent,antialias:r.antialias,premultipliedAlpha:this.transparent&&this.transparent!=="notMultiplied",stencil:true,preserveDrawingBuffer:r.preserveDrawingBuffer};var s=null;["experimental-webgl","webgl"].forEach(function(e){try{s=s||this.view.getContext(e,this.contextOptions)}catch(t){}},this);if(!s){throw new Error("This browser does not support webGL. Try using the canvas renderer"+this)}this.gl=s;this.glContextId=s.id=t.WebGLRenderer.glContextId++;t.glContexts[this.glContextId]=s;if(!t.blendModesWebGL){t.blendModesWebGL=[];t.blendModesWebGL[t.blendModes.NORMAL]=[s.ONE,s.ONE_MINUS_SRC_ALPHA];t.blendModesWebGL[t.blendModes.ADD]=[s.SRC_ALPHA,s.DST_ALPHA];t.blendModesWebGL[t.blendModes.MULTIPLY]=[s.DST_COLOR,s.ONE_MINUS_SRC_ALPHA];t.blendModesWebGL[t.blendModes.SCREEN]=[s.SRC_ALPHA,s.ONE];t.blendModesWebGL[t.blendModes.OVERLAY]=[s.ONE,s.ONE_MINUS_SRC_ALPHA];t.blendModesWebGL[t.blendModes.DARKEN]=[s.ONE,s.ONE_MINUS_SRC_ALPHA];t.blendModesWebGL[t.blendModes.LIGHTEN]=[s.ONE,s.ONE_MINUS_SRC_ALPHA];t.blendModesWebGL[t.blendModes.COLOR_DODGE]=[s.ONE,s.ONE_MINUS_SRC_ALPHA];t.blendModesWebGL[t.blendModes.COLOR_BURN]=[s.ONE,s.ONE_MINUS_SRC_ALPHA];t.blendModesWebGL[t.blendModes.HARD_LIGHT]=[s.ONE,s.ONE_MINUS_SRC_ALPHA];t.blendModesWebGL[t.blendModes.SOFT_LIGHT]=[s.ONE,s.ONE_MINUS_SRC_ALPHA];t.blendModesWebGL[t.blendModes.DIFFERENCE]=[s.ONE,s.ONE_MINUS_SRC_ALPHA];t.blendModesWebGL[t.blendModes.EXCLUSION]=[s.ONE,s.ONE_MINUS_SRC_ALPHA];t.blendModesWebGL[t.blendModes.HUE]=[s.ONE,s.ONE_MINUS_SRC_ALPHA];t.blendModesWebGL[t.blendModes.SATURATION]=[s.ONE,s.ONE_MINUS_SRC_ALPHA];t.blendModesWebGL[t.blendModes.COLOR]=[s.ONE,s.ONE_MINUS_SRC_ALPHA];t.blendModesWebGL[t.blendModes.LUMINOSITY]=[s.ONE,s.ONE_MINUS_SRC_ALPHA]}this.projection=new t.Point;this.offset=new t.Point(0,0);this.resize(e,n);this.contextLost=false;this.shaderManager=new t.WebGLShaderManager(s);this.spriteBatch=new t.WebGLSpriteBatch(s);this.maskManager=new t.WebGLMaskManager(s);this.filterManager=new t.WebGLFilterManager(s,this.transparent);this.stencilManager=new t.WebGLStencilManager(s);this.blendModeManager=new t.WebGLBlendModeManager(s);this.renderSession={};this.renderSession.gl=this.gl;this.renderSession.drawCount=0;this.renderSession.shaderManager=this.shaderManager;this.renderSession.maskManager=this.maskManager;this.renderSession.filterManager=this.filterManager;this.renderSession.blendModeManager=this.blendModeManager;this.renderSession.spriteBatch=this.spriteBatch;this.renderSession.stencilManager=this.stencilManager;this.renderSession.renderer=this;this.renderSession.resolution=this.resolution;s.disable(s.DEPTH_TEST);s.disable(s.CULL_FACE);s.enable(s.BLEND);s.colorMask(true,true,true,this.transparent)};t.WebGLRenderer.prototype.constructor=t.WebGLRenderer;t.WebGLRenderer.prototype.render=function(e){if(this.contextLost)return;if(this.__stage!==e){if(e.interactive)e.interactionManager.removeEvents();this.__stage=e}t.WebGLRenderer.updateTextures();e.updateTransform();if(e._interactive){if(!e._interactiveEventsAdded){e._interactiveEventsAdded=true;e.interactionManager.setTarget(this)}}var n=this.gl;n.viewport(0,0,this.width,this.height);n.bindFramebuffer(n.FRAMEBUFFER,null);if(this.clearBeforeRender){if(this.transparent){n.clearColor(0,0,0,0)}else{n.clearColor(e.backgroundColorSplit[0],e.backgroundColorSplit[1],e.backgroundColorSplit[2],1)}n.clear(n.COLOR_BUFFER_BIT)}this.renderDisplayObject(e,this.projection);if(e.interactive){if(!e._interactiveEventsAdded){e._interactiveEventsAdded=true;e.interactionManager.setTarget(this)}}else{if(e._interactiveEventsAdded){e._interactiveEventsAdded=false;e.interactionManager.setTarget(this)}}};t.WebGLRenderer.prototype.renderDisplayObject=function(e,n,r){this.renderSession.blendModeManager.setBlendMode(t.blendModes.NORMAL);this.renderSession.drawCount=0;this.renderSession.currentBlendMode=9999;this.renderSession.projection=n;this.renderSession.offset=this.offset;this.spriteBatch.begin(this.renderSession);this.filterManager.begin(this.renderSession,r);e._renderWebGL(this.renderSession);this.spriteBatch.end()};t.WebGLRenderer.updateTextures=function(){var e=0;for(e=0;e<t.Texture.frameUpdates.length;e++)t.WebGLRenderer.updateTextureFrame(t.Texture.frameUpdates[e]);for(e=0;e<t.texturesToDestroy.length;e++)t.WebGLRenderer.destroyTexture(t.texturesToDestroy[e]);t.texturesToUpdate.length=0;t.texturesToDestroy.length=0;t.Texture.frameUpdates.length=0};t.WebGLRenderer.destroyTexture=function(e){for(var n=e._glTextures.length-1;n>=0;n--){var r=e._glTextures[n];var i=t.glContexts[n];if(i&&r){i.deleteTexture(r)}}e._glTextures.length=0};t.WebGLRenderer.updateTextureFrame=function(e){e._updateWebGLuvs()};t.WebGLRenderer.prototype.resize=function(e,t){this.width=e*this.resolution;this.height=t*this.resolution;this.view.width=this.width;this.view.height=this.height;this.gl.viewport(0,0,this.width,this.height);this.projection.x=this.width/2/this.resolution;this.projection.y=-this.height/2/this.resolution};t.createWebGLTexture=function(e,n){if(e.hasLoaded){e._glTextures[n.id]=n.createTexture();n.bindTexture(n.TEXTURE_2D,e._glTextures[n.id]);n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.premultipliedAlpha);n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,e.source);n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,e.scaleMode===t.scaleModes.LINEAR?n.LINEAR:n.NEAREST);n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,e.scaleMode===t.scaleModes.LINEAR?n.LINEAR:n.NEAREST);if(!e._powerOf2){n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE);n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE)}else{n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.REPEAT);n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.REPEAT)}n.bindTexture(n.TEXTURE_2D,null);e._dirty[n.id]=false}return e._glTextures[n.id]};t.updateWebGLTexture=function(e,n){if(e._glTextures[n.id]){n.bindTexture(n.TEXTURE_2D,e._glTextures[n.id]);n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.premultipliedAlpha);n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,e.source);n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,e.scaleMode===t.scaleModes.LINEAR?n.LINEAR:n.NEAREST);n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,e.scaleMode===t.scaleModes.LINEAR?n.LINEAR:n.NEAREST);if(!e._powerOf2){n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE);n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE)}else{n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.REPEAT);n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.REPEAT)}e._dirty[n.id]=false}};t.WebGLRenderer.prototype.handleContextLost=function(e){e.preventDefault();this.contextLost=true};t.WebGLRenderer.prototype.handleContextRestored=function(){try{this.gl=this.view.getContext("experimental-webgl",this.contextOptions)}catch(e){try{this.gl=this.view.getContext("webgl",this.contextOptions)}catch(n){throw new Error(" This browser does not support webGL. Try using the canvas renderer"+this)}}t.glContexts[this.glContextId]=null;var r=this.gl;this.glContextId=r.id=t.WebGLRenderer.glContextId++;t.glContexts[this.glContextId]=r;this.shaderManager.setContext(r);this.spriteBatch.setContext(r);this.maskManager.setContext(r);this.filterManager.setContext(r);this.renderSession.gl=this.gl;r.disable(r.DEPTH_TEST);r.disable(r.CULL_FACE);r.enable(r.BLEND);r.colorMask(true,true,true,this.transparent);this.gl.viewport(0,0,this.width,this.height);for(var i in t.TextureCache){var s=t.TextureCache[i].baseTexture;s._glTextures=[]}if(typeof this.contextLost=="object")this.view.removeEventListener("webglcontextlost",this.contextLost);this.contextLost=false};t.WebGLRenderer.prototype.destroy=function(){if(typeof this.contextLost=="object")this.view.removeEventListener("webglcontextlost",this.contextLost);this.view.removeEventListener("webglcontextrestored",this.contextRestoredLost);t.glContexts[this.glContextId]=null;this.projection=null;this.offset=null;this.shaderManager.destroy();this.spriteBatch.destroy();this.maskManager.destroy();this.filterManager.destroy();this.shaderManager=null;this.spriteBatch=null;this.maskManager=null;this.filterManager=null;this.gl=null;this.renderSession=null;this.view=null;this.__stage=null;this.contextRestoredLost=null;this.stencilManager=null;this.blendModeManager=null;this.contextOptions=null};t.WebGLRenderer.glContextId=0;t.WebGLBlendModeManager=function(e){this.gl=e;this.currentBlendMode=99999};t.WebGLBlendModeManager.prototype.setBlendMode=function(e){if(this.currentBlendMode===e)return false;this.currentBlendMode=e;var n=t.blendModesWebGL[this.currentBlendMode];this.gl.blendFunc(n[0],n[1]);return true};t.WebGLBlendModeManager.prototype.destroy=function(){this.gl=null};t.WebGLMaskManager=function(e){this.setContext(e)};t.WebGLMaskManager.prototype.setContext=function(e){this.gl=e};t.WebGLMaskManager.prototype.pushMask=function(e,n){var r=n.gl;if(e.dirty){t.WebGLGraphics.updateGraphics(e,r)}if(!e._webGL[r.id].data.length)return;n.stencilManager.pushStencil(e,e._webGL[r.id].data[0],n)};t.WebGLMaskManager.prototype.popMask=function(e,t){var n=this.gl;t.stencilManager.popStencil(e,e._webGL[n.id].data[0],t)};t.WebGLMaskManager.prototype.destroy=function(){this.gl=null};t.WebGLStencilManager=function(e){this.stencilStack=[];this.setContext(e);this.reverse=true;this.count=0};t.WebGLStencilManager.prototype.setContext=function(e){this.gl=e};t.WebGLStencilManager.prototype.pushStencil=function(e,t,n){var r=this.gl;this.bindGraphics(e,t,n);if(this.stencilStack.length===0){r.enable(r.STENCIL_TEST);r.clear(r.STENCIL_BUFFER_BIT);this.reverse=true;this.count=0}this.stencilStack.push(t);var i=this.count;r.colorMask(false,false,false,false);r.stencilFunc(r.ALWAYS,0,255);r.stencilOp(r.KEEP,r.KEEP,r.INVERT);if(t.mode===1){r.drawElements(r.TRIANGLE_FAN,t.indices.length-4,r.UNSIGNED_SHORT,0);if(this.reverse){r.stencilFunc(r.EQUAL,255-i,255);r.stencilOp(r.KEEP,r.KEEP,r.DECR)}else{r.stencilFunc(r.EQUAL,i,255);r.stencilOp(r.KEEP,r.KEEP,r.INCR)}r.drawElements(r.TRIANGLE_FAN,4,r.UNSIGNED_SHORT,(t.indices.length-4)*2);if(this.reverse){r.stencilFunc(r.EQUAL,255-(i+1),255)}else{r.stencilFunc(r.EQUAL,i+1,255)}this.reverse=!this.reverse}else{if(!this.reverse){r.stencilFunc(r.EQUAL,255-i,255);r.stencilOp(r.KEEP,r.KEEP,r.DECR)}else{r.stencilFunc(r.EQUAL,i,255);r.stencilOp(r.KEEP,r.KEEP,r.INCR)}r.drawElements(r.TRIANGLE_STRIP,t.indices.length,r.UNSIGNED_SHORT,0);if(!this.reverse){r.stencilFunc(r.EQUAL,255-(i+1),255)}else{r.stencilFunc(r.EQUAL,i+1,255)}}r.colorMask(true,true,true,true);r.stencilOp(r.KEEP,r.KEEP,r.KEEP);this.count++};t.WebGLStencilManager.prototype.bindGraphics=function(e,n,r){this._currentGraphics=e;var i=this.gl;var s=r.projection,o=r.offset,u;if(n.mode===1){u=r.shaderManager.complexPrimitiveShader;r.shaderManager.setShader(u);i.uniformMatrix3fv(u.translationMatrix,false,e.worldTransform.toArray(true));i.uniform2f(u.projectionVector,s.x,-s.y);i.uniform2f(u.offsetVector,-o.x,-o.y);i.uniform3fv(u.tintColor,t.hex2rgb(e.tint));i.uniform3fv(u.color,n.color);i.uniform1f(u.alpha,e.worldAlpha*n.alpha);i.bindBuffer(i.ARRAY_BUFFER,n.buffer);i.vertexAttribPointer(u.aVertexPosition,2,i.FLOAT,false,4*2,0);i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,n.indexBuffer)}else{u=r.shaderManager.primitiveShader;r.shaderManager.setShader(u);i.uniformMatrix3fv(u.translationMatrix,false,e.worldTransform.toArray(true));i.uniform2f(u.projectionVector,s.x,-s.y);i.uniform2f(u.offsetVector,-o.x,-o.y);i.uniform3fv(u.tintColor,t.hex2rgb(e.tint));i.uniform1f(u.alpha,e.worldAlpha);i.bindBuffer(i.ARRAY_BUFFER,n.buffer);i.vertexAttribPointer(u.aVertexPosition,2,i.FLOAT,false,4*6,0);i.vertexAttribPointer(u.colorAttribute,4,i.FLOAT,false,4*6,2*4);i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,n.indexBuffer)}};t.WebGLStencilManager.prototype.popStencil=function(e,t,n){var r=this.gl;this.stencilStack.pop();this.count--;if(this.stencilStack.length===0){r.disable(r.STENCIL_TEST)}else{var i=this.count;this.bindGraphics(e,t,n);r.colorMask(false,false,false,false);if(t.mode===1){this.reverse=!this.reverse;if(this.reverse){r.stencilFunc(r.EQUAL,255-(i+1),255);r.stencilOp(r.KEEP,r.KEEP,r.INCR)}else{r.stencilFunc(r.EQUAL,i+1,255);r.stencilOp(r.KEEP,r.KEEP,r.DECR)}r.drawElements(r.TRIANGLE_FAN,4,r.UNSIGNED_SHORT,(t.indices.length-4)*2);r.stencilFunc(r.ALWAYS,0,255);r.stencilOp(r.KEEP,r.KEEP,r.INVERT);r.drawElements(r.TRIANGLE_FAN,t.indices.length-4,r.UNSIGNED_SHORT,0);if(!this.reverse){r.stencilFunc(r.EQUAL,255-i,255)}else{r.stencilFunc(r.EQUAL,i,255)}}else{if(!this.reverse){r.stencilFunc(r.EQUAL,255-(i+1),255);r.stencilOp(r.KEEP,r.KEEP,r.INCR)}else{r.stencilFunc(r.EQUAL,i+1,255);r.stencilOp(r.KEEP,r.KEEP,r.DECR)}r.drawElements(r.TRIANGLE_STRIP,t.indices.length,r.UNSIGNED_SHORT,0);if(!this.reverse){r.stencilFunc(r.EQUAL,255-i,255)}else{r.stencilFunc(r.EQUAL,i,255)}}r.colorMask(true,true,true,true);r.stencilOp(r.KEEP,r.KEEP,r.KEEP)}};t.WebGLStencilManager.prototype.destroy=function(){this.stencilStack=null;this.gl=null};t.WebGLShaderManager=function(e){this.maxAttibs=10;this.attribState=[];this.tempAttribState=[];for(var t=0;t<this.maxAttibs;t++){this.attribState[t]=false}this.setContext(e)};t.WebGLShaderManager.prototype.setContext=function(e){this.gl=e;this.primitiveShader=new t.PrimitiveShader(e);this.complexPrimitiveShader=new t.ComplexPrimitiveShader(e);this.defaultShader=new t.PixiShader(e);this.fastShader=new t.PixiFastShader(e);this.stripShader=new t.StripShader(e);this.setShader(this.defaultShader)};t.WebGLShaderManager.prototype.setAttribs=function(e){var t;for(t=0;t<this.tempAttribState.length;t++){this.tempAttribState[t]=false}for(t=0;t<e.length;t++){var n=e[t];this.tempAttribState[n]=true}var r=this.gl;for(t=0;t<this.attribState.length;t++){if(this.attribState[t]!==this.tempAttribState[t]){this.attribState[t]=this.tempAttribState[t];if(this.tempAttribState[t]){r.enableVertexAttribArray(t)}else{r.disableVertexAttribArray(t)}}}};t.WebGLShaderManager.prototype.setShader=function(e){if(this._currentId===e._UID)return false;this._currentId=e._UID;this.currentShader=e;this.gl.useProgram(e.program);this.setAttribs(e.attributes);return true};t.WebGLShaderManager.prototype.destroy=function(){this.attribState=null;this.tempAttribState=null;this.primitiveShader.destroy();this.complexPrimitiveShader.destroy();this.defaultShader.destroy();this.fastShader.destroy();this.stripShader.destroy();this.gl=null};t.WebGLSpriteBatch=function(e){this.vertSize=6;this.size=2e3;var t=this.size*4*this.vertSize;var n=this.size*6;this.vertices=new Float32Array(t);this.indices=new Uint16Array(n);this.lastIndexCount=0;for(var r=0,i=0;r<n;r+=6,i+=4){this.indices[r+0]=i+0;this.indices[r+1]=i+1;this.indices[r+2]=i+2;this.indices[r+3]=i+0;this.indices[r+4]=i+2;this.indices[r+5]=i+3}this.drawing=false;this.currentBatchSize=0;this.currentBaseTexture=null;this.setContext(e);this.dirty=true;this.textures=[];this.blendModes=[]};t.WebGLSpriteBatch.prototype.setContext=function(e){this.gl=e;this.vertexBuffer=e.createBuffer();this.indexBuffer=e.createBuffer();e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer);e.bufferData(e.ELEMENT_ARRAY_BUFFER,this.indices,e.STATIC_DRAW);e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer);e.bufferData(e.ARRAY_BUFFER,this.vertices,e.DYNAMIC_DRAW);this.currentBlendMode=99999};t.WebGLSpriteBatch.prototype.begin=function(e){this.renderSession=e;this.shader=this.renderSession.shaderManager.defaultShader;this.start()};t.WebGLSpriteBatch.prototype.end=function(){this.flush()};t.WebGLSpriteBatch.prototype.render=function(e){var t=e.texture;if(this.currentBatchSize>=this.size){this.flush();this.currentBaseTexture=t.baseTexture}var n=t._uvs;if(!n)return;var r=e.worldAlpha;var i=e.tint;var s=this.vertices;var o=e.anchor.x;var u=e.anchor.y;var a,f,l,c;if(t.trim){var h=t.trim;f=h.x-o*h.width;a=f+t.crop.width;c=h.y-u*h.height;l=c+t.crop.height}else{a=t.frame.width*(1-o);f=t.frame.width*-o;l=t.frame.height*(1-u);c=t.frame.height*-u}var p=this.currentBatchSize*4*this.vertSize;var d=t.baseTexture.resolution;var v=e.worldTransform;var m=v.a/d;var g=v.c/d;var y=v.b/d;var b=v.d/d;var w=v.tx;var E=v.ty;s[p++]=m*f+y*c+w;s[p++]=b*c+g*f+E;s[p++]=n.x0;s[p++]=n.y0;s[p++]=r;s[p++]=i;s[p++]=m*a+y*c+w;s[p++]=b*c+g*a+E;s[p++]=n.x1;s[p++]=n.y1;s[p++]=r;s[p++]=i;s[p++]=m*a+y*l+w;s[p++]=b*l+g*a+E;s[p++]=n.x2;s[p++]=n.y2;s[p++]=r;s[p++]=i;s[p++]=m*f+y*l+w;s[p++]=b*l+g*f+E;s[p++]=n.x3;s[p++]=n.y3;s[p++]=r;s[p++]=i;this.textures[this.currentBatchSize]=e.texture.baseTexture;this.blendModes[this.currentBatchSize]=e.blendMode;this.currentBatchSize++};t.WebGLSpriteBatch.prototype.renderTilingSprite=function(e){var n=e.tilingTexture;if(this.currentBatchSize>=this.size){this.flush();this.currentBaseTexture=n.baseTexture}if(!e._uvs)e._uvs=new t.TextureUvs;var r=e._uvs;e.tilePosition.x%=n.baseTexture.width*e.tileScaleOffset.x;e.tilePosition.y%=n.baseTexture.height*e.tileScaleOffset.y;var i=e.tilePosition.x/(n.baseTexture.width*e.tileScaleOffset.x);var s=e.tilePosition.y/(n.baseTexture.height*e.tileScaleOffset.y);var o=e.width/n.baseTexture.width/(e.tileScale.x*e.tileScaleOffset.x);var u=e.height/n.baseTexture.height/(e.tileScale.y*e.tileScaleOffset.y);r.x0=0-i;r.y0=0-s;r.x1=1*o-i;r.y1=0-s;r.x2=1*o-i;r.y2=1*u-s;r.x3=0-i;r.y3=1*u-s;var a=e.worldAlpha;var f=e.tint;var l=this.vertices;var c=e.width;var h=e.height;var p=e.anchor.x;var d=e.anchor.y;var v=c*(1-p);var m=c*-p;var g=h*(1-d);var y=h*-d;var b=this.currentBatchSize*4*this.vertSize;var w=n.baseTexture.resolution;var E=e.worldTransform;var S=E.a/w;var x=E.c/w;var T=E.b/w;var N=E.d/w;var C=E.tx;var k=E.ty;l[b++]=S*m+T*y+C;l[b++]=N*y+x*m+k;l[b++]=r.x0;l[b++]=r.y0;l[b++]=a;l[b++]=f;l[b++]=S*v+T*y+C;l[b++]=N*y+x*v+k;l[b++]=r.x1;l[b++]=r.y1;l[b++]=a;l[b++]=f;l[b++]=S*v+T*g+C;l[b++]=N*g+x*v+k;l[b++]=r.x2;l[b++]=r.y2;l[b++]=a;l[b++]=f;l[b++]=S*m+T*g+C;l[b++]=N*g+x*m+k;l[b++]=r.x3;l[b++]=r.y3;l[b++]=a;l[b++]=f;this.textures[this.currentBatchSize]=n.baseTexture;this.blendModes[this.currentBatchSize]=e.blendMode;this.currentBatchSize++};t.WebGLSpriteBatch.prototype.flush=function(){if(this.currentBatchSize===0)return;var e=this.gl;this.renderSession.shaderManager.setShader(this.renderSession.shaderManager.defaultShader);if(this.dirty){this.dirty=false;e.activeTexture(e.TEXTURE0);e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer);e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer);var t=this.renderSession.projection;e.uniform2f(this.shader.projectionVector,t.x,t.y);var n=this.vertSize*4;e.vertexAttribPointer(this.shader.aVertexPosition,2,e.FLOAT,false,n,0);e.vertexAttribPointer(this.shader.aTextureCoord,2,e.FLOAT,false,n,2*4);e.vertexAttribPointer(this.shader.colorAttribute,2,e.FLOAT,false,n,4*4)}if(this.currentBatchSize>this.size*.5){e.bufferSubData(e.ARRAY_BUFFER,0,this.vertices)}else{var r=this.vertices.subarray(0,this.currentBatchSize*4*this.vertSize);e.bufferSubData(e.ARRAY_BUFFER,0,r)}var i,s;var o=0;var u=0;var a=null;var f=this.renderSession.blendModeManager.currentBlendMode;for(var l=0,c=this.currentBatchSize;l<c;l++){i=this.textures[l];s=this.blendModes[l];if(a!==i||f!==s){this.renderBatch(a,o,u);u=l;o=0;a=i;f=s;this.renderSession.blendModeManager.setBlendMode(f)}o++}this.renderBatch(a,o,u);this.currentBatchSize=0};t.WebGLSpriteBatch.prototype.renderBatch=function(e,n,r){if(n===0)return;var i=this.gl;i.bindTexture(i.TEXTURE_2D,e._glTextures[i.id]||t.createWebGLTexture(e,i));if(e._dirty[i.id]){t.updateWebGLTexture(this.currentBaseTexture,i)}i.drawElements(i.TRIANGLES,n*6,i.UNSIGNED_SHORT,r*6*2);this.renderSession.drawCount++};t.WebGLSpriteBatch.prototype.stop=function(){this.flush()};t.WebGLSpriteBatch.prototype.start=function(){this.dirty=true};t.WebGLSpriteBatch.prototype.destroy=function(){this.vertices=null;this.indices=null;this.gl.deleteBuffer(this.vertexBuffer);this.gl.deleteBuffer(this.indexBuffer);this.currentBaseTexture=null;this.gl=null};t.WebGLFastSpriteBatch=function(e){this.vertSize=10;this.maxSize=6e3;this.size=this.maxSize;var t=this.size*4*this.vertSize;var n=this.maxSize*6;this.vertices=new Float32Array(t);this.indices=new Uint16Array(n);this.vertexBuffer=null;this.indexBuffer=null;this.lastIndexCount=0;for(var r=0,i=0;r<n;r+=6,i+=4){this.indices[r+0]=i+0;this.indices[r+1]=i+1;this.indices[r+2]=i+2;this.indices[r+3]=i+0;this.indices[r+4]=i+2;this.indices[r+5]=i+3}this.drawing=false;this.currentBatchSize=0;this.currentBaseTexture=null;this.currentBlendMode=0;this.renderSession=null;this.shader=null;this.matrix=null;this.setContext(e)};t.WebGLFastSpriteBatch.prototype.setContext=function(e){this.gl=e;this.vertexBuffer=e.createBuffer();this.indexBuffer=e.createBuffer();e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer);e.bufferData(e.ELEMENT_ARRAY_BUFFER,this.indices,e.STATIC_DRAW);e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer);e.bufferData(e.ARRAY_BUFFER,this.vertices,e.DYNAMIC_DRAW)};t.WebGLFastSpriteBatch.prototype.begin=function(e,t){this.renderSession=t;this.shader=this.renderSession.shaderManager.fastShader;this.matrix=e.worldTransform.toArray(true);this.start()};t.WebGLFastSpriteBatch.prototype.end=function(){this.flush()};t.WebGLFastSpriteBatch.prototype.render=function(e){var t=e.children;var n=t[0];if(!n.texture._uvs)return;this.currentBaseTexture=n.texture.baseTexture;if(n.blendMode!==this.renderSession.blendModeManager.currentBlendMode){this.flush();this.renderSession.blendModeManager.setBlendMode(n.blendMode)}for(var r=0,i=t.length;r<i;r++){this.renderSprite(t[r])}this.flush()};t.WebGLFastSpriteBatch.prototype.renderSprite=function(e){if(!e.visible)return;if(e.texture.baseTexture!==this.currentBaseTexture){this.flush();this.currentBaseTexture=e.texture.baseTexture;if(!e.texture._uvs)return}var t,n=this.vertices,r,i,s,o,u,a,f;t=e.texture._uvs;r=e.texture.frame.width;i=e.texture.frame.height;if(e.texture.trim){var l=e.texture.trim;o=l.x-e.anchor.x*l.width;s=o+e.texture.crop.width;a=l.y-e.anchor.y*l.height;u=a+e.texture.crop.height}else{s=e.texture.frame.width*(1-e.anchor.x);o=e.texture.frame.width*-e.anchor.x;u=e.texture.frame.height*(1-e.anchor.y);a=e.texture.frame.height*-e.anchor.y}f=this.currentBatchSize*4*this.vertSize;n[f++]=o;n[f++]=a;n[f++]=e.position.x;n[f++]=e.position.y;n[f++]=e.scale.x;n[f++]=e.scale.y;n[f++]=e.rotation;n[f++]=t.x0;n[f++]=t.y1;n[f++]=e.alpha;n[f++]=s;n[f++]=a;n[f++]=e.position.x;n[f++]=e.position.y;n[f++]=e.scale.x;n[f++]=e.scale.y;n[f++]=e.rotation;n[f++]=t.x1;n[f++]=t.y1;n[f++]=e.alpha;n[f++]=s;n[f++]=u;n[f++]=e.position.x;n[f++]=e.position.y;n[f++]=e.scale.x;n[f++]=e.scale.y;n[f++]=e.rotation;n[f++]=t.x2;n[f++]=t.y2;n[f++]=e.alpha;n[f++]=o;n[f++]=u;n[f++]=e.position.x;n[f++]=e.position.y;n[f++]=e.scale.x;n[f++]=e.scale.y;n[f++]=e.rotation;n[f++]=t.x3;n[f++]=t.y3;n[f++]=e.alpha;this.currentBatchSize++;if(this.currentBatchSize>=this.size){this.flush()}};t.WebGLFastSpriteBatch.prototype.flush=function(){if(this.currentBatchSize===0)return;var e=this.gl;if(!this.currentBaseTexture._glTextures[e.id])t.createWebGLTexture(this.currentBaseTexture,e);e.bindTexture(e.TEXTURE_2D,this.currentBaseTexture._glTextures[e.id]);if(this.currentBatchSize>this.size*.5){e.bufferSubData(e.ARRAY_BUFFER,0,this.vertices)}else{var n=this.vertices.subarray(0,this.currentBatchSize*4*this.vertSize);e.bufferSubData(e.ARRAY_BUFFER,0,n)}e.drawElements(e.TRIANGLES,this.currentBatchSize*6,e.UNSIGNED_SHORT,0);this.currentBatchSize=0;this.renderSession.drawCount++};t.WebGLFastSpriteBatch.prototype.stop=function(){this.flush()};t.WebGLFastSpriteBatch.prototype.start=function(){var e=this.gl;e.activeTexture(e.TEXTURE0);e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer);e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer);var t=this.renderSession.projection;e.uniform2f(this.shader.projectionVector,t.x,t.y);e.uniformMatrix3fv(this.shader.uMatrix,false,this.matrix);var n=this.vertSize*4;e.vertexAttribPointer(this.shader.aVertexPosition,2,e.FLOAT,false,n,0);e.vertexAttribPointer(this.shader.aPositionCoord,2,e.FLOAT,false,n,2*4);e.vertexAttribPointer(this.shader.aScale,2,e.FLOAT,false,n,4*4);e.vertexAttribPointer(this.shader.aRotation,1,e.FLOAT,false,n,6*4);e.vertexAttribPointer(this.shader.aTextureCoord,2,e.FLOAT,false,n,7*4);e.vertexAttribPointer(this.shader.colorAttribute,1,e.FLOAT,false,n,9*4)};t.WebGLFilterManager=function(e,t){this.transparent=t;this.filterStack=[];this.offsetX=0;this.offsetY=0;this.setContext(e)};t.WebGLFilterManager.prototype.setContext=function(e){this.gl=e;this.texturePool=[];this.initShaderBuffers()};t.WebGLFilterManager.prototype.begin=function(e,t){this.renderSession=e;this.defaultShader=e.shaderManager.defaultShader;var n=this.renderSession.projection;this.width=n.x*2;this.height=-n.y*2;this.buffer=t};t.WebGLFilterManager.prototype.pushFilter=function(e){var n=this.gl;var r=this.renderSession.projection;var i=this.renderSession.offset;e._filterArea=e.target.filterArea||e.target.getBounds();this.filterStack.push(e);var s=e.filterPasses[0];this.offsetX+=e._filterArea.x;this.offsetY+=e._filterArea.y;var o=this.texturePool.pop();if(!o){o=new t.FilterTexture(this.gl,this.width,this.height)}else{o.resize(this.width,this.height)}n.bindTexture(n.TEXTURE_2D,o.texture);var u=e._filterArea;var a=s.padding;u.x-=a;u.y-=a;u.width+=a*2;u.height+=a*2;if(u.x<0)u.x=0;if(u.width>this.width)u.width=this.width;if(u.y<0)u.y=0;if(u.height>this.height)u.height=this.height;n.bindFramebuffer(n.FRAMEBUFFER,o.frameBuffer);n.viewport(0,0,u.width,u.height);r.x=u.width/2;r.y=-u.height/2;i.x=-u.x;i.y=-u.y;this.renderSession.shaderManager.setShader(this.defaultShader);n.uniform2f(this.defaultShader.projectionVector,u.width/2,-u.height/2);n.uniform2f(this.defaultShader.offsetVector,-u.x,-u.y);n.colorMask(true,true,true,true);n.clearColor(0,0,0,0);n.clear(n.COLOR_BUFFER_BIT);e._glFilterTexture=o};t.WebGLFilterManager.prototype.popFilter=function(){var e=this.gl;var n=this.filterStack.pop();var r=n._filterArea;var i=n._glFilterTexture;var s=this.renderSession.projection;var o=this.renderSession.offset;if(n.filterPasses.length>1){e.viewport(0,0,r.width,r.height);e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer);this.vertexArray[0]=0;this.vertexArray[1]=r.height;this.vertexArray[2]=r.width;this.vertexArray[3]=r.height;this.vertexArray[4]=0;this.vertexArray[5]=0;this.vertexArray[6]=r.width;this.vertexArray[7]=0;e.bufferSubData(e.ARRAY_BUFFER,0,this.vertexArray);e.bindBuffer(e.ARRAY_BUFFER,this.uvBuffer);this.uvArray[2]=r.width/this.width;this.uvArray[5]=r.height/this.height;this.uvArray[6]=r.width/this.width;this.uvArray[7]=r.height/this.height;e.bufferSubData(e.ARRAY_BUFFER,0,this.uvArray);var u=i;var a=this.texturePool.pop();if(!a)a=new t.FilterTexture(this.gl,this.width,this.height);a.resize(this.width,this.height);e.bindFramebuffer(e.FRAMEBUFFER,a.frameBuffer);e.clear(e.COLOR_BUFFER_BIT);e.disable(e.BLEND);for(var f=0;f<n.filterPasses.length-1;f++){var l=n.filterPasses[f];e.bindFramebuffer(e.FRAMEBUFFER,a.frameBuffer);e.activeTexture(e.TEXTURE0);e.bindTexture(e.TEXTURE_2D,u.texture);this.applyFilterPass(l,r,r.width,r.height);var c=u;u=a;a=c}e.enable(e.BLEND);i=u;this.texturePool.push(a)}var h=n.filterPasses[n.filterPasses.length-1];this.offsetX-=r.x;this.offsetY-=r.y;var p=this.width;var d=this.height;var v=0;var m=0;var g=this.buffer;if(this.filterStack.length===0){e.colorMask(true,true,true,true)}else{var y=this.filterStack[this.filterStack.length-1];r=y._filterArea;p=r.width;d=r.height;v=r.x;m=r.y;g=y._glFilterTexture.frameBuffer}s.x=p/2;s.y=-d/2;o.x=v;o.y=m;r=n._filterArea;var b=r.x-v;var w=r.y-m;e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer);this.vertexArray[0]=b;this.vertexArray[1]=w+r.height;this.vertexArray[2]=b+r.width;this.vertexArray[3]=w+r.height;this.vertexArray[4]=b;this.vertexArray[5]=w;this.vertexArray[6]=b+r.width;this.vertexArray[7]=w;e.bufferSubData(e.ARRAY_BUFFER,0,this.vertexArray);e.bindBuffer(e.ARRAY_BUFFER,this.uvBuffer);this.uvArray[2]=r.width/this.width;this.uvArray[5]=r.height/this.height;this.uvArray[6]=r.width/this.width;this.uvArray[7]=r.height/this.height;e.bufferSubData(e.ARRAY_BUFFER,0,this.uvArray);e.viewport(0,0,p,d);e.bindFramebuffer(e.FRAMEBUFFER,g);e.activeTexture(e.TEXTURE0);e.bindTexture(e.TEXTURE_2D,i.texture);this.applyFilterPass(h,r,p,d);this.renderSession.shaderManager.setShader(this.defaultShader);e.uniform2f(this.defaultShader.projectionVector,p/2,-d/2);e.uniform2f(this.defaultShader.offsetVector,-v,-m);this.texturePool.push(i);n._glFilterTexture=null};t.WebGLFilterManager.prototype.applyFilterPass=function(e,n,r,i){var s=this.gl;var o=e.shaders[s.id];if(!o){o=new t.PixiShader(s);o.fragmentSrc=e.fragmentSrc;o.uniforms=e.uniforms;o.init();e.shaders[s.id]=o}this.renderSession.shaderManager.setShader(o);s.uniform2f(o.projectionVector,r/2,-i/2);s.uniform2f(o.offsetVector,0,0);if(e.uniforms.dimensions){e.uniforms.dimensions.value[0]=this.width;e.uniforms.dimensions.value[1]=this.height;e.uniforms.dimensions.value[2]=this.vertexArray[0];e.uniforms.dimensions.value[3]=this.vertexArray[5]}o.syncUniforms();s.bindBuffer(s.ARRAY_BUFFER,this.vertexBuffer);s.vertexAttribPointer(o.aVertexPosition,2,s.FLOAT,false,0,0);s.bindBuffer(s.ARRAY_BUFFER,this.uvBuffer);s.vertexAttribPointer(o.aTextureCoord,2,s.FLOAT,false,0,0);s.bindBuffer(s.ARRAY_BUFFER,this.colorBuffer);s.vertexAttribPointer(o.colorAttribute,2,s.FLOAT,false,0,0);s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,this.indexBuffer);s.drawElements(s.TRIANGLES,6,s.UNSIGNED_SHORT,0);this.renderSession.drawCount++};t.WebGLFilterManager.prototype.initShaderBuffers=function(){var e=this.gl;this.vertexBuffer=e.createBuffer();this.uvBuffer=e.createBuffer();this.colorBuffer=e.createBuffer();this.indexBuffer=e.createBuffer();this.vertexArray=new Float32Array([0,0,1,0,0,1,1,1]);e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer);e.bufferData(e.ARRAY_BUFFER,this.vertexArray,e.STATIC_DRAW);this.uvArray=new Float32Array([0,0,1,0,0,1,1,1]);e.bindBuffer(e.ARRAY_BUFFER,this.uvBuffer);e.bufferData(e.ARRAY_BUFFER,this.uvArray,e.STATIC_DRAW);this.colorArray=new Float32Array([1,16777215,1,16777215,1,16777215,1,16777215]);e.bindBuffer(e.ARRAY_BUFFER,this.colorBuffer);e.bufferData(e.ARRAY_BUFFER,this.colorArray,e.STATIC_DRAW);e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer);e.bufferData(e.ELEMENT_ARRAY_BUFFER,new Uint16Array([0,1,2,1,3,2]),e.STATIC_DRAW)};t.WebGLFilterManager.prototype.destroy=function(){var e=this.gl;this.filterStack=null;this.offsetX=0;this.offsetY=0;for(var t=0;t<this.texturePool.length;t++){this.texturePool[t].destroy()}this.texturePool=null;e.deleteBuffer(this.vertexBuffer);e.deleteBuffer(this.uvBuffer);e.deleteBuffer(this.colorBuffer);e.deleteBuffer(this.indexBuffer)};t.FilterTexture=function(e,n,r,i){this.gl=e;this.frameBuffer=e.createFramebuffer();this.texture=e.createTexture();i=i||t.scaleModes.DEFAULT;e.bindTexture(e.TEXTURE_2D,this.texture);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,i===t.scaleModes.LINEAR?e.LINEAR:e.NEAREST);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,i===t.scaleModes.LINEAR?e.LINEAR:e.NEAREST);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE);e.bindFramebuffer(e.FRAMEBUFFER,this.frameBuffer);e.bindFramebuffer(e.FRAMEBUFFER,this.frameBuffer);e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this.texture,0);this.renderBuffer=e.createRenderbuffer();e.bindRenderbuffer(e.RENDERBUFFER,this.renderBuffer);e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,this.renderBuffer);this.resize(n,r)};t.FilterTexture.prototype.clear=function(){var e=this.gl;e.clearColor(0,0,0,0);e.clear(e.COLOR_BUFFER_BIT)};t.FilterTexture.prototype.resize=function(e,t){if(this.width===e&&this.height===t)return;this.width=e;this.height=t;var n=this.gl;n.bindTexture(n.TEXTURE_2D,this.texture);n.texImage2D(n.TEXTURE_2D,0,n.RGBA,e,t,0,n.RGBA,n.UNSIGNED_BYTE,null);n.bindRenderbuffer(n.RENDERBUFFER,this.renderBuffer);n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,e,t)};t.FilterTexture.prototype.destroy=function(){var e=this.gl;e.deleteFramebuffer(this.frameBuffer);e.deleteTexture(this.texture);this.frameBuffer=null;this.texture=null};t.CanvasMaskManager=function(){};t.CanvasMaskManager.prototype.pushMask=function(e,n){var r=n.context;r.save();var i=e.alpha;var s=e.worldTransform;var o=n.resolution;r.setTransform(s.a*o,s.c*o,s.b*o,s.d*o,s.tx*o,s.ty*o);t.CanvasGraphics.renderGraphicsMask(e,r);r.clip();e.worldAlpha=i};t.CanvasMaskManager.prototype.popMask=function(e){e.context.restore()};t.CanvasTinter=function(){};t.CanvasTinter.getTintedTexture=function(e,n){var r=e.texture;n=t.CanvasTinter.roundColor(n);var i="#"+("00000"+(n|0).toString(16)).substr(-6);r.tintCache=r.tintCache||{};if(r.tintCache[i])return r.tintCache[i];var s=t.CanvasTinter.canvas||document.createElement("canvas");t.CanvasTinter.tintMethod(r,n,s);if(t.CanvasTinter.convertTintToImage){var o=new Image;o.src=s.toDataURL();r.tintCache[i]=o}else{r.tintCache[i]=s;t.CanvasTinter.canvas=null}return s};t.CanvasTinter.tintWithMultiply=function(e,t,n){var r=n.getContext("2d");var i=e.crop;n.width=i.width;n.height=i.height;r.fillStyle="#"+("00000"+(t|0).toString(16)).substr(-6);r.fillRect(0,0,i.width,i.height);r.globalCompositeOperation="multiply";r.drawImage(e.baseTexture.source,i.x,i.y,i.width,i.height,0,0,i.width,i.height);r.globalCompositeOperation="destination-atop";r.drawImage(e.baseTexture.source,i.x,i.y,i.width,i.height,0,0,i.width,i.height)};t.CanvasTinter.tintWithOverlay=function(e,t,n){var r=n.getContext("2d");var i=e.crop;n.width=i.width;n.height=i.height;r.globalCompositeOperation="copy";r.fillStyle="#"+("00000"+(t|0).toString(16)).substr(-6);r.fillRect(0,0,i.width,i.height);r.globalCompositeOperation="destination-atop";r.drawImage(e.baseTexture.source,i.x,i.y,i.width,i.height,0,0,i.width,i.height)};t.CanvasTinter.tintWithPerPixel=function(e,n,r){var i=r.getContext("2d");var s=e.crop;r.width=s.width;r.height=s.height;i.globalCompositeOperation="copy";i.drawImage(e.baseTexture.source,s.x,s.y,s.width,s.height,0,0,s.width,s.height);var o=t.hex2rgb(n);var u=o[0],a=o[1],f=o[2];var l=i.getImageData(0,0,s.width,s.height);var c=l.data;for(var h=0;h<c.length;h+=4){c[h+0]*=u;c[h+1]*=a;c[h+2]*=f}i.putImageData(l,0,0)};t.CanvasTinter.roundColor=function(e){var n=t.CanvasTinter.cacheStepsPerColorChannel;var r=t.hex2rgb(e);r[0]=Math.min(255,r[0]/n*n);r[1]=Math.min(255,r[1]/n*n);r[2]=Math.min(255,r[2]/n*n);return t.rgb2hex(r)};t.CanvasTinter.cacheStepsPerColorChannel=8;t.CanvasTinter.convertTintToImage=false;t.CanvasTinter.canUseMultiply=t.canUseNewCanvasBlendModes();t.CanvasTinter.tintMethod=t.CanvasTinter.canUseMultiply?t.CanvasTinter.tintWithMultiply:t.CanvasTinter.tintWithPerPixel;t.CanvasRenderer=function(e,n,r){if(r){for(var i in t.defaultRenderOptions){if(typeof r[i]=="undefined")r[i]=t.defaultRenderOptions[i]}}else{r=t.defaultRenderOptions}this.type=t.CANVAS_RENDERER;this.resolution=r.resolution;this.clearBeforeRender=r.clearBeforeRender;this.transparent=r.transparent;if(!t.blendModesCanvas){t.blendModesCanvas=[];if(t.canUseNewCanvasBlendModes()){t.blendModesCanvas[t.blendModes.NORMAL]="source-over";t.blendModesCanvas[t.blendModes.ADD]="lighter";t.blendModesCanvas[t.blendModes.MULTIPLY]="multiply";t.blendModesCanvas[t.blendModes.SCREEN]="screen";t.blendModesCanvas[t.blendModes.OVERLAY]="overlay";t.blendModesCanvas[t.blendModes.DARKEN]="darken";t.blendModesCanvas[t.blendModes.LIGHTEN]="lighten";t.blendModesCanvas[t.blendModes.COLOR_DODGE]="color-dodge";t.blendModesCanvas[t.blendModes.COLOR_BURN]="color-burn";t.blendModesCanvas[t.blendModes.HARD_LIGHT]="hard-light";t.blendModesCanvas[t.blendModes.SOFT_LIGHT]="soft-light";t.blendModesCanvas[t.blendModes.DIFFERENCE]="difference";t.blendModesCanvas[t.blendModes.EXCLUSION]="exclusion";t.blendModesCanvas[t.blendModes.HUE]="hue";t.blendModesCanvas[t.blendModes.SATURATION]="saturation";t.blendModesCanvas[t.blendModes.COLOR]="color";t.blendModesCanvas[t.blendModes.LUMINOSITY]="luminosity"}else{t.blendModesCanvas[t.blendModes.NORMAL]="source-over";t.blendModesCanvas[t.blendModes.ADD]="lighter";t.blendModesCanvas[t.blendModes.MULTIPLY]="source-over";t.blendModesCanvas[t.blendModes.SCREEN]="source-over";t.blendModesCanvas[t.blendModes.OVERLAY]="source-over";t.blendModesCanvas[t.blendModes.DARKEN]="source-over";t.blendModesCanvas[t.blendModes.LIGHTEN]="source-over";t.blendModesCanvas[t.blendModes.COLOR_DODGE]="source-over";t.blendModesCanvas[t.blendModes.COLOR_BURN]="source-over";t.blendModesCanvas[t.blendModes.HARD_LIGHT]="source-over";t.blendModesCanvas[t.blendModes.SOFT_LIGHT]="source-over";t.blendModesCanvas[t.blendModes.DIFFERENCE]="source-over";t.blendModesCanvas[t.blendModes.EXCLUSION]="source-over";t.blendModesCanvas[t.blendModes.HUE]="source-over";t.blendModesCanvas[t.blendModes.SATURATION]="source-over";t.blendModesCanvas[t.blendModes.COLOR]="source-over";t.blendModesCanvas[t.blendModes.LUMINOSITY]="source-over"}}this.width=e||800;this.height=n||600;this.width*=this.resolution;this.height*=this.resolution;this.view=r.view||document.createElement("canvas");this.context=this.view.getContext("2d",{alpha:this.transparent});this.refresh=true;this.view.width=this.width*this.resolution;this.view.height=this.height*this.resolution;this.count=0;this.maskManager=new t.CanvasMaskManager;this.renderSession={context:this.context,maskManager:this.maskManager,scaleMode:null,smoothProperty:null,roundPixels:false};this.resize(e,n);if("imageSmoothingEnabled"in this.context)this.renderSession.smoothProperty="imageSmoothingEnabled";else if("webkitImageSmoothingEnabled"in this.context)this.renderSession.smoothProperty="webkitImageSmoothingEnabled";else if("mozImageSmoothingEnabled"in this.context)this.renderSession.smoothProperty="mozImageSmoothingEnabled";else if("oImageSmoothingEnabled"in this.context)this.renderSession.smoothProperty="oImageSmoothingEnabled";else if("msImageSmoothingEnabled"in this.context)this.renderSession.smoothProperty="msImageSmoothingEnabled"};t.CanvasRenderer.prototype.constructor=t.CanvasRenderer;t.CanvasRenderer.prototype.render=function(e){t.texturesToUpdate.length=0;t.texturesToDestroy.length=0;e.updateTransform();this.context.setTransform(1,0,0,1,0,0);this.context.globalAlpha=1;if(navigator.isCocoonJS&&this.view.screencanvas){this.context.fillStyle="black";this.context.clear()}if(this.clearBeforeRender){if(!this.transparent)this.context.fillStyle=e.backgroundColorString;this.context[this.transparent?"clearRect":"fillRect"](0,0,this.width,this.height)}this.renderDisplayObject(e);if(e.interactive){if(!e._interactiveEventsAdded){e._interactiveEventsAdded=true;e.interactionManager.setTarget(this)}}if(t.Texture.frameUpdates.length>0){t.Texture.frameUpdates.length=0}};t.CanvasRenderer.prototype.resize=function(e,t){this.width=e*this.resolution;this.height=t*this.resolution;this.view.width=this.width;this.view.height=this.height};t.CanvasRenderer.prototype.renderDisplayObject=function(e,t){this.renderSession.context=t||this.context;this.renderSession.resolution=this.resolution;e._renderCanvas(this.renderSession)};t.CanvasRenderer.prototype.renderStripFlat=function(e){var t=this.context;var n=e.verticies;var r=n.length/2;this.count++;t.beginPath();for(var i=1;i<r-2;i++){var s=i*2;var o=n[s],u=n[s+2],a=n[s+4];var f=n[s+1],l=n[s+3],c=n[s+5];t.moveTo(o,f);t.lineTo(u,l);t.lineTo(a,c)}t.fillStyle="#FF0000";t.fill();t.closePath()};t.CanvasRenderer.prototype.renderStrip=function(e){var t=this.context;var n=e.verticies;var r=e.uvs;var i=n.length/2;this.count++;for(var s=1;s<i-2;s++){var o=s*2;var u=n[o],a=n[o+2],f=n[o+4];var l=n[o+1],c=n[o+3],h=n[o+5];var p=r[o]*e.texture.width,d=r[o+2]*e.texture.width,v=r[o+4]*e.texture.width;var m=r[o+1]*e.texture.height,g=r[o+3]*e.texture.height,y=r[o+5]*e.texture.height;t.save();t.beginPath();t.moveTo(u,l);t.lineTo(a,c);t.lineTo(f,h);t.closePath();t.clip();var b=p*g+m*v+d*y-g*v-m*d-p*y;var w=u*g+m*f+a*y-g*f-m*a-u*y;var E=p*a+u*v+d*f-a*v-u*d-p*f;var S=p*g*f+m*a*v+u*d*y-u*g*v-m*d*f-p*a*y;var x=l*g+m*h+c*y-g*h-m*c-l*y;var T=p*c+l*v+d*h-c*v-l*d-p*h;var N=p*g*h+m*c*v+l*d*y-l*g*v-m*d*h-p*c*y;t.transform(w/b,x/b,E/b,T/b,S/b,N/b);t.drawImage(e.texture.baseTexture.source,0,0);t.restore()}};t.CanvasBuffer=function(e,t){this.width=e;this.height=t;this.canvas=document.createElement("canvas");this.context=this.canvas.getContext("2d");this.canvas.width=e;this.canvas.height=t};t.CanvasBuffer.prototype.clear=function(){this.context.clearRect(0,0,this.width,this.height)};t.CanvasBuffer.prototype.resize=function(e,t){this.width=this.canvas.width=e;this.height=this.canvas.height=t};t.CanvasGraphics=function(){};t.CanvasGraphics.renderGraphics=function(e,n){var r=e.worldAlpha;var i="";for(var s=0;s<e.graphicsData.length;s++){var o=e.graphicsData[s];var u=o.points;n.strokeStyle=i="#"+("00000"+(o.lineColor|0).toString(16)).substr(-6);n.lineWidth=o.lineWidth;if(o.type===t.Graphics.POLY){n.beginPath();n.moveTo(u[0],u[1]);for(var a=1;a<u.length/2;a++){n.lineTo(u[a*2],u[a*2+1])}if(u[0]===u[u.length-2]&&u[1]===u[u.length-1]){n.closePath()}if(o.fill){n.globalAlpha=o.fillAlpha*r;n.fillStyle=i="#"+("00000"+(o.fillColor|0).toString(16)).substr(-6);n.fill()}if(o.lineWidth){n.globalAlpha=o.lineAlpha*r;n.stroke()}}else if(o.type===t.Graphics.RECT){if(o.fillColor||o.fillColor===0){n.globalAlpha=o.fillAlpha*r;n.fillStyle=i="#"+("00000"+(o.fillColor|0).toString(16)).substr(-6);n.fillRect(u[0],u[1],u[2],u[3])}if(o.lineWidth){n.globalAlpha=o.lineAlpha*r;n.strokeRect(u[0],u[1],u[2],u[3])}}else if(o.type===t.Graphics.CIRC){n.beginPath();n.arc(u[0],u[1],u[2],0,2*Math.PI);n.closePath();if(o.fill){n.globalAlpha=o.fillAlpha*r;n.fillStyle=i="#"+("00000"+(o.fillColor|0).toString(16)).substr(-6);n.fill()}if(o.lineWidth){n.globalAlpha=o.lineAlpha*r;n.stroke()}}else if(o.type===t.Graphics.ELIP){var f=o.points;var l=f[2]*2;var c=f[3]*2;var h=f[0]-l/2;var p=f[1]-c/2;n.beginPath();var d=.5522848,v=l/2*d,m=c/2*d,g=h+l,y=p+c,b=h+l/2,w=p+c/2;n.moveTo(h,w);n.bezierCurveTo(h,w-m,b-v,p,b,p);n.bezierCurveTo(b+v,p,g,w-m,g,w);n.bezierCurveTo(g,w+m,b+v,y,b,y);n.bezierCurveTo(b-v,y,h,w+m,h,w);n.closePath();if(o.fill){n.globalAlpha=o.fillAlpha*r;n.fillStyle=i="#"+("00000"+(o.fillColor|0).toString(16)).substr(-6);n.fill()}if(o.lineWidth){n.globalAlpha=o.lineAlpha*r;n.stroke()}}else if(o.type===t.Graphics.RREC){var E=u[0];var S=u[1];var x=u[2];var T=u[3];var N=u[4];var C=Math.min(x,T)/2|0;N=N>C?C:N;n.beginPath();n.moveTo(E,S+N);n.lineTo(E,S+T-N);n.quadraticCurveTo(E,S+T,E+N,S+T);n.lineTo(E+x-N,S+T);n.quadraticCurveTo(E+x,S+T,E+x,S+T-N);n.lineTo(E+x,S+N);n.quadraticCurveTo(E+x,S,E+x-N,S);n.lineTo(E+N,S);n.quadraticCurveTo(E,S,E,S+N);n.closePath();if(o.fillColor||o.fillColor===0){n.globalAlpha=o.fillAlpha*r;n.fillStyle=i="#"+("00000"+(o.fillColor|0).toString(16)).substr(-6);n.fill()}if(o.lineWidth){n.globalAlpha=o.lineAlpha*r;n.stroke()}}}};t.CanvasGraphics.renderGraphicsMask=function(e,n){var r=e.graphicsData.length;if(r===0)return;if(r>1){r=1;window.console.log("Pixi.js warning: masks in canvas can only mask using the first path in the graphics object")}for(var i=0;i<1;i++){var s=e.graphicsData[i];var o=s.points;if(s.type===t.Graphics.POLY){n.beginPath();n.moveTo(o[0],o[1]);for(var u=1;u<o.length/2;u++){n.lineTo(o[u*2],o[u*2+1])}if(o[0]===o[o.length-2]&&o[1]===o[o.length-1]){n.closePath()}}else if(s.type===t.Graphics.RECT){n.beginPath();n.rect(o[0],o[1],o[2],o[3]);n.closePath()}else if(s.type===t.Graphics.CIRC){n.beginPath();n.arc(o[0],o[1],o[2],0,2*Math.PI);n.closePath()}else if(s.type===t.Graphics.ELIP){var a=s.points;var f=a[2]*2;var l=a[3]*2;var c=a[0]-f/2;var h=a[1]-l/2;n.beginPath();var p=.5522848,d=f/2*p,v=l/2*p,m=c+f,g=h+l,y=c+f/2,b=h+l/2;n.moveTo(c,b);n.bezierCurveTo(c,b-v,y-d,h,y,h);n.bezierCurveTo(y+d,h,m,b-v,m,b);n.bezierCurveTo(m,b+v,y+d,g,y,g);n.bezierCurveTo(y-d,g,c,b+v,c,b);n.closePath()}else if(s.type===t.Graphics.RREC){var w=o[0];var E=o[1];var S=o[2];var x=o[3];var T=o[4];var N=Math.min(S,x)/2|0;T=T>N?N:T;n.beginPath();n.moveTo(w,E+T);n.lineTo(w,E+x-T);n.quadraticCurveTo(w,E+x,w+T,E+x);n.lineTo(w+S-T,E+x);n.quadraticCurveTo(w+S,E+x,w+S,E+x-T);n.lineTo(w+S,E+T);n.quadraticCurveTo(w+S,E,w+S-T,E);n.lineTo(w+T,E);n.quadraticCurveTo(w,E,w,E+T);n.closePath()}}};t.Graphics=function(){t.DisplayObjectContainer.call(this);this.renderable=true;this.fillAlpha=1;this.lineWidth=0;this.lineColor="black";this.graphicsData=[];this.tint=16777215;this.blendMode=t.blendModes.NORMAL;this.currentPath={points:[]};this._webGL=[];this.isMask=false;this.bounds=null;this.boundsPadding=10;this.dirty=true};t.Graphics.prototype=Object.create(t.DisplayObjectContainer.prototype);t.Graphics.prototype.constructor=t.Graphics;Object.defineProperty(t.Graphics.prototype,"cacheAsBitmap",{get:function(){return this._cacheAsBitmap},set:function(e){this._cacheAsBitmap=e;if(this._cacheAsBitmap){this._generateCachedSprite()}else{this.destroyCachedSprite();this.dirty=true}}});t.Graphics.prototype.lineStyle=function(e,n,r){if(!this.currentPath.points.length)this.graphicsData.pop();this.lineWidth=e||0;this.lineColor=n||0;this.lineAlpha=arguments.length<3?1:r;this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[],type:t.Graphics.POLY};this.graphicsData.push(this.currentPath);return this};t.Graphics.prototype.moveTo=function(e,n){if(!this.currentPath.points.length)this.graphicsData.pop();this.currentPath=this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[],type:t.Graphics.POLY};this.currentPath.points.push(e,n);this.graphicsData.push(this.currentPath);return this};t.Graphics.prototype.lineTo=function(e,t){this.currentPath.points.push(e,t);this.dirty=true;return this};t.Graphics.prototype.quadraticCurveTo=function(e,t,n,r){if(this.currentPath.points.length===0)this.moveTo(0,0);var i,s,o=20,u=this.currentPath.points;if(u.length===0)this.moveTo(0,0);var a=u[u.length-2];var f=u[u.length-1];var l=0;for(var c=1;c<=o;c++){l=c/o;i=a+(e-a)*l;s=f+(t-f)*l;u.push(i+(e+(n-e)*l-i)*l,s+(t+(r-t)*l-s)*l)}this.dirty=true;return this};t.Graphics.prototype.bezierCurveTo=function(e,t,n,r,i,s){if(this.currentPath.points.length===0)this.moveTo(0,0);var o=20,u,a,f,l,c,h=this.currentPath.points;var p=h[h.length-2];var d=h[h.length-1];var v=0;for(var m=1;m<=o;m++){v=m/o;u=1-v;a=u*u;f=a*u;l=v*v;c=l*v;h.push(f*p+3*a*v*e+3*u*l*n+c*i,f*d+3*a*v*t+3*u*l*r+c*s)}this.dirty=true;return this};t.Graphics.prototype.arcTo=function(e,t,n,r,i){if(this.currentPath.points.length===0)this.moveTo(e,t);var s=this.currentPath.points;var o=s[s.length-2];var u=s[s.length-1];var a=u-t;var f=o-e;var l=r-t;var c=n-e;var h=Math.abs(a*c-f*l);if(h<1e-8||i===0){s.push(e,t)}else{var p=a*a+f*f;var d=l*l+c*c;var v=a*l+f*c;var m=i*Math.sqrt(p)/h;var g=i*Math.sqrt(d)/h;var y=m*v/p;var b=g*v/d;var w=m*c+g*f;var E=m*l+g*a;var S=f*(g+y);var x=a*(g+y);var T=c*(m+b);var N=l*(m+b);var C=Math.atan2(x-E,S-w);var k=Math.atan2(N-E,T-w);this.arc(w+e,E+t,i,C,k,f*l>c*a)}this.dirty=true;return this};t.Graphics.prototype.arc=function(e,t,n,r,i,s){var o=e+Math.cos(r)*n;var u=t+Math.sin(r)*n;var a=this.currentPath.points;if(a.length!==0&&a[a.length-2]!==o||a[a.length-1]!==u){this.moveTo(o,u);a=this.currentPath.points}if(r===i)return this;if(!s&&i<=r){i+=Math.PI*2}else if(s&&r<=i){r+=Math.PI*2}var f=s?(r-i)*-1:i-r;var l=Math.abs(f)/(Math.PI*2)*40;if(f===0)return this;var c=f/(l*2);var h=c*2;var p=Math.cos(c);var d=Math.sin(c);var v=l-1;var m=v%1/v;for(var g=0;g<=v;g++){var y=g+m*g;var b=c+r+h*y;var w=Math.cos(b);var E=-Math.sin(b);a.push((p*w+d*E)*n+e,(p*-E+d*w)*n+t)}this.dirty=true;return this};t.Graphics.prototype.drawPath=function(e){if(!this.currentPath.points.length)this.graphicsData.pop();this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[],type:t.Graphics.POLY};this.graphicsData.push(this.currentPath);this.currentPath.points=this.currentPath.points.concat(e);this.dirty=true;return this};t.Graphics.prototype.beginFill=function(e,t){this.filling=true;this.fillColor=e||0;this.fillAlpha=arguments.length<2?1:t;return this};t.Graphics.prototype.endFill=function(){this.filling=false;this.fillColor=null;this.fillAlpha=1;return this};t.Graphics.prototype.drawRect=function(e,n,r,i){if(!this.currentPath.points.length)this.graphicsData.pop();this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[e,n,r,i],type:t.Graphics.RECT};this.graphicsData.push(this.currentPath);this.dirty=true;return this};t.Graphics.prototype.drawRoundedRect=function(e,n,r,i,s){if(!this.currentPath.points.length)this.graphicsData.pop();this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[e,n,r,i,s],type:t.Graphics.RREC};this.graphicsData.push(this.currentPath);this.dirty=true;return this};t.Graphics.prototype.drawCircle=function(e,n,r){if(!this.currentPath.points.length)this.graphicsData.pop();this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[e,n,r,r],type:t.Graphics.CIRC};this.graphicsData.push(this.currentPath);this.dirty=true;return this};t.Graphics.prototype.drawEllipse=function(e,n,r,i){if(!this.currentPath.points.length)this.graphicsData.pop();this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[e,n,r,i],type:t.Graphics.ELIP};this.graphicsData.push(this.currentPath);this.dirty=true;return this};t.Graphics.prototype.clear=function(){this.lineWidth=0;this.filling=false;this.dirty=true;this.clearDirty=true;this.graphicsData=[];this.bounds=null;return this};t.Graphics.prototype.generateTexture=function(e,n){e=e||2;var r=this.getBounds();var i=new t.CanvasBuffer(r.width*e,r.height*e);var s=t.Texture.fromCanvas(i.canvas,n);s.baseTexture.resolution=e;i.context.scale(e,e);i.context.translate(-r.x,-r.y);t.CanvasGraphics.renderGraphics(this,i.context);return s};t.Graphics.prototype._renderWebGL=function(e){if(this.visible===false||this.alpha===0||this.isMask===true)return;if(this._cacheAsBitmap){if(this.dirty){this._generateCachedSprite();t.updateWebGLTexture(this._cachedSprite.texture.baseTexture,e.gl);this.dirty=false}this._cachedSprite.alpha=this.alpha;t.Sprite.prototype._renderWebGL.call(this._cachedSprite,e);return}else{e.spriteBatch.stop();e.blendModeManager.setBlendMode(this.blendMode);if(this._mask)e.maskManager.pushMask(this._mask,e);if(this._filters)e.filterManager.pushFilter(this._filterBlock);if(this.blendMode!==e.spriteBatch.currentBlendMode){e.spriteBatch.currentBlendMode=this.blendMode;var n=t.blendModesWebGL[e.spriteBatch.currentBlendMode];e.spriteBatch.gl.blendFunc(n[0],n[1])}t.WebGLGraphics.renderGraphics(this,e);if(this.children.length){e.spriteBatch.start();for(var r=0,i=this.children.length;r<i;r++){this.children[r]._renderWebGL(e)}e.spriteBatch.stop()}if(this._filters)e.filterManager.popFilter();if(this._mask)e.maskManager.popMask(this.mask,e);e.drawCount++;e.spriteBatch.start()}};t.Graphics.prototype._renderCanvas=function(e){if(this.visible===false||this.alpha===0||this.isMask===true)return;var n=e.context;var r=this.worldTransform;if(this.blendMode!==e.currentBlendMode){e.currentBlendMode=this.blendMode;n.globalCompositeOperation=t.blendModesCanvas[e.currentBlendMode]}if(this._mask){e.maskManager.pushMask(this._mask,e.context)}var i=e.resolution;n.setTransform(r.a*i,r.c*i,r.b*i,r.d*i,r.tx*i,r.ty*i);t.CanvasGraphics.renderGraphics(this,n);for(var s=0,o=this.children.length;s<o;s++){this.children[s]._renderCanvas(e)}if(this._mask){e.maskManager.popMask(e.context)}};t.Graphics.prototype.getBounds=function(e){if(!this.bounds)this.updateBounds();var t=this.bounds.x;var n=this.bounds.width+this.bounds.x;var r=this.bounds.y;var i=this.bounds.height+this.bounds.y;var s=e||this.worldTransform;var o=s.a;var u=s.c;var a=s.b;var f=s.d;var l=s.tx;var c=s.ty;var h=o*n+a*i+l;var p=f*i+u*n+c;var d=o*t+a*i+l;var v=f*i+u*t+c;var m=o*t+a*r+l;var g=f*r+u*t+c;var y=o*n+a*r+l;var b=f*r+u*n+c;var w=h;var E=p;var S=h;var x=p;S=d<S?d:S;S=m<S?m:S;S=y<S?y:S;x=v<x?v:x;x=g<x?g:x;x=b<x?b:x;w=d>w?d:w;w=m>w?m:w;w=y>w?y:w;E=v>E?v:E;E=g>E?g:E;E=b>E?b:E;var T=this._bounds;T.x=S;T.width=w-S;T.y=x;T.height=E-x;return T};t.Graphics.prototype.updateBounds=function(){var e=Infinity;var n=-Infinity;var r=Infinity;var i=-Infinity;var s,o,u,a,f;for(var l=0;l<this.graphicsData.length;l++){var c=this.graphicsData[l];var h=c.type;var p=c.lineWidth;s=c.points;if(h===t.Graphics.RECT){o=s[0]-p/2;u=s[1]-p/2;a=s[2]+p;f=s[3]+p;e=o<e?o:e;n=o+a>n?o+a:n;r=u<r?u:r;i=u+f>i?u+f:i}else if(h===t.Graphics.CIRC||h===t.Graphics.ELIP){o=s[0];u=s[1];a=s[2]+p/2;f=s[3]+p/2;e=o-a<e?o-a:e;n=o+a>n?o+a:n;r=u-f<r?u-f:r;i=u+f>i?u+f:i}else{for(var d=0;d<s.length;d+=2){o=s[d];u=s[d+1];e=o-p<e?o-p:e;n=o+p>n?o+p:n;r=u-p<r?u-p:r;i=u+p>i?u+p:i}}}var v=this.boundsPadding;this.bounds=new t.Rectangle(e-v,r-v,n-e+v*2,i-r+v*2)};t.Graphics.prototype._generateCachedSprite=function(){var e=this.getLocalBounds();if(!this._cachedSprite){var n=new t.CanvasBuffer(e.width,e.height);var r=t.Texture.fromCanvas(n.canvas);this._cachedSprite=new t.Sprite(r);this._cachedSprite.buffer=n;this._cachedSprite.worldTransform=this.worldTransform}else{this._cachedSprite.buffer.resize(e.width,e.height)}this._cachedSprite.anchor.x=-(e.x/e.width);this._cachedSprite.anchor.y=-(e.y/e.height);this._cachedSprite.buffer.context.translate(-e.x,-e.y);t.CanvasGraphics.renderGraphics(this,this._cachedSprite.buffer.context);this._cachedSprite.alpha=this.alpha};t.Graphics.prototype.destroyCachedSprite=function(){this._cachedSprite.texture.destroy(true);this._cachedSprite=null};t.Graphics.POLY=0;t.Graphics.RECT=1;t.Graphics.CIRC=2;t.Graphics.ELIP=3;t.Graphics.RREC=4;t.Strip=function(e){t.DisplayObjectContainer.call(this);this.texture=e;this.uvs=new t.Float32Array([0,1,1,1,1,0,0,1]);this.verticies=new t.Float32Array([0,0,100,0,100,100,0,100]);this.colors=new t.Float32Array([1,1,1,1]);this.indices=new t.Uint16Array([0,1,2,3]);this.dirty=true;this.padding=0};t.Strip.prototype=Object.create(t.DisplayObjectContainer.prototype);t.Strip.prototype.constructor=t.Strip;t.Strip.prototype._renderWebGL=function(e){if(!this.visible||this.alpha<=0)return;e.spriteBatch.stop();if(!this._vertexBuffer)this._initWebGL(e);e.shaderManager.setShader(e.shaderManager.stripShader);this._renderStrip(e);e.spriteBatch.start()};t.Strip.prototype._initWebGL=function(e){var t=e.gl;this._vertexBuffer=t.createBuffer();this._indexBuffer=t.createBuffer();this._uvBuffer=t.createBuffer();this._colorBuffer=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,this._vertexBuffer);t.bufferData(t.ARRAY_BUFFER,this.verticies,t.DYNAMIC_DRAW);t.bindBuffer(t.ARRAY_BUFFER,this._uvBuffer);t.bufferData(t.ARRAY_BUFFER,this.uvs,t.STATIC_DRAW);t.bindBuffer(t.ARRAY_BUFFER,this._colorBuffer);t.bufferData(t.ARRAY_BUFFER,this.colors,t.STATIC_DRAW);t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this._indexBuffer);t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.indices,t.STATIC_DRAW)};t.Strip.prototype._renderStrip=function(e){var n=e.gl;var r=e.projection,i=e.offset,s=e.shaderManager.stripShader;n.blendFunc(n.ONE,n.ONE_MINUS_SRC_ALPHA);n.uniformMatrix3fv(s.translationMatrix,false,this.worldTransform.toArray(true));n.uniform2f(s.projectionVector,r.x,-r.y);n.uniform2f(s.offsetVector,-i.x,-i.y);n.uniform1f(s.alpha,1);if(!this.dirty){n.bindBuffer(n.ARRAY_BUFFER,this._vertexBuffer);n.bufferSubData(n.ARRAY_BUFFER,0,this.verticies);n.vertexAttribPointer(s.aVertexPosition,2,n.FLOAT,false,0,0);n.bindBuffer(n.ARRAY_BUFFER,this._uvBuffer);n.vertexAttribPointer(s.aTextureCoord,2,n.FLOAT,false,0,0);n.activeTexture(n.TEXTURE0);n.bindTexture(n.TEXTURE_2D,this.texture.baseTexture._glTextures[n.id]||t.createWebGLTexture(this.texture.baseTexture,n));n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this._indexBuffer)}else{this.dirty=false;n.bindBuffer(n.ARRAY_BUFFER,this._vertexBuffer);n.bufferData(n.ARRAY_BUFFER,this.verticies,n.STATIC_DRAW);n.vertexAttribPointer(s.aVertexPosition,2,n.FLOAT,false,0,0);n.bindBuffer(n.ARRAY_BUFFER,this._uvBuffer);n.bufferData(n.ARRAY_BUFFER,this.uvs,n.STATIC_DRAW);n.vertexAttribPointer(s.aTextureCoord,2,n.FLOAT,false,0,0);n.activeTexture(n.TEXTURE0);n.bindTexture(n.TEXTURE_2D,this.texture.baseTexture._glTextures[n.id]||t.createWebGLTexture(this.texture.baseTexture,n));n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this._indexBuffer);n.bufferData(n.ELEMENT_ARRAY_BUFFER,this.indices,n.STATIC_DRAW)}n.drawElements(n.TRIANGLE_STRIP,this.indices.length,n.UNSIGNED_SHORT,0)};t.Strip.prototype._renderCanvas=function(e){var t=e.context;var n=this.worldTransform;if(e.roundPixels){t.setTransform(n.a,n.c,n.b,n.d,n.tx|0,n.ty|0)}else{t.setTransform(n.a,n.c,n.b,n.d,n.tx,n.ty)}var r=this;var i=r.verticies;var s=r.uvs;var o=i.length/2;this.count++;for(var u=0;u<o-2;u++){var a=u*2;var f=i[a],l=i[a+2],c=i[a+4];var h=i[a+1],p=i[a+3],d=i[a+5];if(this.padding===0){var v=(f+l+c)/3;var m=(h+p+d)/3;var g=f-v;var y=h-m;var b=Math.sqrt(g*g+y*y);f=v+g/b*(b+3);h=m+y/b*(b+3);g=l-v;y=p-m;b=Math.sqrt(g*g+y*y);l=v+g/b*(b+3);p=m+y/b*(b+3);g=c-v;y=d-m;b=Math.sqrt(g*g+y*y);c=v+g/b*(b+3);d=m+y/b*(b+3)}var w=s[a]*r.texture.width,E=s[a+2]*r.texture.width,S=s[a+4]*r.texture.width;var x=s[a+1]*r.texture.height,T=s[a+3]*r.texture.height,N=s[a+5]*r.texture.height;t.save();t.beginPath();t.moveTo(f,h);t.lineTo(l,p);t.lineTo(c,d);t.closePath();t.clip();var C=w*T+x*S+E*N-T*S-x*E-w*N;var k=f*T+x*c+l*N-T*c-x*l-f*N;var L=w*l+f*S+E*c-l*S-f*E-w*c;var A=w*T*c+x*l*S+f*E*N-f*T*S-x*E*c-w*l*N;var O=h*T+x*d+p*N-T*d-x*p-h*N;var M=w*p+h*S+E*d-p*S-h*E-w*d;var _=w*T*d+x*p*S+h*E*N-h*T*S-x*E*d-w*p*N;t.transform(k/C,O/C,L/C,M/C,A/C,_/C);t.drawImage(r.texture.baseTexture.source,0,0);t.restore()}};t.Strip.prototype.onTextureUpdate=function(){this.updateFrame=true};t.Rope=function(e,n){t.Strip.call(this,e);this.points=n;this.verticies=new t.Float32Array(n.length*4);this.uvs=new t.Float32Array(n.length*4);this.colors=new t.Float32Array(n.length*2);this.indices=new t.Uint16Array(n.length*2);this.refresh()};t.Rope.prototype=Object.create(t.Strip.prototype);t.Rope.prototype.constructor=t.Rope;t.Rope.prototype.refresh=function(){var e=this.points;if(e.length<1)return;var t=this.uvs;var n=e[0];var r=this.indices;var i=this.colors;this.count-=.2;t[0]=0;t[1]=0;t[2]=0;t[3]=1;i[0]=1;i[1]=1;r[0]=0;r[1]=1;var s=e.length,o,u,a;for(var f=1;f<s;f++){o=e[f];u=f*4;a=f/(s-1);if(f%2){t[u]=a;t[u+1]=0;t[u+2]=a;t[u+3]=1}else{t[u]=a;t[u+1]=0;t[u+2]=a;t[u+3]=1}u=f*2;i[u]=1;i[u+1]=1;u=f*2;r[u]=u;r[u+1]=u+1;n=o}};t.Rope.prototype.updateTransform=function(){var e=this.points;if(e.length<1)return;var n=e[0];var r;var i={x:0,y:0};this.count-=.2;var s=this.verticies;var o=e.length,u,a,f,l,c;for(var h=0;h<o;h++){u=e[h];a=h*4;if(h<e.length-1){r=e[h+1]}else{r=u}i.y=-(r.x-n.x);i.x=r.y-n.y;f=(1-h/(o-1))*10;if(f>1)f=1;l=Math.sqrt(i.x*i.x+i.y*i.y);c=this.texture.height/2;i.x/=l;i.y/=l;i.x*=c;i.y*=c;s[a]=u.x+i.x;s[a+1]=u.y+i.y;s[a+2]=u.x-i.x;s[a+3]=u.y-i.y;n=u}t.DisplayObjectContainer.prototype.updateTransform.call(this)};t.Rope.prototype.setTexture=function(e){this.texture=e};t.TilingSprite=function(e,n,r){t.Sprite.call(this,e);this._width=n||100;this._height=r||100;this.tileScale=new t.Point(1,1);this.tileScaleOffset=new t.Point(1,1);this.tilePosition=new t.Point(0,0);this.renderable=true;this.tint=16777215;this.blendMode=t.blendModes.NORMAL};t.TilingSprite.prototype=Object.create(t.Sprite.prototype);t.TilingSprite.prototype.constructor=t.TilingSprite;Object.defineProperty(t.TilingSprite.prototype,"width",{get:function(){return this._width},set:function(e){this._width=e}});Object.defineProperty(t.TilingSprite.prototype,"height",{get:function(){return this._height},set:function(e){this._height=e}});t.TilingSprite.prototype.setTexture=function(e){if(this.texture===e)return;this.texture=e;this.refreshTexture=true;this.cachedTint=16777215};t.TilingSprite.prototype._renderWebGL=function(e){if(this.visible===false||this.alpha===0)return;var n,r;if(this._mask){e.spriteBatch.stop();e.maskManager.pushMask(this.mask,e);e.spriteBatch.start()}if(this._filters){e.spriteBatch.flush();e.filterManager.pushFilter(this._filterBlock)}if(!this.tilingTexture||this.refreshTexture){this.generateTilingTexture(true);if(this.tilingTexture&&this.tilingTexture.needsUpdate){t.updateWebGLTexture(this.tilingTexture.baseTexture,e.gl);this.tilingTexture.needsUpdate=false}}else{e.spriteBatch.renderTilingSprite(this)}for(n=0,r=this.children.length;n<r;n++){this.children[n]._renderWebGL(e)}e.spriteBatch.stop();if(this._filters)e.filterManager.popFilter();if(this._mask)e.maskManager.popMask(this._mask,e);e.spriteBatch.start()};t.TilingSprite.prototype._renderCanvas=function(e){if(this.visible===false||this.alpha===0)return;var n=e.context;if(this._mask){e.maskManager.pushMask(this._mask,n)}n.globalAlpha=this.worldAlpha;var r=this.worldTransform;var i,s;var o=e.resolution;n.setTransform(r.a*o,r.c*o,r.b*o,r.d*o,r.tx*o,r.ty*o);if(!this.__tilePattern||this.refreshTexture){this.generateTilingTexture(false);if(this.tilingTexture){this.__tilePattern=n.createPattern(this.tilingTexture.baseTexture.source,"repeat")}else{return}}if(this.blendMode!==e.currentBlendMode){e.currentBlendMode=this.blendMode;n.globalCompositeOperation=t.blendModesCanvas[e.currentBlendMode]}var u=this.tilePosition;var a=this.tileScale;u.x%=this.tilingTexture.baseTexture.width;u.y%=this.tilingTexture.baseTexture.height;n.scale(a.x,a.y);n.translate(u.x,u.y);n.fillStyle=this.__tilePattern;n.fillRect(-u.x+this.anchor.x*-this._width,-u.y+this.anchor.y*-this._height,this._width/a.x,this._height/a.y);n.scale(1/a.x,1/a.y);n.translate(-u.x,-u.y);if(this._mask){e.maskManager.popMask(e.context)}for(i=0,s=this.children.length;i<s;i++){this.children[i]._renderCanvas(e)}};t.TilingSprite.prototype.getBounds=function(){var e=this._width;var t=this._height;var n=e*(1-this.anchor.x);var r=e*-this.anchor.x;var i=t*(1-this.anchor.y);var s=t*-this.anchor.y;var o=this.worldTransform;var u=o.a;var a=o.c;var f=o.b;var l=o.d;var c=o.tx;var h=o.ty;var p=u*r+f*s+c;var d=l*s+a*r+h;var v=u*n+f*s+c;var m=l*s+a*n+h;var g=u*n+f*i+c;var y=l*i+a*n+h;var b=u*r+f*i+c;var w=l*i+a*r+h;var E=-Infinity;var S=-Infinity;var x=Infinity;var T=Infinity;x=p<x?p:x;x=v<x?v:x;x=g<x?g:x;x=b<x?b:x;T=d<T?d:T;T=m<T?m:T;T=y<T?y:T;T=w<T?w:T;E=p>E?p:E;E=v>E?v:E;E=g>E?g:E;E=b>E?b:E;S=d>S?d:S;S=m>S?m:S;S=y>S?y:S;S=w>S?w:S;var N=this._bounds;N.x=x;N.width=E-x;N.y=T;N.height=S-T;this._currentBounds=N;return N};t.TilingSprite.prototype.onTextureUpdate=function(){};t.TilingSprite.prototype.generateTilingTexture=function(e){if(!this.texture.baseTexture.hasLoaded)return;var n=this.texture;var r=n.frame;var i,s;var o=r.width!==n.baseTexture.width||r.height!==n.baseTexture.height;var u=false;if(!e){if(o){i=r.width;s=r.height;u=true}}else{i=t.getNextPowerOfTwo(r.width);s=t.getNextPowerOfTwo(r.height);if(r.width!==i||r.height!==s)u=true}if(u){var a;if(this.tilingTexture&&this.tilingTexture.isTiling){a=this.tilingTexture.canvasBuffer;a.resize(i,s);this.tilingTexture.baseTexture.width=i;this.tilingTexture.baseTexture.height=s;this.tilingTexture.needsUpdate=true}else{a=new t.CanvasBuffer(i,s);this.tilingTexture=t.Texture.fromCanvas(a.canvas);this.tilingTexture.canvasBuffer=a;this.tilingTexture.isTiling=true}a.context.drawImage(n.baseTexture.source,n.crop.x,n.crop.y,n.crop.width,n.crop.height,0,0,i,s);this.tileScaleOffset.x=r.width/i;this.tileScaleOffset.y=r.height/s}else{if(this.tilingTexture&&this.tilingTexture.isTiling){this.tilingTexture.destroy(true)}this.tileScaleOffset.x=1;this.tileScaleOffset.y=1;this.tilingTexture=n}this.refreshTexture=false;this.tilingTexture.baseTexture._powerOf2=true};var n={};n.BoneData=function(e,t){this.name=e;this.parent=t};n.BoneData.prototype={length:0,x:0,y:0,rotation:0,scaleX:1,scaleY:1};n.SlotData=function(e,t){this.name=e;this.boneData=t};n.SlotData.prototype={r:1,g:1,b:1,a:1,attachmentName:null};n.Bone=function(e,t){this.data=e;this.parent=t;this.setToSetupPose()};n.Bone.yDown=false;n.Bone.prototype={x:0,y:0,rotation:0,scaleX:1,scaleY:1,m00:0,m01:0,worldX:0,m10:0,m11:0,worldY:0,worldRotation:0,worldScaleX:1,worldScaleY:1,updateWorldTransform:function(e,t){var r=this.parent;if(r!=null){this.worldX=this.x*r.m00+this.y*r.m01+r.worldX;this.worldY=this.x*r.m10+this.y*r.m11+r.worldY;this.worldScaleX=r.worldScaleX*this.scaleX;this.worldScaleY=r.worldScaleY*this.scaleY;this.worldRotation=r.worldRotation+this.rotation}else{this.worldX=this.x;this.worldY=this.y;this.worldScaleX=this.scaleX;this.worldScaleY=this.scaleY;this.worldRotation=this.rotation}var i=this.worldRotation*Math.PI/180;var s=Math.cos(i);var o=Math.sin(i);this.m00=s*this.worldScaleX;this.m10=o*this.worldScaleX;this.m01=-o*this.worldScaleY;this.m11=s*this.worldScaleY;if(e){this.m00=-this.m00;this.m01=-this.m01}if(t){this.m10=-this.m10;this.m11=-this.m11}if(n.Bone.yDown){this.m10=-this.m10;this.m11=-this.m11}},setToSetupPose:function(){var e=this.data;this.x=e.x;this.y=e.y;this.rotation=e.rotation;this.scaleX=e.scaleX;this.scaleY=e.scaleY}};n.Slot=function(e,t,n){this.data=e;this.skeleton=t;this.bone=n;this.setToSetupPose()};n.Slot.prototype={r:1,g:1,b:1,a:1,_attachmentTime:0,attachment:null,setAttachment:function(e){this.attachment=e;this._attachmentTime=this.skeleton.time},setAttachmentTime:function(e){this._attachmentTime=this.skeleton.time-e},getAttachmentTime:function(){return this.skeleton.time-this._attachmentTime},setToSetupPose:function(){var e=this.data;this.r=e.r;this.g=e.g;this.b=e.b;this.a=e.a;var t=this.skeleton.data.slots;for(var n=0,r=t.length;n<r;n++){if(t[n]==e){this.setAttachment(!e.attachmentName?null:this.skeleton.getAttachmentBySlotIndex(n,e.attachmentName));break}}}};n.Skin=function(e){this.name=e;this.attachments={}};n.Skin.prototype={addAttachment:function(e,t,n){this.attachments[e+":"+t]=n},getAttachment:function(e,t){return this.attachments[e+":"+t]},_attachAll:function(e,t){for(var n in t.attachments){var r=n.indexOf(":");var i=parseInt(n.substring(0,r),10);var s=n.substring(r+1);var o=e.slots[i];if(o.attachment&&o.attachment.name==s){var u=this.getAttachment(i,s);if(u)o.setAttachment(u)}}}};n.Animation=function(e,t,n){this.name=e;this.timelines=t;this.duration=n};n.Animation.prototype={apply:function(e,t,n){if(n&&this.duration)t%=this.duration;var r=this.timelines;for(var i=0,s=r.length;i<s;i++)r[i].apply(e,t,1)},mix:function(e,t,n,r){if(n&&this.duration)t%=this.duration;var i=this.timelines;for(var s=0,o=i.length;s<o;s++)i[s].apply(e,t,r)}};n.binarySearch=function(e,t,n){var r=0;var i=Math.floor(e.length/n)-2;if(!i)return n;var s=i>>>1;while(true){if(e[(s+1)*n]<=t)r=s+1;else i=s;if(r==i)return(r+1)*n;s=r+i>>>1}};n.linearSearch=function(e,t,n){for(var r=0,i=e.length-n;r<=i;r+=n)if(e[r]>t)return r;return-1};n.Curves=function(e){this.curves=[];this.curves.length=(e-1)*6};n.Curves.prototype={setLinear:function(e){this.curves[e*6]=0},setStepped:function(e){this.curves[e*6]=-1},setCurve:function(e,t,n,r,i){var s=1/10;var o=s*s;var u=o*s;var a=3*s;var f=3*o;var l=6*o;var c=6*u;var h=-t*2+r;var p=-n*2+i;var d=(t-r)*3+1;var v=(n-i)*3+1;var m=e*6;var g=this.curves;g[m]=t*a+h*f+d*u;g[m+1]=n*a+p*f+v*u;g[m+2]=h*l+d*c;g[m+3]=p*l+v*c;g[m+4]=d*c;g[m+5]=v*c},getCurvePercent:function(e,t){t=t<0?0:t>1?1:t;var n=e*6;var r=this.curves;var i=r[n];if(!i)return t;if(i==-1)return 0;var s=r[n+1];var o=r[n+2];var u=r[n+3];var a=r[n+4];var f=r[n+5];var l=i,c=s;var h=10-2;while(true){if(l>=t){var p=l-i;var d=c-s;return d+(c-d)*(t-p)/(l-p)}if(!h)break;h--;i+=o;s+=u;o+=a;u+=f;l+=i;c+=s}return c+(1-c)*(t-l)/(1-l)}};n.RotateTimeline=function(e){this.curves=new n.Curves(e);this.frames=[];this.frames.length=e*2};n.RotateTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/2},setFrame:function(e,t,n){e*=2;this.frames[e]=t;this.frames[e+1]=n},apply:function(e,t,r){var i=this.frames,s;if(t<i[0])return;var o=e.bones[this.boneIndex];if(t>=i[i.length-2]){s=o.data.rotation+i[i.length-1]-o.rotation;while(s>180)s-=360;while(s<-180)s+=360;o.rotation+=s*r;return}var u=n.binarySearch(i,t,2);var a=i[u-1];var f=i[u];var l=1-(t-f)/(i[u-2]-f);l=this.curves.getCurvePercent(u/2-1,l);s=i[u+1]-a;while(s>180)s-=360;while(s<-180)s+=360;s=o.data.rotation+(a+s*l)-o.rotation;while(s>180)s-=360;while(s<-180)s+=360;o.rotation+=s*r}};n.TranslateTimeline=function(e){this.curves=new n.Curves(e);this.frames=[];this.frames.length=e*3};n.TranslateTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/3},setFrame:function(e,t,n,r){e*=3;this.frames[e]=t;this.frames[e+1]=n;this.frames[e+2]=r},apply:function(e,t,r){var i=this.frames;if(t<i[0])return;var s=e.bones[this.boneIndex];if(t>=i[i.length-3]){s.x+=(s.data.x+i[i.length-2]-s.x)*r;s.y+=(s.data.y+i[i.length-1]-s.y)*r;return}var o=n.binarySearch(i,t,3);var u=i[o-2];var a=i[o-1];var f=i[o];var l=1-(t-f)/(i[o+ -3]-f);l=this.curves.getCurvePercent(o/3-1,l);s.x+=(s.data.x+u+(i[o+1]-u)*l-s.x)*r;s.y+=(s.data.y+a+(i[o+2]-a)*l-s.y)*r}};n.ScaleTimeline=function(e){this.curves=new n.Curves(e);this.frames=[];this.frames.length=e*3};n.ScaleTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/3},setFrame:function(e,t,n,r){e*=3;this.frames[e]=t;this.frames[e+1]=n;this.frames[e+2]=r},apply:function(e,t,r){var i=this.frames;if(t<i[0])return;var s=e.bones[this.boneIndex];if(t>=i[i.length-3]){s.scaleX+=(s.data.scaleX-1+i[i.length-2]-s.scaleX)*r;s.scaleY+=(s.data.scaleY-1+i[i.length-1]-s.scaleY)*r;return}var o=n.binarySearch(i,t,3);var u=i[o-2];var a=i[o-1];var f=i[o];var l=1-(t-f)/(i[o+ -3]-f);l=this.curves.getCurvePercent(o/3-1,l);s.scaleX+=(s.data.scaleX-1+u+(i[o+1]-u)*l-s.scaleX)*r;s.scaleY+=(s.data.scaleY-1+a+(i[o+2]-a)*l-s.scaleY)*r}};n.ColorTimeline=function(e){this.curves=new n.Curves(e);this.frames=[];this.frames.length=e*5};n.ColorTimeline.prototype={slotIndex:0,getFrameCount:function(){return this.frames.length/5},setFrame:function(e,t,n,r,i,s){e*=5;this.frames[e]=t;this.frames[e+1]=n;this.frames[e+2]=r;this.frames[e+3]=i;this.frames[e+4]=s},apply:function(e,t,r){var i=this.frames;if(t<i[0])return;var s=e.slots[this.slotIndex];if(t>=i[i.length-5]){var o=i.length-1;s.r=i[o-3];s.g=i[o-2];s.b=i[o-1];s.a=i[o];return}var u=n.binarySearch(i,t,5);var a=i[u-4];var f=i[u-3];var l=i[u-2];var c=i[u-1];var h=i[u];var p=1-(t-h)/(i[u-5]-h);p=this.curves.getCurvePercent(u/5-1,p);var d=a+(i[u+1]-a)*p;var v=f+(i[u+2]-f)*p;var m=l+(i[u+3]-l)*p;var g=c+(i[u+4]-c)*p;if(r<1){s.r+=(d-s.r)*r;s.g+=(v-s.g)*r;s.b+=(m-s.b)*r;s.a+=(g-s.a)*r}else{s.r=d;s.g=v;s.b=m;s.a=g}}};n.AttachmentTimeline=function(e){this.curves=new n.Curves(e);this.frames=[];this.frames.length=e;this.attachmentNames=[];this.attachmentNames.length=e};n.AttachmentTimeline.prototype={slotIndex:0,getFrameCount:function(){return this.frames.length},setFrame:function(e,t,n){this.frames[e]=t;this.attachmentNames[e]=n},apply:function(e,t,r){var i=this.frames;if(t<i[0])return;var s;if(t>=i[i.length-1])s=i.length-1;else s=n.binarySearch(i,t,1)-1;var o=this.attachmentNames[s];e.slots[this.slotIndex].setAttachment(!o?null:e.getAttachmentBySlotIndex(this.slotIndex,o))}};n.SkeletonData=function(){this.bones=[];this.slots=[];this.skins=[];this.animations=[]};n.SkeletonData.prototype={defaultSkin:null,findBone:function(e){var t=this.bones;for(var n=0,r=t.length;n<r;n++)if(t[n].name==e)return t[n];return null},findBoneIndex:function(e){var t=this.bones;for(var n=0,r=t.length;n<r;n++)if(t[n].name==e)return n;return-1},findSlot:function(e){var t=this.slots;for(var n=0,r=t.length;n<r;n++){if(t[n].name==e)return slot[n]}return null},findSlotIndex:function(e){var t=this.slots;for(var n=0,r=t.length;n<r;n++)if(t[n].name==e)return n;return-1},findSkin:function(e){var t=this.skins;for(var n=0,r=t.length;n<r;n++)if(t[n].name==e)return t[n];return null},findAnimation:function(e){var t=this.animations;for(var n=0,r=t.length;n<r;n++)if(t[n].name==e)return t[n];return null}};n.Skeleton=function(e){this.data=e;this.bones=[];for(var t=0,r=e.bones.length;t<r;t++){var i=e.bones[t];var s=!i.parent?null:this.bones[e.bones.indexOf(i.parent)];this.bones.push(new n.Bone(i,s))}this.slots=[];this.drawOrder=[];for(t=0,r=e.slots.length;t<r;t++){var o=e.slots[t];var u=this.bones[e.bones.indexOf(o.boneData)];var a=new n.Slot(o,this,u);this.slots.push(a);this.drawOrder.push(a)}};n.Skeleton.prototype={x:0,y:0,skin:null,r:1,g:1,b:1,a:1,time:0,flipX:false,flipY:false,updateWorldTransform:function(){var e=this.flipX;var t=this.flipY;var n=this.bones;for(var r=0,i=n.length;r<i;r++)n[r].updateWorldTransform(e,t)},setToSetupPose:function(){this.setBonesToSetupPose();this.setSlotsToSetupPose()},setBonesToSetupPose:function(){var e=this.bones;for(var t=0,n=e.length;t<n;t++)e[t].setToSetupPose()},setSlotsToSetupPose:function(){var e=this.slots;for(var t=0,n=e.length;t<n;t++)e[t].setToSetupPose(t)},getRootBone:function(){return this.bones.length?this.bones[0]:null},findBone:function(e){var t=this.bones;for(var n=0,r=t.length;n<r;n++)if(t[n].data.name==e)return t[n];return null},findBoneIndex:function(e){var t=this.bones;for(var n=0,r=t.length;n<r;n++)if(t[n].data.name==e)return n;return-1},findSlot:function(e){var t=this.slots;for(var n=0,r=t.length;n<r;n++)if(t[n].data.name==e)return t[n];return null},findSlotIndex:function(e){var t=this.slots;for(var n=0,r=t.length;n<r;n++)if(t[n].data.name==e)return n;return-1},setSkinByName:function(e){var t=this.data.findSkin(e);if(!t)throw"Skin not found: "+e;this.setSkin(t)},setSkin:function(e){if(this.skin&&e)e._attachAll(this,this.skin);this.skin=e},getAttachmentBySlotName:function(e,t){return this.getAttachmentBySlotIndex(this.data.findSlotIndex(e),t)},getAttachmentBySlotIndex:function(e,t){if(this.skin){var n=this.skin.getAttachment(e,t);if(n)return n}if(this.data.defaultSkin)return this.data.defaultSkin.getAttachment(e,t);return null},setAttachment:function(e,t){var n=this.slots;for(var r=0,i=n.size;r<i;r++){var s=n[r];if(s.data.name==e){var o=null;if(t){o=this.getAttachment(r,t);if(o==null)throw"Attachment not found: "+t+", for slot: "+e}s.setAttachment(o);return}}throw"Slot not found: "+e},update:function(e){time+=e}};n.AttachmentType={region:0};n.RegionAttachment=function(){this.offset=[];this.offset.length=8;this.uvs=[];this.uvs.length=8};n.RegionAttachment.prototype={x:0,y:0,rotation:0,scaleX:1,scaleY:1,width:0,height:0,rendererObject:null,regionOffsetX:0,regionOffsetY:0,regionWidth:0,regionHeight:0,regionOriginalWidth:0,regionOriginalHeight:0,setUVs:function(e,t,n,r,i){var s=this.uvs;if(i){s[2]=e;s[3]=r;s[4]=e;s[5]=t;s[6]=n;s[7]=t;s[0]=n;s[1]=r}else{s[0]=e;s[1]=r;s[2]=e;s[3]=t;s[4]=n;s[5]=t;s[6]=n;s[7]=r}},updateOffset:function(){var e=this.width/this.regionOriginalWidth*this.scaleX;var t=this.height/this.regionOriginalHeight*this.scaleY;var n=-this.width/2*this.scaleX+this.regionOffsetX*e;var r=-this.height/2*this.scaleY+this.regionOffsetY*t;var i=n+this.regionWidth*e;var s=r+this.regionHeight*t;var o=this.rotation*Math.PI/180;var u=Math.cos(o);var a=Math.sin(o);var f=n*u+this.x;var l=n*a;var c=r*u+this.y;var h=r*a;var p=i*u+this.x;var d=i*a;var v=s*u+this.y;var m=s*a;var g=this.offset;g[0]=f-h;g[1]=c+l;g[2]=f-m;g[3]=v+l;g[4]=p-m;g[5]=v+d;g[6]=p-h;g[7]=c+d},computeVertices:function(e,t,n,r){e+=n.worldX;t+=n.worldY;var i=n.m00;var s=n.m01;var o=n.m10;var u=n.m11;var a=this.offset;r[0]=a[0]*i+a[1]*s+e;r[1]=a[0]*o+a[1]*u+t;r[2]=a[2]*i+a[3]*s+e;r[3]=a[2]*o+a[3]*u+t;r[4]=a[4]*i+a[5]*s+e;r[5]=a[4]*o+a[5]*u+t;r[6]=a[6]*i+a[7]*s+e;r[7]=a[6]*o+a[7]*u+t}};n.AnimationStateData=function(e){this.skeletonData=e;this.animationToMixTime={}};n.AnimationStateData.prototype={defaultMix:0,setMixByName:function(e,t,n){var r=this.skeletonData.findAnimation(e);if(!r)throw"Animation not found: "+e;var i=this.skeletonData.findAnimation(t);if(!i)throw"Animation not found: "+t;this.setMix(r,i,n)},setMix:function(e,t,n){this.animationToMixTime[e.name+":"+t.name]=n},getMix:function(e,t){var n=this.animationToMixTime[e.name+":"+t.name];return n?n:this.defaultMix}};n.AnimationState=function(e){this.data=e;this.queue=[]};n.AnimationState.prototype={animationSpeed:1,current:null,previous:null,currentTime:0,previousTime:0,currentLoop:false,previousLoop:false,mixTime:0,mixDuration:0,update:function(e){this.currentTime+=e*this.animationSpeed;this.previousTime+=e;this.mixTime+=e;if(this.queue.length>0){var t=this.queue[0];if(this.currentTime>=t.delay){this._setAnimation(t.animation,t.loop);this.queue.shift()}}},apply:function(e){if(!this.current)return;if(this.previous){this.previous.apply(e,this.previousTime,this.previousLoop);var t=this.mixTime/this.mixDuration;if(t>=1){t=1;this.previous=null}this.current.mix(e,this.currentTime,this.currentLoop,t)}else this.current.apply(e,this.currentTime,this.currentLoop)},clearAnimation:function(){this.previous=null;this.current=null;this.queue.length=0},_setAnimation:function(e,t){this.previous=null;if(e&&this.current){this.mixDuration=this.data.getMix(this.current,e);if(this.mixDuration>0){this.mixTime=0;this.previous=this.current;this.previousTime=this.currentTime;this.previousLoop=this.currentLoop}}this.current=e;this.currentLoop=t;this.currentTime=0},setAnimationByName:function(e,t){var n=this.data.skeletonData.findAnimation(e);if(!n)throw"Animation not found: "+e;this.setAnimation(n,t)},setAnimation:function(e,t){this.queue.length=0;this._setAnimation(e,t)},addAnimationByName:function(e,t,n){var r=this.data.skeletonData.findAnimation(e);if(!r)throw"Animation not found: "+e;this.addAnimation(r,t,n)},addAnimation:function(e,t,n){var r={};r.animation=e;r.loop=t;if(!n||n<=0){var i=this.queue.length?this.queue[this.queue.length-1].animation:this.current;if(i!=null)n=i.duration-this.data.getMix(i,e)+(n||0);else n=0}r.delay=n;this.queue.push(r)},isComplete:function(){return!this.current||this.currentTime>=this.current.duration}};n.SkeletonJson=function(e){this.attachmentLoader=e};n.SkeletonJson.prototype={scale:1,readSkeletonData:function(e){var t=new n.SkeletonData,r;var i=e["bones"];for(var s=0,o=i.length;s<o;s++){var u=i[s];var a=null;if(u["parent"]){a=t.findBone(u["parent"]);if(!a)throw"Parent bone not found: "+u["parent"]}r=new n.BoneData(u["name"],a);r.length=(u["length"]||0)*this.scale;r.x=(u["x"]||0)*this.scale;r.y=(u["y"]||0)*this.scale;r.rotation=u["rotation"]||0;r.scaleX=u["scaleX"]||1;r.scaleY=u["scaleY"]||1;t.bones.push(r)}var f=e["slots"];for(s=0,o=f.length;s<o;s++){var l=f[s];r=t.findBone(l["bone"]);if(!r)throw"Slot bone not found: "+l["bone"];var c=new n.SlotData(l["name"],r);var h=l["color"];if(h){c.r=n.SkeletonJson.toColor(h,0);c.g=n.SkeletonJson.toColor(h,1);c.b=n.SkeletonJson.toColor(h,2);c.a=n.SkeletonJson.toColor(h,3)}c.attachmentName=l["attachment"];t.slots.push(c)}var p=e["skins"];for(var d in p){if(!p.hasOwnProperty(d))continue;var v=p[d];var m=new n.Skin(d);for(var g in v){if(!v.hasOwnProperty(g))continue;var y=t.findSlotIndex(g);var b=v[g];for(var w in b){if(!b.hasOwnProperty(w))continue;var E=this.readAttachment(m,w,b[w]);if(E!=null)m.addAttachment(y,w,E)}}t.skins.push(m);if(m.name=="default")t.defaultSkin=m}var S=e["animations"];for(var x in S){if(!S.hasOwnProperty(x))continue;this.readAnimation(x,S[x],t)}return t},readAttachment:function(e,t,r){t=r["name"]||t;var i=n.AttachmentType[r["type"]||"region"];if(i==n.AttachmentType.region){var s=new n.RegionAttachment;s.x=(r["x"]||0)*this.scale;s.y=(r["y"]||0)*this.scale;s.scaleX=r["scaleX"]||1;s.scaleY=r["scaleY"]||1;s.rotation=r["rotation"]||0;s.width=(r["width"]||32)*this.scale;s.height=(r["height"]||32)*this.scale;s.updateOffset();s.rendererObject={};s.rendererObject.name=t;s.rendererObject.scale={};s.rendererObject.scale.x=s.scaleX;s.rendererObject.scale.y=s.scaleY;s.rendererObject.rotation=-s.rotation*Math.PI/180;return s}throw"Unknown attachment type: "+i},readAnimation:function(e,t,r){var i=[];var s=0;var o,u,a,f,l,c,h;var p=t["bones"];for(var d in p){if(!p.hasOwnProperty(d))continue;var v=r.findBoneIndex(d);if(v==-1)throw"Bone not found: "+d;var m=p[d];for(a in m){if(!m.hasOwnProperty(a))continue;l=m[a];if(a=="rotate"){u=new n.RotateTimeline(l.length);u.boneIndex=v;o=0;for(c=0,h=l.length;c<h;c++){f=l[c];u.setFrame(o,f["time"],f["angle"]);n.SkeletonJson.readCurve(u,o,f);o++}i.push(u);s=Math.max(s,u.frames[u.getFrameCount()*2-2])}else if(a=="translate"||a=="scale"){var g=1;if(a=="scale")u=new n.ScaleTimeline(l.length);else{u=new n.TranslateTimeline(l.length);g=this.scale}u.boneIndex=v;o=0;for(c=0,h=l.length;c<h;c++){f=l[c];var y=(f["x"]||0)*g;var b=(f["y"]||0)*g;u.setFrame(o,f["time"],y,b);n.SkeletonJson.readCurve(u,o,f);o++}i.push(u);s=Math.max(s,u.frames[u.getFrameCount()*3-3])}else throw"Invalid timeline type for a bone: "+a+" ("+d+")"}}var w=t["slots"];for(var E in w){if(!w.hasOwnProperty(E))continue;var S=w[E];var x=r.findSlotIndex(E);for(a in S){if(!S.hasOwnProperty(a))continue;l=S[a];if(a=="color"){u=new n.ColorTimeline(l.length);u.slotIndex=x;o=0;for(c=0,h=l.length;c<h;c++){f=l[c];var T=f["color"];var N=n.SkeletonJson.toColor(T,0);var C=n.SkeletonJson.toColor(T,1);var k=n.SkeletonJson.toColor(T,2);var L=n.SkeletonJson.toColor(T,3);u.setFrame(o,f["time"],N,C,k,L);n.SkeletonJson.readCurve(u,o,f);o++}i.push(u);s=Math.max(s,u.frames[u.getFrameCount()*5-5])}else if(a=="attachment"){u=new n.AttachmentTimeline(l.length);u.slotIndex=x;o=0;for(c=0,h=l.length;c<h;c++){f=l[c];u.setFrame(o++,f["time"],f["name"])}i.push(u);s=Math.max(s,u.frames[u.getFrameCount()-1])}else throw"Invalid timeline type for a slot: "+a+" ("+E+")"}}r.animations.push(new n.Animation(e,i,s))}};n.SkeletonJson.readCurve=function(e,t,n){var r=n["curve"];if(!r)return;if(r=="stepped")e.curves.setStepped(t);else if(r instanceof Array)e.curves.setCurve(t,r[0],r[1],r[2],r[3])};n.SkeletonJson.toColor=function(e,t){if(e.length!=8)throw"Color hexidecimal length must be 8, recieved: "+e;return parseInt(e.substr(t*2,2),16)/255};n.Atlas=function(e,t){this.textureLoader=t;this.pages=[];this.regions=[];var r=new n.AtlasReader(e);var i=[];i.length=4;var s=null;while(true){var o=r.readLine();if(o==null)break;o=r.trim(o);if(!o.length)s=null;else if(!s){s=new n.AtlasPage;s.name=o;s.format=n.Atlas.Format[r.readValue()];r.readTuple(i);s.minFilter=n.Atlas.TextureFilter[i[0]];s.magFilter=n.Atlas.TextureFilter[i[1]];var u=r.readValue();s.uWrap=n.Atlas.TextureWrap.clampToEdge;s.vWrap=n.Atlas.TextureWrap.clampToEdge;if(u=="x")s.uWrap=n.Atlas.TextureWrap.repeat;else if(u=="y")s.vWrap=n.Atlas.TextureWrap.repeat;else if(u=="xy")s.uWrap=s.vWrap=n.Atlas.TextureWrap.repeat;t.load(s,o);this.pages.push(s)}else{var a=new n.AtlasRegion;a.name=o;a.page=s;a.rotate=r.readValue()=="true";r.readTuple(i);var f=parseInt(i[0],10);var l=parseInt(i[1],10);r.readTuple(i);var c=parseInt(i[0],10);var h=parseInt(i[1],10);a.u=f/s.width;a.v=l/s.height;if(a.rotate){a.u2=(f+h)/s.width;a.v2=(l+c)/s.height}else{a.u2=(f+c)/s.width;a.v2=(l+h)/s.height}a.x=f;a.y=l;a.width=Math.abs(c);a.height=Math.abs(h);if(r.readTuple(i)==4){a.splits=[parseInt(i[0],10),parseInt(i[1],10),parseInt(i[2],10),parseInt(i[3],10)];if(r.readTuple(i)==4){a.pads=[parseInt(i[0],10),parseInt(i[1],10),parseInt(i[2],10),parseInt(i[3],10)];r.readTuple(i)}}a.originalWidth=parseInt(i[0],10);a.originalHeight=parseInt(i[1],10);r.readTuple(i);a.offsetX=parseInt(i[0],10);a.offsetY=parseInt(i[1],10);a.index=parseInt(r.readValue(),10);this.regions.push(a)}}};n.Atlas.prototype={findRegion:function(e){var t=this.regions;for(var n=0,r=t.length;n<r;n++)if(t[n].name==e)return t[n];return null},dispose:function(){var e=this.pages;for(var t=0,n=e.length;t<n;t++)this.textureLoader.unload(e[t].rendererObject)},updateUVs:function(e){var t=this.regions;for(var n=0,r=t.length;n<r;n++){var i=t[n];if(i.page!=e)continue;i.u=i.x/e.width;i.v=i.y/e.height;if(i.rotate){i.u2=(i.x+i.height)/e.width;i.v2=(i.y+i.width)/e.height}else{i.u2=(i.x+i.width)/e.width;i.v2=(i.y+i.height)/e.height}}}};n.Atlas.Format={alpha:0,intensity:1,luminanceAlpha:2,rgb565:3,rgba4444:4,rgb888:5,rgba8888:6};n.Atlas.TextureFilter={nearest:0,linear:1,mipMap:2,mipMapNearestNearest:3,mipMapLinearNearest:4,mipMapNearestLinear:5,mipMapLinearLinear:6};n.Atlas.TextureWrap={mirroredRepeat:0,clampToEdge:1,repeat:2};n.AtlasPage=function(){};n.AtlasPage.prototype={name:null,format:null,minFilter:null,magFilter:null,uWrap:null,vWrap:null,rendererObject:null,width:0,height:0};n.AtlasRegion=function(){};n.AtlasRegion.prototype={page:null,name:null,x:0,y:0,width:0,height:0,u:0,v:0,u2:0,v2:0,offsetX:0,offsetY:0,originalWidth:0,originalHeight:0,index:0,rotate:false,splits:null,pads:null};n.AtlasReader=function(e){this.lines=e.split(/\r\n|\r|\n/)};n.AtlasReader.prototype={index:0,trim:function(e){return e.replace(/^\s+|\s+$/g,"")},readLine:function(){if(this.index>=this.lines.length)return null;return this.lines[this.index++]},readValue:function(){var e=this.readLine();var t=e.indexOf(":");if(t==-1)throw"Invalid line: "+e;return this.trim(e.substring(t+1))},readTuple:function(e){var t=this.readLine();var n=t.indexOf(":");if(n==-1)throw"Invalid line: "+t;var r=0,i=n+1;for(;r<3;r++){var s=t.indexOf(",",i);if(s==-1){if(!r)throw"Invalid line: "+t;break}e[r]=this.trim(t.substr(i,s-i));i=s+1}e[r]=this.trim(t.substring(i));return r+1}};n.AtlasAttachmentLoader=function(e){this.atlas=e};n.AtlasAttachmentLoader.prototype={newAttachment:function(e,t,r){switch(t){case n.AttachmentType.region:var i=this.atlas.findRegion(r);if(!i)throw"Region not found in atlas: "+r+" ("+t+")";var s=new n.RegionAttachment(r);s.rendererObject=i;s.setUVs(i.u,i.v,i.u2,i.v2,i.rotate);s.regionOffsetX=i.offsetX;s.regionOffsetY=i.offsetY;s.regionWidth=i.width;s.regionHeight=i.height;s.regionOriginalWidth=i.originalWidth;s.regionOriginalHeight=i.originalHeight;return s}throw"Unknown attachment type: "+t}};n.Bone.yDown=true;t.AnimCache={};t.Spine=function(e){t.DisplayObjectContainer.call(this);this.spineData=t.AnimCache[e];if(!this.spineData){throw new Error("Spine data must be preloaded using PIXI.SpineLoader or PIXI.AssetLoader: "+e)}this.skeleton=new n.Skeleton(this.spineData);this.skeleton.updateWorldTransform();this.stateData=new n.AnimationStateData(this.spineData);this.state=new n.AnimationState(this.stateData);this.slotContainers=[];for(var r=0,i=this.skeleton.drawOrder.length;r<i;r++){var s=this.skeleton.drawOrder[r];var o=s.attachment;var u=new t.DisplayObjectContainer;this.slotContainers.push(u);this.addChild(u);if(!(o instanceof n.RegionAttachment)){continue}var a=o.rendererObject.name;var f=this.createSprite(s,o.rendererObject);s.currentSprite=f;s.currentSpriteName=a;u.addChild(f)}};t.Spine.prototype=Object.create(t.DisplayObjectContainer.prototype);t.Spine.prototype.constructor=t.Spine;t.Spine.prototype.updateTransform=function(){this.lastTime=this.lastTime||Date.now();var e=(Date.now()-this.lastTime)*.001;this.lastTime=Date.now();this.state.update(e);this.state.apply(this.skeleton);this.skeleton.updateWorldTransform();var r=this.skeleton.drawOrder;for(var i=0,s=r.length;i<s;i++){var o=r[i];var u=o.attachment;var a=this.slotContainers[i];if(!(u instanceof n.RegionAttachment)){a.visible=false;continue}if(u.rendererObject){if(!o.currentSpriteName||o.currentSpriteName!=u.name){var f=u.rendererObject.name;if(o.currentSprite!==undefined){o.currentSprite.visible=false}o.sprites=o.sprites||{};if(o.sprites[f]!==undefined){o.sprites[f].visible=true}else{var l=this.createSprite(o,u.rendererObject);a.addChild(l)}o.currentSprite=o.sprites[f];o.currentSpriteName=f}}a.visible=true;var c=o.bone;a.position.x=c.worldX+u.x*c.m00+u.y*c.m01;a.position.y=c.worldY+u.x*c.m10+u.y*c.m11;a.scale.x=c.worldScaleX;a.scale.y=c.worldScaleY;a.rotation=-(o.bone.worldRotation*Math.PI/180);a.alpha=o.a;o.currentSprite.tint=t.rgb2hex([o.r,o.g,o.b])}t.DisplayObjectContainer.prototype.updateTransform.call(this)};t.Spine.prototype.createSprite=function(e,n){var r=t.TextureCache[n.name]?n.name:n.name+".png";var i=new t.Sprite(t.Texture.fromFrame(r));i.scale=n.scale;i.rotation=n.rotation;i.anchor.x=i.anchor.y=.5;e.sprites=e.sprites||{};e.sprites[n.name]=i;return i};t.BaseTextureCache={};t.texturesToUpdate=[];t.texturesToDestroy=[];t.BaseTextureCacheIdGenerator=0;t.BaseTexture=function(e,n){t.EventTarget.call(this);this.resolution=1;this.width=100;this.height=100;this.scaleMode=n||t.scaleModes.DEFAULT;this.hasLoaded=false;this.source=e;this.id=t.BaseTextureCacheIdGenerator++;this.premultipliedAlpha=true;this._glTextures=[];this._dirty=[];if(!e)return;if((this.source.complete||this.source.getContext)&&this.source.width&&this.source.height){this.hasLoaded=true;this.width=this.source[this.source instanceof HTMLImageElement?"naturalWidth":"width"];this.height=this.source[this.source instanceof HTMLImageElement?"naturalHeight":"height"];t.texturesToUpdate.push(this)}else{var r=this;this.source.onload=function(){r.hasLoaded=true;r.width=r.source[r.source instanceof HTMLImageElement?"naturalWidth":"width"];r.height=r.source[r.source instanceof HTMLImageElement?"naturalHeight":"height"];for(var e=0;e<r._glTextures.length;e++){r._dirty[e]=true}r.dispatchEvent({type:"loaded",content:r})};this.source.onerror=function(){r.dispatchEvent({type:"error",content:r})}}this.imageUrl=null;this._powerOf2=false};t.BaseTexture.prototype.constructor=t.BaseTexture;t.BaseTexture.prototype.destroy=function(){if(this.imageUrl){delete t.BaseTextureCache[this.imageUrl];delete t.TextureCache[this.imageUrl];this.imageUrl=null;this.source.src=""}else if(this.source&&this.source._pixiId){delete t.BaseTextureCache[this.source._pixiId]}this.source=null;t.texturesToDestroy.push(this)};t.BaseTexture.prototype.updateSourceImage=function(e){this.hasLoaded=false;this.source.src=null;this.source.src=e};t.BaseTexture.fromImage=function(e,n,r){var i=t.BaseTextureCache[e];if(n===undefined&&e.indexOf("data:")===-1)n=true;if(!i){var s=new Image;if(n){s.crossOrigin=""}s.src=e;i=new t.BaseTexture(s,r);i.imageUrl=e;t.BaseTextureCache[e]=i;if(e.indexOf(t.RETINA_PREFIX+".")!==-1){i.resolution=2}}return i};t.BaseTexture.fromCanvas=function(e,n){if(!e._pixiId){e._pixiId="canvas_"+t.TextureCacheIdGenerator++}var r=t.BaseTextureCache[e._pixiId];if(!r){r=new t.BaseTexture(e,n);t.BaseTextureCache[e._pixiId]=r}return r};t.TextureCache={};t.FrameCache={};t.TextureCacheIdGenerator=0;t.Texture=function(e,n){t.EventTarget.call(this);this.noFrame=false;if(!n){this.noFrame=true;n=new t.Rectangle(0,0,1,1)}if(e instanceof t.Texture){e=e.baseTexture}this.baseTexture=e;this.frame=n;this.trim=null;this.valid=false;this._uvs=null;this.width=0;this.height=0;this.crop=new t.Rectangle(0,0,1,1);if(e.hasLoaded){if(this.noFrame)n=new t.Rectangle(0,0,e.width,e.height);this.setFrame(n)}else{e.addEventListener("loaded",this.onBaseTextureLoaded.bind(this))}};t.Texture.prototype.constructor=t.Texture;t.Texture.prototype.onBaseTextureLoaded=function(){var e=this.baseTexture;e.removeEventListener("loaded",this.onLoaded);if(this.noFrame)this.frame=new t.Rectangle(0,0,e.width,e.height);this.setFrame(this.frame);this.dispatchEvent({type:"update",content:this})};t.Texture.prototype.destroy=function(e){if(e)this.baseTexture.destroy();this.valid=false};t.Texture.prototype.setFrame=function(e){this.noFrame=false;this.frame=e;this.width=e.width;this.height=e.height;this.crop.x=e.x;this.crop.y=e.y;this.crop.width=e.width;this.crop.height=e.height;if(!this.trim&&(e.x+e.width>this.baseTexture.width||e.y+e.height>this.baseTexture.height)){throw new Error("Texture Error: frame does not fit inside the base Texture dimensions "+this)}this.valid=e&&e.width&&e.height&&this.baseTexture.source&&this.baseTexture.hasLoaded;if(this.trim){this.width=this.trim.width;this.height=this.trim.height;this.frame.width=this.trim.width;this.frame.height=this.trim.height}if(this.valid)t.Texture.frameUpdates.push(this)};t.Texture.prototype._updateWebGLuvs=function(){if(!this._uvs)this._uvs=new t.TextureUvs;var e=this.crop;var n=this.baseTexture.width;var r=this.baseTexture.height;this._uvs.x0=e.x/n;this._uvs.y0=e.y/r;this._uvs.x1=(e.x+e.width)/n;this._uvs.y1=e.y/r;this._uvs.x2=(e.x+e.width)/n;this._uvs.y2=(e.y+e.height)/r;this._uvs.x3=e.x/n;this._uvs.y3=(e.y+e.height)/r};t.Texture.fromImage=function(e,n,r){var i=t.TextureCache[e];if(!i){i=new t.Texture(t.BaseTexture.fromImage(e,n,r));t.TextureCache[e]=i}return i};t.Texture.fromFrame=function(e){var n=t.TextureCache[e];if(!n)throw new Error('The frameId "'+e+'" does not exist in the texture cache ');return n};t.Texture.fromCanvas=function(e,n){var r=t.BaseTexture.fromCanvas(e,n);return new t.Texture(r)};t.Texture.addTextureToCache=function(e,n){t.TextureCache[n]=e};t.Texture.removeTextureFromCache=function(e){var n=t.TextureCache[e];delete t.TextureCache[e];delete t.BaseTextureCache[e];return n};t.Texture.frameUpdates=[];t.TextureUvs=function(){this.x0=0;this.y0=0;this.x1=0;this.y1=0;this.x2=0;this.y2=0;this.x3=0;this.y3=0};t.RenderTexture=function(e,n,r,i,s){t.EventTarget.call(this);this.width=e||100;this.height=n||100;this.resolution=s||1;this.frame=new t.Rectangle(0,0,this.width*this.resolution,this.height*this.resolution);this.crop=new t.Rectangle(0,0,this.width*this.resolution,this.height*this.resolution);this.baseTexture=new t.BaseTexture;this.baseTexture.width=this.width*this.resolution;this.baseTexture.height=this.height*this.resolution;this.baseTexture._glTextures=[];this.baseTexture.resolution=this.resolution;this.baseTexture.scaleMode=i||t.scaleModes.DEFAULT;this.baseTexture.hasLoaded=true;this.renderer=r||t.defaultRenderer;if(this.renderer.type===t.WEBGL_RENDERER){var o=this.renderer.gl;this.textureBuffer=new t.FilterTexture(o,this.width*this.resolution,this.height*this.resolution,this.baseTexture.scaleMode);this.baseTexture._glTextures[o.id]=this.textureBuffer.texture;this.render=this.renderWebGL;this.projection=new t.Point(this.width*.5,-this.height*.5)}else{this.render=this.renderCanvas;this.textureBuffer=new t.CanvasBuffer(this.width*this.resolution,this.height*this.resolution);this.baseTexture.source=this.textureBuffer.canvas}this.valid=true;t.Texture.frameUpdates.push(this)};t.RenderTexture.prototype=Object.create(t.Texture.prototype);t.RenderTexture.prototype.constructor=t.RenderTexture;t.RenderTexture.prototype.resize=function(e,n,r){if(e===this.width&&n===this.height){return}this.valid=e>0&&n>0;this.width=this.frame.width=this.crop.width=e;this.height=this.frame.height=this.crop.height=n;if(r){this.baseTexture.width=this.width;this.baseTexture.height=this.height}if(this.renderer.type===t.WEBGL_RENDERER){this.projection.x=this.width/2;this.projection.y=-this.height/2}if(!this.valid)return;this.textureBuffer.resize(this.width*this.resolution,this.height*this.resolution)};t.RenderTexture.prototype.clear=function(){if(!this.valid)return;if(this.renderer.type===t.WEBGL_RENDERER){this.renderer.gl.bindFramebuffer(this.renderer.gl.FRAMEBUFFER,this.textureBuffer.frameBuffer)}this.textureBuffer.clear()};t.RenderTexture.prototype.renderWebGL=function(e,n,r){if(!this.valid)return;var i=this.renderer.gl;i.colorMask(true,true,true,true);i.viewport(0,0,this.width*this.resolution,this.height*this.resolution);i.bindFramebuffer(i.FRAMEBUFFER,this.textureBuffer.frameBuffer);if(r)this.textureBuffer.clear();var s=e.children;var o=e.worldTransform;e.worldTransform=t.RenderTexture.tempMatrix;e.worldAlpha=1;e.worldTransform.d=-1;e.worldTransform.ty=this.projection.y*-2;if(n){e.worldTransform.tx=n.x;e.worldTransform.ty-=n.y}for(var u=0,a=s.length;u<a;u++){s[u].updateTransform()}t.WebGLRenderer.updateTextures();this.renderer.spriteBatch.dirty=true;this.renderer.renderDisplayObject(e,this.projection,this.textureBuffer.frameBuffer);e.worldTransform=o;this.renderer.spriteBatch.dirty=true};t.RenderTexture.prototype.renderCanvas=function(e,n,r){if(!this.valid)return;var i=e.children;var s=e.worldTransform;e.worldTransform=t.RenderTexture.tempMatrix;if(n){e.worldTransform.tx=n.x;e.worldTransform.ty=n.y}else{e.worldTransform.tx=0;e.worldTransform.ty=0}for(var o=0,u=i.length;o<u;o++){i[o].updateTransform()}if(r)this.textureBuffer.clear();var a=this.textureBuffer.context;var f=this.renderer.resolution;this.renderer.resolution=this.resolution;this.renderer.renderDisplayObject(e,a);this.renderer.resolution=f;a.setTransform(1,0,0,1,0,0);e.worldTransform=s};t.RenderTexture.prototype.getImage=function(){var e=new Image;e.src=this.getBase64();return e};t.RenderTexture.prototype.getBase64=function(){return this.getCanvas().toDataURL()};t.RenderTexture.prototype.getCanvas=function(){if(this.renderer.type===t.WEBGL_RENDERER){var e=this.renderer.gl;var n=this.textureBuffer.width;var r=this.textureBuffer.height;var i=new Uint8Array(4*n*r);e.bindFramebuffer(e.FRAMEBUFFER,this.textureBuffer.frameBuffer);e.readPixels(0,0,n,r,e.RGBA,e.UNSIGNED_BYTE,i);e.bindFramebuffer(e.FRAMEBUFFER,null);var s=new t.CanvasBuffer(n,r);var o=s.context.getImageData(0,0,n,r);var u=o.data;for(var a=0;a<i.length;a+=4){var f=i[a+3];u[a]=i[a]*f;u[a+1]=i[a+1]*f;u[a+2]=i[a+2]*f;u[a+3]=f}s.context.putImageData(o,0,0);return s.canvas}else{return this.textureBuffer.canvas}};t.RenderTexture.tempMatrix=new t.Matrix;t.AssetLoader=function(e,n){t.EventTarget.call(this);this.assetURLs=e;this.crossorigin=n;this.loadersByType={jpg:t.ImageLoader,jpeg:t.ImageLoader,png:t.ImageLoader,gif:t.ImageLoader,webp:t.ImageLoader,json:t.JsonLoader,atlas:t.AtlasLoader,anim:t.SpineLoader,xml:t.BitmapFontLoader,fnt:t.BitmapFontLoader}};t.AssetLoader.prototype.constructor=t.AssetLoader;t.AssetLoader.prototype._getDataType=function(e){var t="data:";var n=e.slice(0,t.length).toLowerCase();if(n===t){var r=e.slice(t.length);var i=r.indexOf(",");if(i===-1)return null;var s=r.slice(0,i).split(";")[0];if(!s||s.toLowerCase()==="text/plain")return"txt";return s.split("/").pop().toLowerCase()}return null};t.AssetLoader.prototype.load=function(){function t(t){e.onAssetLoaded(t.content)}var e=this;this.loadCount=this.assetURLs.length;for(var n=0;n<this.assetURLs.length;n++){var r=this.assetURLs[n];var i=this._getDataType(r);if(!i)i=r.split("?").shift().split(".").pop().toLowerCase();var s=this.loadersByType[i];if(!s)throw new Error(i+" is an unsupported file type");var o=new s(r,this.crossorigin);o.addEventListener("loaded",t);o.load()}};t.AssetLoader.prototype.onAssetLoaded=function(e){this.loadCount--;this.dispatchEvent({type:"onProgress",content:this,loader:e});if(this.onProgress)this.onProgress(e);if(!this.loadCount){this.dispatchEvent({type:"onComplete",content:this});if(this.onComplete)this.onComplete()}};t.JsonLoader=function(e,n){t.EventTarget.call(this);this.url=e;this.crossorigin=n;this.baseUrl=e.replace(/[^\/]*$/,"");this.loaded=false};t.JsonLoader.prototype.constructor=t.JsonLoader;t.JsonLoader.prototype.load=function(){if(window.XDomainRequest&&this.crossorigin){this.ajaxRequest=new window.XDomainRequest;this.ajaxRequest.timeout=3e3;this.ajaxRequest.onerror=this.onError.bind(this);this.ajaxRequest.ontimeout=this.onError.bind(this);this.ajaxRequest.onprogress=function(){}}else if(window.XMLHttpRequest){this.ajaxRequest=new window.XMLHttpRequest}else{this.ajaxRequest=new window.ActiveXObject("Microsoft.XMLHTTP")}this.ajaxRequest.onload=this.onJSONLoaded.bind(this);this.ajaxRequest.open("GET",this.url,true);this.ajaxRequest.send()};t.JsonLoader.prototype.onJSONLoaded=function(){if(!this.ajaxRequest.responseText){this.onError();return}this.json=JSON.parse(this.ajaxRequest.responseText);if(this.json.frames){var e=this.baseUrl+this.json.meta.image;var r=new t.ImageLoader(e,this.crossorigin);var i=this.json.frames;this.texture=r.texture.baseTexture;r.addEventListener("loaded",this.onLoaded.bind(this));for(var s in i){var o=i[s].frame;if(o){t.TextureCache[s]=new t.Texture(this.texture,{x:o.x,y:o.y,width:o.w,height:o.h});t.TextureCache[s].crop=new t.Rectangle(o.x,o.y,o.w,o.h);if(i[s].trimmed){var u=i[s].sourceSize;var a=i[s].spriteSourceSize;t.TextureCache[s].trim=new t.Rectangle(a.x,a.y,u.w,u.h)}}}r.load()}else if(this.json.bones){var f=new n.SkeletonJson;var l=f.readSkeletonData(this.json);t.AnimCache[this.url]=l;this.onLoaded()}else{this.onLoaded()}};t.JsonLoader.prototype.onLoaded=function(){this.loaded=true;this.dispatchEvent({type:"loaded",content:this})};t.JsonLoader.prototype.onError=function(){this.dispatchEvent({type:"error",content:this})};t.AtlasLoader=function(e,n){t.EventTarget.call(this);this.url=e;this.baseUrl=e.replace(/[^\/]*$/,"");this.crossorigin=n;this.loaded=false};t.AtlasLoader.constructor=t.AtlasLoader;t.AtlasLoader.prototype.load=function(){this.ajaxRequest=new t.AjaxRequest;this.ajaxRequest.onreadystatechange=this.onAtlasLoaded.bind(this);this.ajaxRequest.open("GET",this.url,true);if(this.ajaxRequest.overrideMimeType)this.ajaxRequest.overrideMimeType("application/json");this.ajaxRequest.send(null)};t.AtlasLoader.prototype.onAtlasLoaded=function(){if(this.ajaxRequest.readyState===4){if(this.ajaxRequest.status===200||window.location.href.indexOf("http")===-1){this.atlas={meta:{image:[]},frames:[]};var e=this.ajaxRequest.responseText.split(/\r?\n/);var n=-3;var r=0;var i=null;var s=false;var o=0,u=0,a=this.onLoaded.bind(this);for(o=0;o<e.length;o++){e[o]=e[o].replace(/^\s+|\s+$/g,"");if(e[o]===""){s=o+1}if(e[o].length>0){if(s===o){this.atlas.meta.image.push(e[o]);r=this.atlas.meta.image.length-1;this.atlas.frames.push({});n=-3}else if(n>0){if(n%7===1){if(i!=null){this.atlas.frames[r][i.name]=i}i={name:e[o],frame:{}}}else{var f=e[o].split(" ");if(n%7===3){i.frame.x=Number(f[1].replace(",",""));i.frame.y=Number(f[2])}else if(n%7===4){i.frame.w=Number(f[1].replace(",",""));i.frame.h=Number(f[2])}else if(n%7===5){var l={x:0,y:0,w:Number(f[1].replace(",","")),h:Number(f[2])};if(l.w>i.frame.w||l.h>i.frame.h){i.trimmed=true;i.realSize=l}else{i.trimmed=false}}}}n++}}if(i!=null){this.atlas.frames[r][i.name]=i}if(this.atlas.meta.image.length>0){this.images=[];for(u=0;u<this.atlas.meta.image.length;u++){var c=this.baseUrl+this.atlas.meta.image[u];var h=this.atlas.frames[u];this.images.push(new t.ImageLoader(c,this.crossorigin));for(o in h){var p=h[o].frame;if(p){t.TextureCache[o]=new t.Texture(this.images[u].texture.baseTexture,{x:p.x,y:p.y,width:p.w,height:p.h});if(h[o].trimmed){t.TextureCache[o].realSize=h[o].realSize;t.TextureCache[o].trim.x=0;t.TextureCache[o].trim.y=0}}}}this.currentImageId=0;for(u=0;u<this.images.length;u++){this.images[u].addEventListener("loaded",a)}this.images[this.currentImageId].load()}else{this.onLoaded()}}else{this.onError()}}};t.AtlasLoader.prototype.onLoaded=function(){if(this.images.length-1>this.currentImageId){this.currentImageId++;this.images[this.currentImageId].load()}else{this.loaded=true;this.dispatchEvent({type:"loaded",content:this})}};t.AtlasLoader.prototype.onError=function(){this.dispatchEvent({type:"error",content:this})};t.SpriteSheetLoader=function(e,n){t.EventTarget.call(this);this.url=e;this.crossorigin=n;this.baseUrl=e.replace(/[^\/]*$/,"");this.texture=null;this.frames={}};t.SpriteSheetLoader.prototype.constructor=t.SpriteSheetLoader;t.SpriteSheetLoader.prototype.load=function(){var e=this;var n=new t.JsonLoader(this.url,this.crossorigin);n.addEventListener("loaded",function(t){e.json=t.content.json;e.onLoaded()});n.load()};t.SpriteSheetLoader.prototype.onLoaded=function(){this.dispatchEvent({type:"loaded",content:this})};t.ImageLoader=function(e,n){t.EventTarget.call(this);this.texture=t.Texture.fromImage(e,n);this.frames=[]};t.ImageLoader.prototype.constructor=t.ImageLoader;t.ImageLoader.prototype.load=function(){if(!this.texture.baseTexture.hasLoaded){this.texture.baseTexture.addEventListener("loaded",this.onLoaded.bind(this))}else{this.onLoaded()}};t.ImageLoader.prototype.onLoaded=function(){this.dispatchEvent({type:"loaded",content:this})};t.ImageLoader.prototype.loadFramedSpriteSheet=function(e,n,r){this.frames=[];var i=Math.floor(this.texture.width/e);var s=Math.floor(this.texture.height/n);var o=0;for(var u=0;u<s;u++){for(var a=0;a<i;a++,o++){var f=new t.Texture(this.texture.baseTexture,{x:a*e,y:u*n,width:e,height:n});this.frames.push(f);if(r)t.TextureCache[r+"-"+o]=f}}this.load()};t.BitmapFontLoader=function(e,n){t.EventTarget.call(this);this.url=e;this.crossorigin=n;this.baseUrl=e.replace(/[^\/]*$/,"");this.texture=null};t.BitmapFontLoader.prototype.constructor=t.BitmapFontLoader;t.BitmapFontLoader.prototype.load=function(){this.ajaxRequest=new t.AjaxRequest;this.ajaxRequest.onreadystatechange=this.onXMLLoaded.bind(this);this.ajaxRequest.open("GET",this.url,true);if(this.ajaxRequest.overrideMimeType)this.ajaxRequest.overrideMimeType("application/xml");this.ajaxRequest.send(null)};t.BitmapFontLoader.prototype.onXMLLoaded=function(){if(this.ajaxRequest.readyState===4){if(this.ajaxRequest.status===200||window.location.protocol.indexOf("http")===-1){var e=this.ajaxRequest.responseXML;if(!e||/MSIE 9/i.test(navigator.userAgent)||navigator.isCocoonJS){if(typeof window.DOMParser==="function"){var n=new DOMParser;e=n.parseFromString(this.ajaxRequest.responseText,"text/xml")}else{var r=document.createElement("div");r.innerHTML=this.ajaxRequest.responseText;e=r}}var i=this.baseUrl+e.getElementsByTagName("page")[0].getAttribute("file");var s=new t.ImageLoader(i,this.crossorigin);this.texture=s.texture.baseTexture;var o={};var u=e.getElementsByTagName("info")[0];var a=e.getElementsByTagName("common")[0];o.font=u.getAttribute("face");o.size=parseInt(u.getAttribute("size"),10);o.lineHeight=parseInt(a.getAttribute("lineHeight"),10);o.chars={};var f=e.getElementsByTagName("char");for(var l=0;l<f.length;l++){var c=parseInt(f[l].getAttribute("id"),10);var h=new t.Rectangle(parseInt(f[l].getAttribute("x"),10),parseInt(f[l].getAttribute("y"),10),parseInt(f[l].getAttribute("width"),10),parseInt(f[l].getAttribute("height"),10));o.chars[c]={xOffset:parseInt(f[l].getAttribute("xoffset"),10),yOffset:parseInt(f[l].getAttribute("yoffset"),10),xAdvance:parseInt(f[l].getAttribute("xadvance"),10),kerning:{},texture:t.TextureCache[c]=new t.Texture(this.texture,h)}}var p=e.getElementsByTagName("kerning");for(l=0;l<p.length;l++){var d=parseInt(p[l].getAttribute("first"),10);var v=parseInt(p[l].getAttribute("second"),10);var m=parseInt(p[l].getAttribute("amount"),10);o.chars[v].kerning[d]=m}t.BitmapText.fonts[o.font]=o;s.addEventListener("loaded",this.onLoaded.bind(this));s.load()}}};t.BitmapFontLoader.prototype.onLoaded=function(){this.dispatchEvent({type:"loaded",content:this})};t.SpineLoader=function(e,n){t.EventTarget.call(this);this.url=e;this.crossorigin=n;this.loaded=false};t.SpineLoader.prototype.constructor=t.SpineLoader;t.SpineLoader.prototype.load=function(){var e=this;var n=new t.JsonLoader(this.url,this.crossorigin);n.addEventListener("loaded",function(t){e.json=t.content.json;e.onLoaded()});n.load()};t.SpineLoader.prototype.onLoaded=function(){this.loaded=true;this.dispatchEvent({type:"loaded",content:this})};t.AbstractFilter=function(e,t){this.passes=[this];this.shaders=[];this.dirty=true;this.padding=0;this.uniforms=t||{};this.fragmentSrc=e||[]};t.AlphaMaskFilter=function(e){t.AbstractFilter.call(this);this.passes=[this];e.baseTexture._powerOf2=true;this.uniforms={mask:{type:"sampler2D",value:e},mapDimensions:{type:"2f",value:{x:1,y:5112}},dimensions:{type:"4fv",value:[0,0,0,0]}};if(e.baseTexture.hasLoaded){this.uniforms.mask.value.x=e.width;this.uniforms.mask.value.y=e.height}else{this.boundLoadedFunction=this.onTextureLoaded.bind(this);e.baseTexture.on("loaded",this.boundLoadedFunction)}this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D mask;","uniform sampler2D uSampler;","uniform vec2 offset;","uniform vec4 dimensions;","uniform vec2 mapDimensions;","void main(void) {","   vec2 mapCords = vTextureCoord.xy;","   mapCords += (dimensions.zw + offset)/ dimensions.xy ;","   mapCords.y *= -1.0;","   mapCords.y += 1.0;","   mapCords *= dimensions.xy / mapDimensions;","   vec4 original =  texture2D(uSampler, vTextureCoord);","   float maskAlpha =  texture2D(mask, mapCords).r;","   original *= maskAlpha;","   gl_FragColor =  original;","}"]};t.AlphaMaskFilter.prototype=Object.create(t.AbstractFilter.prototype);t.AlphaMaskFilter.prototype.constructor=t.AlphaMaskFilter;t.AlphaMaskFilter.prototype.onTextureLoaded=function(){this.uniforms.mapDimensions.value.x=this.uniforms.mask.value.width;this.uniforms.mapDimensions.value.y=this.uniforms.mask.value.height;this.uniforms.mask.value.baseTexture.off("loaded",this.boundLoadedFunction)};Object.defineProperty(t.AlphaMaskFilter.prototype,"map",{get:function(){return this.uniforms.mask.value},set:function(e){this.uniforms.mask.value=e}});t.ColorMatrixFilter=function(){t.AbstractFilter.call(this);this.passes=[this];this.uniforms={matrix:{type:"mat4",value:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}};this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float invert;","uniform mat4 matrix;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord) * matrix;","}"]};t.ColorMatrixFilter.prototype=Object.create(t.AbstractFilter.prototype);t.ColorMatrixFilter.prototype.constructor=t.ColorMatrixFilter;Object.defineProperty(t.ColorMatrixFilter.prototype,"matrix",{get:function(){return this.uniforms.matrix.value},set:function(e){this.uniforms.matrix.value=e}});t.GrayFilter=function(){t.AbstractFilter.call(this);this.passes=[this];this.uniforms={gray:{type:"1f",value:1}};this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","uniform float gray;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord);","   gl_FragColor.rgb = mix(gl_FragColor.rgb, vec3(0.2126*gl_FragColor.r + 0.7152*gl_FragColor.g + 0.0722*gl_FragColor.b), gray);","}"]};t.GrayFilter.prototype=Object.create(t.AbstractFilter.prototype);t.GrayFilter.prototype.constructor=t.GrayFilter;Object.defineProperty(t.GrayFilter.prototype,"gray",{get:function(){return this.uniforms.gray.value},set:function(e){this.uniforms.gray.value=e}});t.DisplacementFilter=function(e){t.AbstractFilter.call(this);this.passes=[this];e.baseTexture._powerOf2=true;this.uniforms={displacementMap:{type:"sampler2D",value:e},scale:{type:"2f",value:{x:30,y:30}},offset:{type:"2f",value:{x:0,y:0}},mapDimensions:{type:"2f",value:{x:1,y:5112}},dimensions:{type:"4fv",value:[0,0,0,0]}};if(e.baseTexture.hasLoaded){this.uniforms.mapDimensions.value.x=e.width;this.uniforms.mapDimensions.value.y=e.height}else{this.boundLoadedFunction=this.onTextureLoaded.bind(this);e.baseTexture.on("loaded",this.boundLoadedFunction)}this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D displacementMap;","uniform sampler2D uSampler;","uniform vec2 scale;","uniform vec2 offset;","uniform vec4 dimensions;","uniform vec2 mapDimensions;","void main(void) {","   vec2 mapCords = vTextureCoord.xy;","   mapCords += (dimensions.zw + offset)/ dimensions.xy ;","   mapCords.y *= -1.0;","   mapCords.y += 1.0;","   vec2 matSample = texture2D(displacementMap, mapCords).xy;","   matSample -= 0.5;","   matSample *= scale;","   matSample /= mapDimensions;","   gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.x + matSample.x, vTextureCoord.y + matSample.y));","   gl_FragColor.rgb = mix( gl_FragColor.rgb, gl_FragColor.rgb, 1.0);","   vec2 cord = vTextureCoord;","}"]};t.DisplacementFilter.prototype=Object.create(t.AbstractFilter.prototype);t.DisplacementFilter.prototype.constructor=t.DisplacementFilter;t.DisplacementFilter.prototype.onTextureLoaded=function(){this.uniforms.mapDimensions.value.x=this.uniforms.displacementMap.value.width;this.uniforms.mapDimensions.value.y=this.uniforms.displacementMap.value.height;this.uniforms.displacementMap.value.baseTexture.off("loaded",this.boundLoadedFunction)};Object.defineProperty(t.DisplacementFilter.prototype,"map",{get:function(){return this.uniforms.displacementMap.value},set:function(e){this.uniforms.displacementMap.value=e}});Object.defineProperty(t.DisplacementFilter.prototype,"scale",{get:function(){return this.uniforms.scale.value},set:function(e){this.uniforms.scale.value=e}});Object.defineProperty(t.DisplacementFilter.prototype,"offset",{get:function(){return this.uniforms.offset.value},set:function(e){this.uniforms.offset.value=e}});t.PixelateFilter=function(){t.AbstractFilter.call(this);this.passes=[this];this.uniforms={invert:{type:"1f",value:0},dimensions:{type:"4fv",value:new Float32Array([1e4,100,10,10])},pixelSize:{type:"2f",value:{x:10,y:10}}};this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform vec2 testDim;","uniform vec4 dimensions;","uniform vec2 pixelSize;","uniform sampler2D uSampler;","void main(void) {","   vec2 coord = vTextureCoord;","   vec2 size = dimensions.xy/pixelSize;","   vec2 color = floor( ( vTextureCoord * size ) ) / size + pixelSize/dimensions.xy * 0.5;","   gl_FragColor = texture2D(uSampler, color);","}"]};t.PixelateFilter.prototype=Object.create(t.AbstractFilter.prototype);t.PixelateFilter.prototype.constructor=t.PixelateFilter;Object.defineProperty(t.PixelateFilter.prototype,"size",{get:function(){return this.uniforms.pixelSize.value},set:function(e){this.dirty=true;this.uniforms.pixelSize.value=e}});t.BlurXFilter=function(){t.AbstractFilter.call(this);this.passes=[this];this.uniforms={blur:{type:"1f",value:1/512}};this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float blur;","uniform sampler2D uSampler;","void main(void) {","   vec4 sum = vec4(0.0);","   sum += texture2D(uSampler, vec2(vTextureCoord.x - 4.0*blur, vTextureCoord.y)) * 0.05;","   sum += texture2D(uSampler, vec2(vTextureCoord.x - 3.0*blur, vTextureCoord.y)) * 0.09;","   sum += texture2D(uSampler, vec2(vTextureCoord.x - 2.0*blur, vTextureCoord.y)) * 0.12;","   sum += texture2D(uSampler, vec2(vTextureCoord.x - blur, vTextureCoord.y)) * 0.15;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y)) * 0.16;","   sum += texture2D(uSampler, vec2(vTextureCoord.x + blur, vTextureCoord.y)) * 0.15;","   sum += texture2D(uSampler, vec2(vTextureCoord.x + 2.0*blur, vTextureCoord.y)) * 0.12;","   sum += texture2D(uSampler, vec2(vTextureCoord.x + 3.0*blur, vTextureCoord.y)) * 0.09;","   sum += texture2D(uSampler, vec2(vTextureCoord.x + 4.0*blur, vTextureCoord.y)) * 0.05;","   gl_FragColor = sum;","}"]};t.BlurXFilter.prototype=Object.create(t.AbstractFilter.prototype);t.BlurXFilter.prototype.constructor=t.BlurXFilter;Object.defineProperty(t.BlurXFilter.prototype,"blur",{get:function(){return this.uniforms.blur.value/(1/7e3)},set:function(e){this.dirty=true;this.uniforms.blur.value=1/7e3*e}});t.BlurYFilter=function(){t.AbstractFilter.call(this);this.passes=[this];this.uniforms={blur:{type:"1f",value:1/512}};this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float blur;","uniform sampler2D uSampler;","void main(void) {","   vec4 sum = vec4(0.0);","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - 4.0*blur)) * 0.05;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - 3.0*blur)) * 0.09;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - 2.0*blur)) * 0.12;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - blur)) * 0.15;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y)) * 0.16;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + blur)) * 0.15;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + 2.0*blur)) * 0.12;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + 3.0*blur)) * 0.09;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + 4.0*blur)) * 0.05;","   gl_FragColor = sum;","}"]};t.BlurYFilter.prototype=Object.create(t.AbstractFilter.prototype);t.BlurYFilter.prototype.constructor=t.BlurYFilter;Object.defineProperty(t.BlurYFilter.prototype,"blur",{get:function(){return this.uniforms.blur.value/(1/7e3)},set:function(e){this.uniforms.blur.value=1/7e3*e}});t.BlurFilter=function(){this.blurXFilter=new t.BlurXFilter;this.blurYFilter=new t.BlurYFilter;this.passes=[this.blurXFilter,this.blurYFilter]};Object.defineProperty(t.BlurFilter.prototype,"blur",{get:function(){return this.blurXFilter.blur},set:function(e){this.blurXFilter.blur=this.blurYFilter.blur=e}});Object.defineProperty(t.BlurFilter.prototype,"blurX",{get:function(){return this.blurXFilter.blur},set:function(e){this.blurXFilter.blur=e}});Object.defineProperty(t.BlurFilter.prototype,"blurY",{get:function(){return this.blurYFilter.blur},set:function(e){this.blurYFilter.blur=e}});t.InvertFilter=function(){t.AbstractFilter.call(this);this.passes=[this];this.uniforms={invert:{type:"1f",value:1}};this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float invert;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord);","   gl_FragColor.rgb = mix( (vec3(1)-gl_FragColor.rgb) * gl_FragColor.a, gl_FragColor.rgb, 1.0 - invert);","}"]};t.InvertFilter.prototype=Object.create(t.AbstractFilter.prototype);t.InvertFilter.prototype.constructor=t.InvertFilter;Object.defineProperty(t.InvertFilter.prototype,"invert",{get:function(){return this.uniforms.invert.value},set:function(e){this.uniforms.invert.value=e}});t.SepiaFilter=function(){t.AbstractFilter.call(this);this.passes=[this];this.uniforms={sepia:{type:"1f",value:1}};this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float sepia;","uniform sampler2D uSampler;","const mat3 sepiaMatrix = mat3(0.3588, 0.7044, 0.1368, 0.2990, 0.5870, 0.1140, 0.2392, 0.4696, 0.0912);","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord);","   gl_FragColor.rgb = mix( gl_FragColor.rgb, gl_FragColor.rgb * sepiaMatrix, sepia);","}"]};t.SepiaFilter.prototype=Object.create(t.AbstractFilter.prototype);t.SepiaFilter.prototype.constructor=t.SepiaFilter;Object.defineProperty(t.SepiaFilter.prototype,"sepia",{get:function(){return this.uniforms.sepia.value},set:function(e){this.uniforms.sepia.value=e}});t.TwistFilter=function(){t.AbstractFilter.call(this);this.passes=[this];this.uniforms={radius:{type:"1f",value:.5},angle:{type:"1f",value:5},offset:{type:"2f",value:{x:.5,y:.5}}};this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform vec4 dimensions;","uniform sampler2D uSampler;","uniform float radius;","uniform float angle;","uniform vec2 offset;","void main(void) {","   vec2 coord = vTextureCoord - offset;","   float distance = length(coord);","   if (distance < radius) {","       float ratio = (radius - distance) / radius;","       float angleMod = ratio * ratio * angle;","       float s = sin(angleMod);","       float c = cos(angleMod);","       coord = vec2(coord.x * c - coord.y * s, coord.x * s + coord.y * c);","   }","   gl_FragColor = texture2D(uSampler, coord+offset);","}"]};t.TwistFilter.prototype=Object.create(t.AbstractFilter.prototype);t.TwistFilter.prototype.constructor=t.TwistFilter;Object.defineProperty(t.TwistFilter.prototype,"offset",{get:function(){return this.uniforms.offset.value},set:function(e){this.dirty=true;this.uniforms.offset.value=e}});Object.defineProperty(t.TwistFilter.prototype,"radius",{get:function(){return this.uniforms.radius.value},set:function(e){this.dirty=true;this.uniforms.radius.value=e}});Object.defineProperty(t.TwistFilter.prototype,"angle",{get:function(){return this.uniforms.angle.value},set:function(e){this.dirty=true;this.uniforms.angle.value=e}});t.ColorStepFilter=function(){t.AbstractFilter.call(this);this.passes=[this];this.uniforms={step:{type:"1f",value:5}};this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","uniform float step;","void main(void) {","   vec4 color = texture2D(uSampler, vTextureCoord);","   color = floor(color * step) / step;","   gl_FragColor = color;","}"]};t.ColorStepFilter.prototype=Object.create(t.AbstractFilter.prototype);t.ColorStepFilter.prototype.constructor=t.ColorStepFilter;Object.defineProperty(t.ColorStepFilter.prototype,"step",{get:function(){return this.uniforms.step.value},set:function(e){this.uniforms.step.value=e}});t.DotScreenFilter=function(){t.AbstractFilter.call(this);this.passes=[this];this.uniforms={scale:{type:"1f",value:1},angle:{type:"1f",value:5},dimensions:{type:"4fv",value:[0,0,0,0]}};this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform vec4 dimensions;","uniform sampler2D uSampler;","uniform float angle;","uniform float scale;","float pattern() {","   float s = sin(angle), c = cos(angle);","   vec2 tex = vTextureCoord * dimensions.xy;","   vec2 point = vec2(","       c * tex.x - s * tex.y,","       s * tex.x + c * tex.y","   ) * scale;","   return (sin(point.x) * sin(point.y)) * 4.0;","}","void main() {","   vec4 color = texture2D(uSampler, vTextureCoord);","   float average = (color.r + color.g + color.b) / 3.0;","   gl_FragColor = vec4(vec3(average * 10.0 - 5.0 + pattern()), color.a);","}"]};t.DotScreenFilter.prototype=Object.create(t.AbstractFilter.prototype);t.DotScreenFilter.prototype.constructor=t.DotScreenFilter;Object.defineProperty(t.DotScreenFilter.prototype,"scale",{get:function(){return this.uniforms.scale.value},set:function(e){this.dirty=true;this.uniforms.scale.value=e}});Object.defineProperty(t.DotScreenFilter.prototype,"angle",{get:function(){return this.uniforms.angle.value},set:function(e){this.dirty=true;this.uniforms.angle.value=e}});t.CrossHatchFilter=function(){t.AbstractFilter.call(this);this.passes=[this];this.uniforms={blur:{type:"1f",value:1/512}};this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float blur;","uniform sampler2D uSampler;","void main(void) {","    float lum = length(texture2D(uSampler, vTextureCoord.xy).rgb);","    gl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);","    if (lum < 1.00) {","        if (mod(gl_FragCoord.x + gl_FragCoord.y, 10.0) == 0.0) {","            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);","        }","    }","    if (lum < 0.75) {","        if (mod(gl_FragCoord.x - gl_FragCoord.y, 10.0) == 0.0) {","            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);","        }","    }","    if (lum < 0.50) {","        if (mod(gl_FragCoord.x + gl_FragCoord.y - 5.0, 10.0) == 0.0) {","            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);","        }","    }","    if (lum < 0.3) {","        if (mod(gl_FragCoord.x - gl_FragCoord.y - 5.0, 10.0) == 0.0) {","            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);","        }","    }","}"]};t.CrossHatchFilter.prototype=Object.create(t.AbstractFilter.prototype);t.CrossHatchFilter.prototype.constructor=t.BlurYFilter;Object.defineProperty(t.CrossHatchFilter.prototype,"blur",{get:function(){return this.uniforms.blur.value/(1/7e3)},set:function(e){this.uniforms.blur.value=1/7e3*e}});t.RGBSplitFilter=function(){t.AbstractFilter.call(this);this.passes=[this];this.uniforms={red:{type:"2f",value:{x:20,y:20}},green:{type:"2f",value:{x:-20,y:20}},blue:{type:"2f",value:{x:20,y:-20}},dimensions:{type:"4fv",value:[0,0,0,0]}};this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform vec2 red;","uniform vec2 green;","uniform vec2 blue;","uniform vec4 dimensions;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor.r = texture2D(uSampler, vTextureCoord + red/dimensions.xy).r;","   gl_FragColor.g = texture2D(uSampler, vTextureCoord + green/dimensions.xy).g;","   gl_FragColor.b = texture2D(uSampler, vTextureCoord + blue/dimensions.xy).b;","   gl_FragColor.a = texture2D(uSampler, vTextureCoord).a;","}"]};t.RGBSplitFilter.prototype=Object.create(t.AbstractFilter.prototype);t.RGBSplitFilter.prototype.constructor=t.RGBSplitFilter;Object.defineProperty(t.RGBSplitFilter.prototype,"angle",{get:function(){return this.uniforms.blur.value/(1/7e3)},set:function(e){this.uniforms.blur.value=1/7e3*e}});if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports){exports=module.exports=t}exports.PIXI=t}else if(typeof define!=="undefined"&&define.amd){define(t)}else{e.PIXI=t}}.call(this);
